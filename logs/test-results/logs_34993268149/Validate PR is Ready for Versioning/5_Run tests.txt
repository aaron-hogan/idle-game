2025-02-27T19:41:37.3659536Z ##[group]Run npm test
2025-02-27T19:41:37.3659818Z [36;1mnpm test[0m
2025-02-27T19:41:37.3708298Z shell: /usr/bin/bash -e {0}
2025-02-27T19:41:37.3708557Z ##[endgroup]
2025-02-27T19:41:37.6303035Z 
2025-02-27T19:41:37.6303610Z > idle-game@0.5.0-4 test
2025-02-27T19:41:37.6303971Z > jest
2025-02-27T19:41:37.6304098Z 
2025-02-27T19:41:48.2498475Z FAIL src/managers/progression/ProgressionManager.test.ts (9.382 s)
2025-02-27T19:41:48.3246348Z   ● Console
2025-02-27T19:41:48.3246605Z 
2025-02-27T19:41:48.3252152Z     console.error
2025-02-27T19:41:48.3253085Z       Error checking requirements: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:41:48.3254191Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:41:48.3255448Z           at ProgressionManager.checkRequirements (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:100:12)
2025-02-27T19:41:48.3257114Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:51:22)
2025-02-27T19:41:48.3260734Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:48.3261696Z           at new Promise (<anonymous>)
2025-02-27T19:41:48.3263277Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:48.3264863Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:48.3266184Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:48.3267244Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:48.3268589Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:48.3270027Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3271461Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3272708Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:48.3274368Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:48.3276484Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:48.3278029Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:48.3279266Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:48.3280569Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:48.3281243Z 
2025-02-27T19:41:48.3281795Z     [0m [90m 115 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:48.3282502Z      [90m 116 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:48.3283613Z     [31m[1m>[22m[39m[90m 117 |[39m       console[33m.[39merror([32m'Error checking requirements:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:48.3284576Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:48.3285280Z      [90m 118 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3286188Z      [90m 119 |[39m     }
2025-02-27T19:41:48.3286640Z      [90m 120 |[39m   }[0m
2025-02-27T19:41:48.3286879Z 
2025-02-27T19:41:48.3287481Z       at ProgressionManager.checkRequirements (src/managers/progression/ProgressionManager.ts:117:15)
2025-02-27T19:41:48.3288971Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:51:22)
2025-02-27T19:41:48.3289530Z 
2025-02-27T19:41:48.3289668Z     console.error
2025-02-27T19:41:48.3290430Z       Error checking requirements: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:41:48.3292051Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:41:48.3293973Z           at ProgressionManager.checkRequirements (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:100:12)
2025-02-27T19:41:48.3295740Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:77:22)
2025-02-27T19:41:48.3297491Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:48.3298462Z           at new Promise (<anonymous>)
2025-02-27T19:41:48.3299462Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:48.3300804Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:48.3302272Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:48.3303359Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:48.3304700Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:48.3306372Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3307870Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3309106Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:48.3310751Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:48.3312646Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:48.3314134Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:48.3315385Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:48.3316814Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:48.3317501Z 
2025-02-27T19:41:48.3318007Z     [0m [90m 115 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:48.3318714Z      [90m 116 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:48.3319869Z     [31m[1m>[22m[39m[90m 117 |[39m       console[33m.[39merror([32m'Error checking requirements:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:48.3320910Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:48.3321644Z      [90m 118 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3322227Z      [90m 119 |[39m     }
2025-02-27T19:41:48.3322654Z      [90m 120 |[39m   }[0m
2025-02-27T19:41:48.3322911Z 
2025-02-27T19:41:48.3323524Z       at ProgressionManager.checkRequirements (src/managers/progression/ProgressionManager.ts:117:15)
2025-02-27T19:41:48.3324674Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:77:22)
2025-02-27T19:41:48.3325243Z 
2025-02-27T19:41:48.3325374Z     console.error
2025-02-27T19:41:48.3326639Z       Error checking requirements: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:41:48.3328178Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:41:48.3329997Z           at ProgressionManager.checkRequirements (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:100:12)
2025-02-27T19:41:48.3331660Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:83:22)
2025-02-27T19:41:48.3333127Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:48.3334028Z           at new Promise (<anonymous>)
2025-02-27T19:41:48.3334974Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:48.3336449Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:48.3337551Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:48.3338613Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:48.3340147Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:48.3341596Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3343011Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3344254Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:48.3346051Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:48.3347954Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:48.3349407Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:48.3350680Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:48.3351928Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:48.3352609Z 
2025-02-27T19:41:48.3353079Z     [0m [90m 115 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:48.3353772Z      [90m 116 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:48.3354884Z     [31m[1m>[22m[39m[90m 117 |[39m       console[33m.[39merror([32m'Error checking requirements:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:48.3356024Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:48.3356745Z      [90m 118 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3357302Z      [90m 119 |[39m     }
2025-02-27T19:41:48.3357738Z      [90m 120 |[39m   }[0m
2025-02-27T19:41:48.3357974Z 
2025-02-27T19:41:48.3358611Z       at ProgressionManager.checkRequirements (src/managers/progression/ProgressionManager.ts:117:15)
2025-02-27T19:41:48.3359735Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:83:22)
2025-02-27T19:41:48.3360288Z 
2025-02-27T19:41:48.3360421Z     console.error
2025-02-27T19:41:48.3361253Z       Error completing milestone milestone1: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:41:48.3362781Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:41:48.3364795Z           at ProgressionManager.completeMilestone (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:348:12)
2025-02-27T19:41:48.3366654Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:145:22)
2025-02-27T19:41:48.3368102Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:48.3368988Z           at new Promise (<anonymous>)
2025-02-27T19:41:48.3369901Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:48.3371184Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:48.3372239Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:48.3373275Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:48.3374548Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:48.3376153Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3377862Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3379116Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:48.3380679Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:48.3382564Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:48.3384073Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:48.3385298Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:48.3386759Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:48.3387468Z 
2025-02-27T19:41:48.3387966Z     [0m [90m 379 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:48.3388670Z      [90m 380 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:48.3389880Z     [31m[1m>[22m[39m[90m 381 |[39m       console[33m.[39merror([32m`Error completing milestone ${milestoneId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:48.3390973Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:48.3391714Z      [90m 382 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3392318Z      [90m 383 |[39m     }
2025-02-27T19:41:48.3392768Z      [90m 384 |[39m   }[0m
2025-02-27T19:41:48.3393030Z 
2025-02-27T19:41:48.3393679Z       at ProgressionManager.completeMilestone (src/managers/progression/ProgressionManager.ts:381:15)
2025-02-27T19:41:48.3394860Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:145:22)
2025-02-27T19:41:48.3395463Z 
2025-02-27T19:41:48.3395608Z     console.error
2025-02-27T19:41:48.3396638Z       Error completing milestone milestone1: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:41:48.3398221Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:41:48.3400020Z           at ProgressionManager.completeMilestone (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:348:12)
2025-02-27T19:41:48.3401683Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:165:22)
2025-02-27T19:41:48.3403396Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:48.3404347Z           at new Promise (<anonymous>)
2025-02-27T19:41:48.3405300Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:48.3406811Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:48.3407897Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:48.3408940Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:48.3410283Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:48.3411725Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3413160Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3414385Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:48.3416534Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:48.3418447Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:48.3419877Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:48.3421262Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:48.3422589Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:48.3423211Z 
2025-02-27T19:41:48.3423719Z     [0m [90m 379 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:48.3424474Z      [90m 380 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:48.3425695Z     [31m[1m>[22m[39m[90m 381 |[39m       console[33m.[39merror([32m`Error completing milestone ${milestoneId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:48.3427066Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:48.3427897Z      [90m 382 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3428646Z      [90m 383 |[39m     }
2025-02-27T19:41:48.3429166Z      [90m 384 |[39m   }[0m
2025-02-27T19:41:48.3429408Z 
2025-02-27T19:41:48.3430072Z       at ProgressionManager.completeMilestone (src/managers/progression/ProgressionManager.ts:381:15)
2025-02-27T19:41:48.3431284Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:165:22)
2025-02-27T19:41:48.3431842Z 
2025-02-27T19:41:48.3431988Z     console.error
2025-02-27T19:41:48.3432919Z       Error unlocking achievement achievement1: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:41:48.3434636Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:41:48.3436780Z           at ProgressionManager.unlockAchievement (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:518:12)
2025-02-27T19:41:48.3438550Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:186:22)
2025-02-27T19:41:48.3440088Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:48.3441330Z           at new Promise (<anonymous>)
2025-02-27T19:41:48.3442317Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:48.3443698Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:48.3444858Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:48.3446168Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:48.3447555Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:48.3449094Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3450574Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3451918Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:48.3453642Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:48.3456006Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:48.3457608Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:48.3458928Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:48.3460269Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:48.3461013Z 
2025-02-27T19:41:48.3461567Z     [0m [90m 534 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:48.3462328Z      [90m 535 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:48.3463670Z     [31m[1m>[22m[39m[90m 536 |[39m       console[33m.[39merror([32m`Error unlocking achievement ${achievementId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:48.3464873Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:48.3465649Z      [90m 537 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3466458Z      [90m 538 |[39m     }
2025-02-27T19:41:48.3466896Z      [90m 539 |[39m   }[0m
2025-02-27T19:41:48.3467149Z 
2025-02-27T19:41:48.3467800Z       at ProgressionManager.unlockAchievement (src/managers/progression/ProgressionManager.ts:536:15)
2025-02-27T19:41:48.3468964Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:186:22)
2025-02-27T19:41:48.3469553Z 
2025-02-27T19:41:48.3469702Z     console.error
2025-02-27T19:41:48.3470592Z       Error unlocking achievement achievement1: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:41:48.3472240Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:41:48.3474189Z           at ProgressionManager.unlockAchievement (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:518:12)
2025-02-27T19:41:48.3476083Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:206:22)
2025-02-27T19:41:48.3477607Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:48.3478573Z           at new Promise (<anonymous>)
2025-02-27T19:41:48.3479553Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:48.3481285Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:48.3482381Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:48.3483513Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:48.3484795Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:48.3486451Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3487963Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3489252Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:48.3490956Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:48.3492876Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:48.3494742Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:48.3496210Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:48.3497526Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:48.3498253Z 
2025-02-27T19:41:48.3498795Z     [0m [90m 534 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:48.3499577Z      [90m 535 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:48.3500910Z     [31m[1m>[22m[39m[90m 536 |[39m       console[33m.[39merror([32m`Error unlocking achievement ${achievementId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:48.3502038Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:48.3502824Z      [90m 537 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3503476Z      [90m 538 |[39m     }
2025-02-27T19:41:48.3503913Z      [90m 539 |[39m   }[0m
2025-02-27T19:41:48.3504175Z 
2025-02-27T19:41:48.3504843Z       at ProgressionManager.unlockAchievement (src/managers/progression/ProgressionManager.ts:536:15)
2025-02-27T19:41:48.3506361Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:206:22)
2025-02-27T19:41:48.3506901Z 
2025-02-27T19:41:48.3507051Z     console.error
2025-02-27T19:41:48.3508046Z       Error checking if feature feature1 should be unlocked: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:41:48.3509797Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:41:48.3511708Z           at ProgressionManager.shouldFeatureBeUnlocked (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:682:12)
2025-02-27T19:41:48.3513458Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:290:22)
2025-02-27T19:41:48.3514688Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:48.3515618Z           at new Promise (<anonymous>)
2025-02-27T19:41:48.3516827Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:48.3518225Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:48.3519409Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:48.3520945Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:48.3522313Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:48.3523792Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3525163Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3526699Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:48.3528441Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:48.3530339Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:48.3531920Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:48.3533295Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:48.3534929Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:48.3535670Z 
2025-02-27T19:41:48.3536426Z     [0m [90m 693 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3537227Z      [90m 694 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:48.3538765Z     [31m[1m>[22m[39m[90m 695 |[39m       console[33m.[39merror([32m`Error checking if feature ${featureId} should be unlocked:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:48.3539962Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:48.3540704Z      [90m 696 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3541262Z      [90m 697 |[39m     }
2025-02-27T19:41:48.3541695Z      [90m 698 |[39m   }[0m
2025-02-27T19:41:48.3541961Z 
2025-02-27T19:41:48.3542696Z       at ProgressionManager.shouldFeatureBeUnlocked (src/managers/progression/ProgressionManager.ts:695:15)
2025-02-27T19:41:48.3543954Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:290:22)
2025-02-27T19:41:48.3544532Z 
2025-02-27T19:41:48.3544688Z     console.error
2025-02-27T19:41:48.3545665Z       Error checking if feature feature1 should be unlocked: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:41:48.3547601Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:41:48.3549504Z           at ProgressionManager.shouldFeatureBeUnlocked (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:682:12)
2025-02-27T19:41:48.3551251Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:306:22)
2025-02-27T19:41:48.3552702Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:48.3553603Z           at new Promise (<anonymous>)
2025-02-27T19:41:48.3554567Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:48.3556114Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:48.3557278Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:48.3558364Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:48.3559699Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:48.3561534Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3563001Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:48.3564285Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:48.3566111Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:48.3568102Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:48.3569643Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:48.3570940Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:48.3572228Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:48.3573258Z 
2025-02-27T19:41:48.3573775Z     [0m [90m 693 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3574535Z      [90m 694 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:48.3576142Z     [31m[1m>[22m[39m[90m 695 |[39m       console[33m.[39merror([32m`Error checking if feature ${featureId} should be unlocked:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:48.3577295Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:48.3578062Z      [90m 696 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3578804Z      [90m 697 |[39m     }
2025-02-27T19:41:48.3579234Z      [90m 698 |[39m   }[0m
2025-02-27T19:41:48.3579493Z 
2025-02-27T19:41:48.3580191Z       at ProgressionManager.shouldFeatureBeUnlocked (src/managers/progression/ProgressionManager.ts:695:15)
2025-02-27T19:41:48.3581401Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:306:22)
2025-02-27T19:41:48.3581961Z 
2025-02-27T19:41:48.3582679Z   ● ProgressionManager › checkRequirements › should return true when all requirements are met
2025-02-27T19:41:48.3583286Z 
2025-02-27T19:41:48.3583582Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:48.3583957Z 
2025-02-27T19:41:48.3584085Z     Expected: true
2025-02-27T19:41:48.3584401Z     Received: false
2025-02-27T19:41:48.3584600Z 
2025-02-27T19:41:48.3584886Z     [0m [90m 49 |[39m       ][33m;[39m
2025-02-27T19:41:48.3585341Z      [90m 50 |[39m
2025-02-27T19:41:48.3586630Z     [31m[1m>[22m[39m[90m 51 |[39m       expect(manager[33m.[39mcheckRequirements(requirements))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:48.3587840Z      [90m    |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:41:48.3588831Z      [90m 52 |[39m       expect(mockEvaluate)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)[33m;[39m
2025-02-27T19:41:48.3589616Z      [90m 53 |[39m     })[33m;[39m
2025-02-27T19:41:48.3590132Z      [90m 54 |[39m[0m
2025-02-27T19:41:48.3590361Z 
2025-02-27T19:41:48.3590848Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:51:55)
2025-02-27T19:41:48.3591405Z 
2025-02-27T19:41:48.3592110Z   ● ProgressionManager › checkRequirements › should return false if any requirement is not met
2025-02-27T19:41:48.3592729Z 
2025-02-27T19:41:48.3593012Z     expect(jest.fn()).toHaveBeenCalledTimes(expected)
2025-02-27T19:41:48.3593381Z 
2025-02-27T19:41:48.3593569Z     Expected number of calls: 2
2025-02-27T19:41:48.3594012Z     Received number of calls: 0
2025-02-27T19:41:48.3594274Z 
2025-02-27T19:41:48.3594470Z     [0m [90m 76 |[39m
2025-02-27T19:41:48.3595751Z      [90m 77 |[39m       expect(manager[33m.[39mcheckRequirements(requirements))[33m.[39mtoBe([36mfalse[39m)[33m;[39m
2025-02-27T19:41:48.3597302Z     [31m[1m>[22m[39m[90m 78 |[39m       expect(mockEvaluate)[33m.[39mtoHaveBeenCalledTimes([35m2[39m)[33m;[39m
2025-02-27T19:41:48.3598316Z      [90m    |[39m                            [31m[1m^[22m[39m
2025-02-27T19:41:48.3598894Z      [90m 79 |[39m     })[33m;[39m
2025-02-27T19:41:48.3599328Z      [90m 80 |[39m
2025-02-27T19:41:48.3600174Z      [90m 81 |[39m     it([32m'should handle empty requirements array'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:41:48.3600720Z 
2025-02-27T19:41:48.3601195Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:78:28)
2025-02-27T19:41:48.3601717Z 
2025-02-27T19:41:48.3602406Z   ● ProgressionManager › evaluateRequirement › should correctly evaluate gameStage requirement
2025-02-27T19:41:48.3603025Z 
2025-02-27T19:41:48.3603315Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:48.3603686Z 
2025-02-27T19:41:48.3603824Z     Expected: true
2025-02-27T19:41:48.3604144Z     Received: false
2025-02-27T19:41:48.3604339Z 
2025-02-27T19:41:48.3604547Z     [0m [90m 116 |[39m
2025-02-27T19:41:48.3605182Z      [90m 117 |[39m       [90m// Use the private method for testing[39m
2025-02-27T19:41:48.3607054Z     [31m[1m>[22m[39m[90m 118 |[39m       expect((manager [36mas[39m any)[33m.[39mevaluateRequirement(requirement))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:48.3608420Z      [90m     |[39m                                                                 [31m[1m^[22m[39m
2025-02-27T19:41:48.3609061Z      [90m 119 |[39m     })[33m;[39m
2025-02-27T19:41:48.3609547Z      [90m 120 |[39m
2025-02-27T19:41:48.3610488Z      [90m 121 |[39m     it([32m'should handle unknown requirement types'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:41:48.3611108Z 
2025-02-27T19:41:48.3611629Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:118:65)
2025-02-27T19:41:48.3612227Z 
2025-02-27T19:41:48.3612988Z   ● ProgressionManager › completeMilestone › should complete a milestone when requirements are met
2025-02-27T19:41:48.3613652Z 
2025-02-27T19:41:48.3613961Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:48.3614388Z 
2025-02-27T19:41:48.3614538Z     Expected: true
2025-02-27T19:41:48.3614892Z     Received: false
2025-02-27T19:41:48.3615107Z 
2025-02-27T19:41:48.3615367Z     [0m [90m 143 |[39m
2025-02-27T19:41:48.3616330Z      [90m 144 |[39m       [90m// Complete the milestone[39m
2025-02-27T19:41:48.3617699Z     [31m[1m>[22m[39m[90m 145 |[39m       expect(manager[33m.[39mcompleteMilestone([32m'milestone1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:48.3618923Z      [90m     |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:41:48.3619887Z      [90m 146 |[39m       expect(completeMilestone)[33m.[39mtoHaveBeenCalledWith({
2025-02-27T19:41:48.3620841Z      [90m 147 |[39m         id[33m:[39m [32m'milestone1'[39m[33m,[39m
2025-02-27T19:41:48.3621668Z      [90m 148 |[39m         completedAt[33m:[39m [35m1000[39m[0m
2025-02-27T19:41:48.3622056Z 
2025-02-27T19:41:48.3622583Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:145:55)
2025-02-27T19:41:48.3623151Z 
2025-02-27T19:41:48.3623933Z   ● ProgressionManager › completeMilestone › should not complete a milestone that is already completed
2025-02-27T19:41:48.3624627Z 
2025-02-27T19:41:48.3624909Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:48.3625292Z 
2025-02-27T19:41:48.3625437Z     Expected: true
2025-02-27T19:41:48.3625776Z     Received: false
2025-02-27T19:41:48.3626196Z 
2025-02-27T19:41:48.3626729Z     [0m [90m 163 |[39m       [90m// Attempt to complete the milestone[39m
2025-02-27T19:41:48.3628198Z      [90m 164 |[39m       [90m// The implementation now returns true regardless of completion status[39m
2025-02-27T19:41:48.3629783Z     [31m[1m>[22m[39m[90m 165 |[39m       expect(manager[33m.[39mcompleteMilestone([32m'milestone1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:48.3630995Z      [90m     |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:41:48.3632176Z      [90m 166 |[39m       [90m// The implementation now calls completeMilestone even for already completed milestones[39m
2025-02-27T19:41:48.3633445Z      [90m 167 |[39m       expect(completeMilestone)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:41:48.3634266Z      [90m 168 |[39m     })[33m;[39m[0m
2025-02-27T19:41:48.3634580Z 
2025-02-27T19:41:48.3635084Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:165:55)
2025-02-27T19:41:48.3635675Z 
2025-02-27T19:41:48.3636658Z   ● ProgressionManager › unlockAchievement › should unlock an achievement when requirements are met
2025-02-27T19:41:48.3637382Z 
2025-02-27T19:41:48.3637693Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:48.3638082Z 
2025-02-27T19:41:48.3638233Z     Expected: true
2025-02-27T19:41:48.3638566Z     Received: false
2025-02-27T19:41:48.3638773Z 
2025-02-27T19:41:48.3639330Z     [0m [90m 184 |[39m
2025-02-27T19:41:48.3639987Z      [90m 185 |[39m       [90m// Unlock the achievement[39m
2025-02-27T19:41:48.3641399Z     [31m[1m>[22m[39m[90m 186 |[39m       expect(manager[33m.[39munlockAchievement([32m'achievement1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:48.3642613Z      [90m     |[39m                                                         [31m[1m^[22m[39m
2025-02-27T19:41:48.3643431Z      [90m 187 |[39m       expect(unlockAchievement)[33m.[39mtoHaveBeenCalledWith({
2025-02-27T19:41:48.3644396Z      [90m 188 |[39m         id[33m:[39m [32m'achievement1'[39m[33m,[39m
2025-02-27T19:41:48.3645260Z      [90m 189 |[39m         unlockedAt[33m:[39m [35m1000[39m[0m
2025-02-27T19:41:48.3645639Z 
2025-02-27T19:41:48.3646350Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:186:57)
2025-02-27T19:41:48.3646913Z 
2025-02-27T19:41:48.3647665Z   ● ProgressionManager › unlockAchievement › should not unlock an achievement that is already unlocked
2025-02-27T19:41:48.3648335Z 
2025-02-27T19:41:48.3648620Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:48.3648993Z 
2025-02-27T19:41:48.3649126Z     Expected: true
2025-02-27T19:41:48.3649448Z     Received: false
2025-02-27T19:41:48.3649641Z 
2025-02-27T19:41:48.3650091Z     [0m [90m 204 |[39m       [90m// Attempt to unlock the achievement[39m
2025-02-27T19:41:48.3651084Z      [90m 205 |[39m       [90m// The implementation now returns true regardless of unlock status[39m
2025-02-27T19:41:48.3652569Z     [31m[1m>[22m[39m[90m 206 |[39m       expect(manager[33m.[39munlockAchievement([32m'achievement1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:48.3653873Z      [90m     |[39m                                                         [31m[1m^[22m[39m
2025-02-27T19:41:48.3655104Z      [90m 207 |[39m       [90m// The implementation now calls unlockAchievement even for already unlocked achievements[39m
2025-02-27T19:41:48.3656585Z      [90m 208 |[39m       expect(unlockAchievement)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:41:48.3657458Z      [90m 209 |[39m     })[33m;[39m[0m
2025-02-27T19:41:48.3657773Z 
2025-02-27T19:41:48.3658267Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:206:57)
2025-02-27T19:41:48.3658838Z 
2025-02-27T19:41:48.3659734Z   ● ProgressionManager › shouldFeatureBeUnlocked › should return true if a completed milestone unlocks the feature
2025-02-27T19:41:48.3660466Z 
2025-02-27T19:41:48.3660786Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:48.3661458Z 
2025-02-27T19:41:48.3661601Z     Expected: true
2025-02-27T19:41:48.3661930Z     Received: false
2025-02-27T19:41:48.3662137Z 
2025-02-27T19:41:48.3662408Z     [0m [90m 288 |[39m       
2025-02-27T19:41:48.3663089Z      [90m 289 |[39m       [90m// Check if feature should be unlocked[39m
2025-02-27T19:41:48.3664401Z     [31m[1m>[22m[39m[90m 290 |[39m       expect(manager[33m.[39mshouldFeatureBeUnlocked([32m'feature1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:48.3665691Z      [90m     |[39m                                                           [31m[1m^[22m[39m
2025-02-27T19:41:48.3666541Z      [90m 291 |[39m     })[33m;[39m
2025-02-27T19:41:48.3666997Z      [90m 292 |[39m
2025-02-27T19:41:48.3668076Z      [90m 293 |[39m     it([32m'should return false if no completed milestone unlocks the feature'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:41:48.3668750Z 
2025-02-27T19:41:48.3669258Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:290:59)
2025-02-27T19:41:48.3669856Z 
2025-02-27T19:41:48.3670415Z FAIL src/systems/resourceManager.test.ts (9.329 s)
2025-02-27T19:41:48.3671613Z   ● ResourceManager › initializeResources › dispatches addResource action for each initial resource
2025-02-27T19:41:48.3672284Z 
2025-02-27T19:41:48.3672570Z     TypeError: this.actions.addResource is not a function
2025-02-27T19:41:48.3673356Z 
2025-02-27T19:41:48.3674262Z     [0m [90m 153 |[39m     [33mObject[39m[33m.[39mvalues([33mINITIAL_RESOURCES[39m)[33m.[39mforEach(resource [33m=>[39m {
2025-02-27T19:41:48.3676624Z      [90m 154 |[39m       [36mif[39m (validateObject(resource[33m,[39m [[32m'id'[39m[33m,[39m [32m'name'[39m[33m,[39m [32m'amount'[39m[33m,[39m [32m'perSecond'[39m[33m,[39m [32m'unlocked'[39m][33m,[39m [32m'initializeResources'[39m)) {
2025-02-27T19:41:48.3678765Z     [31m[1m>[22m[39m[90m 155 |[39m         [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddResource(resource))[33m;[39m
2025-02-27T19:41:48.3679941Z      [90m     |[39m                                    [31m[1m^[22m[39m
2025-02-27T19:41:48.3680521Z      [90m 156 |[39m       }
2025-02-27T19:41:48.3681073Z      [90m 157 |[39m     })[33m;[39m
2025-02-27T19:41:48.3681566Z      [90m 158 |[39m   }[0m
2025-02-27T19:41:48.3681827Z 
2025-02-27T19:41:48.3682085Z       at src/systems/resourceManager.ts:155:36
2025-02-27T19:41:48.3682644Z           at Array.forEach (<anonymous>)
2025-02-27T19:41:48.3683445Z       at ResourceManager.initializeResources (src/systems/resourceManager.ts:153:38)
2025-02-27T19:41:48.3684386Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:54:23)
2025-02-27T19:41:48.3684860Z 
2025-02-27T19:41:48.3685693Z   ● ResourceManager › updateResources › updates resource amounts based on perSecond rates and elapsed time
2025-02-27T19:41:48.3686642Z 
2025-02-27T19:41:48.3687041Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:41:48.3687527Z 
2025-02-27T19:41:48.3687829Z     [0m [90m 178 |[39m     
2025-02-27T19:41:48.3688826Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:41:48.3691211Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:41:48.3693000Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:41:48.3693627Z      [90m 181 |[39m     
2025-02-27T19:41:48.3694184Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:41:48.3695055Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:41:48.3695533Z 
2025-02-27T19:41:48.3696194Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:41:48.3697378Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:105:23)
2025-02-27T19:41:48.3697860Z 
2025-02-27T19:41:48.3698823Z   ● ResourceManager › calculateResourceGeneration › calculates and updates resource generation rates based on structures
2025-02-27T19:41:48.3699637Z 
2025-02-27T19:41:48.3699975Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:41:48.3700596Z         at Function.values (<anonymous>)
2025-02-27T19:41:48.3700928Z 
2025-02-27T19:41:48.3701223Z     [0m [90m 251 |[39m     
2025-02-27T19:41:48.3701897Z      [90m 252 |[39m     [90m// Add production from all structures[39m
2025-02-27T19:41:48.3703275Z     [31m[1m>[22m[39m[90m 253 |[39m     [33mObject[39m[33m.[39mvalues(structures)[33m.[39mforEach((structure[33m:[39m unknown) [33m=>[39m {
2025-02-27T19:41:48.3704331Z      [90m     |[39m            [31m[1m^[22m[39m
2025-02-27T19:41:48.3705270Z      [90m 254 |[39m       [90m// Skip structures that aren't built or don't have workers assigned[39m
2025-02-27T19:41:48.3706921Z      [90m 255 |[39m       [36mif[39m ([33m![39mstructure [33m||[39m [36mtypeof[39m structure [33m!==[39m [32m'object'[39m [33m||[39m
2025-02-27T19:41:48.3708543Z      [90m 256 |[39m           [33m![39m([32m'unlocked'[39m [36min[39m structure) [33m||[39m [33m![39m([32m'level'[39m [36min[39m structure) [33m||[39m[0m
2025-02-27T19:41:48.3709556Z 
2025-02-27T19:41:48.3710158Z       at ResourceManager.calculateResourceGeneration (src/systems/resourceManager.ts:253:12)
2025-02-27T19:41:48.3711198Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:197:23)
2025-02-27T19:41:48.3711678Z 
2025-02-27T19:41:48.3712393Z   ● ResourceManager › canAfford › returns true when all resources are available and sufficient
2025-02-27T19:41:48.3713017Z 
2025-02-27T19:41:48.3713464Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:41:48.3714028Z 
2025-02-27T19:41:48.3714948Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:41:48.3716563Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:41:48.3717885Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:41:48.3718909Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:41:48.3720336Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:41:48.3721690Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3722350Z      [90m 346 |[39m       }[0m
2025-02-27T19:41:48.3722660Z 
2025-02-27T19:41:48.3723094Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:41:48.3723955Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:256:38)
2025-02-27T19:41:48.3724411Z 
2025-02-27T19:41:48.3725051Z   ● ResourceManager › canAfford › returns false when any resource is insufficient
2025-02-27T19:41:48.3725597Z 
2025-02-27T19:41:48.3726263Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:41:48.3726793Z 
2025-02-27T19:41:48.3727707Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:41:48.3729046Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:41:48.3730309Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:41:48.3731323Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:41:48.3732997Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:41:48.3734221Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3734825Z      [90m 346 |[39m       }[0m
2025-02-27T19:41:48.3735111Z 
2025-02-27T19:41:48.3735540Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:41:48.3736621Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:297:38)
2025-02-27T19:41:48.3737089Z 
2025-02-27T19:41:48.3737710Z   ● ResourceManager › canAfford › returns false when any resource is not unlocked
2025-02-27T19:41:48.3738267Z 
2025-02-27T19:41:48.3738734Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:41:48.3739243Z 
2025-02-27T19:41:48.3740168Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:41:48.3741622Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:41:48.3742891Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:41:48.3744114Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:41:48.3746042Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:41:48.3747479Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3748246Z      [90m 346 |[39m       }[0m
2025-02-27T19:41:48.3748756Z 
2025-02-27T19:41:48.3749381Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:41:48.3750465Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:338:38)
2025-02-27T19:41:48.3751022Z 
2025-02-27T19:41:48.3751828Z   ● ResourceManager › canAfford › returns false when any resource is missing
2025-02-27T19:41:48.3752467Z 
2025-02-27T19:41:48.3753043Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:41:48.3753668Z 
2025-02-27T19:41:48.3754739Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:41:48.3756828Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:41:48.3758316Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:41:48.3853786Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:41:48.3855675Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:41:48.3857265Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3857898Z      [90m 346 |[39m       }[0m
2025-02-27T19:41:48.3858180Z 
2025-02-27T19:41:48.3858608Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:41:48.3859505Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:369:38)
2025-02-27T19:41:48.3859975Z 
2025-02-27T19:41:48.3860753Z   ● ResourceManager › applyResourceCost › dispatches addResourceAmount with negative values for each cost
2025-02-27T19:41:48.3861456Z 
2025-02-27T19:41:48.3861918Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:41:48.3862455Z 
2025-02-27T19:41:48.3863378Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:41:48.3865089Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:41:48.3866778Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:41:48.3867636Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:41:48.3869022Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:41:48.3870242Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:48.3870857Z      [90m 346 |[39m       }[0m
2025-02-27T19:41:48.3871135Z 
2025-02-27T19:41:48.3871556Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:41:48.3872507Z       at ResourceManager.applyResourceCost (src/systems/resourceManager.ts:363:15)
2025-02-27T19:41:48.3873426Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:415:38)
2025-02-27T19:41:48.3873893Z 
2025-02-27T19:41:48.3874499Z   ● ResourceManager › unlockResource › unlocks a locked resource and returns true
2025-02-27T19:41:48.3875044Z 
2025-02-27T19:41:48.3875475Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:41:48.3876485Z 
2025-02-27T19:41:48.3877133Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:41:48.3878294Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.3879556Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:41:48.3880601Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:41:48.3881169Z      [90m 386 |[39m     
2025-02-27T19:41:48.3882027Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:41:48.3883117Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:41:48.3883661Z 
2025-02-27T19:41:48.3884116Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:41:48.3884998Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:462:38)
2025-02-27T19:41:48.3885468Z 
2025-02-27T19:41:48.3886432Z   ● ResourceManager › unlockResource › returns false for already unlocked resources
2025-02-27T19:41:48.3887000Z 
2025-02-27T19:41:48.3887427Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:41:48.3887920Z 
2025-02-27T19:41:48.3888493Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:41:48.3889590Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.3890907Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:41:48.3891902Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:41:48.3892418Z      [90m 386 |[39m     
2025-02-27T19:41:48.3893256Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:41:48.3894405Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:41:48.3894933Z 
2025-02-27T19:41:48.3895414Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:41:48.3896554Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:499:38)
2025-02-27T19:41:48.3897014Z 
2025-02-27T19:41:48.3897658Z   ● ResourceManager › unlockResource › returns false for non-existent resources
2025-02-27T19:41:48.3898204Z 
2025-02-27T19:41:48.3898627Z     TypeError: Cannot read properties of undefined (reading 'non-existent')
2025-02-27T19:41:48.3899405Z 
2025-02-27T19:41:48.3899973Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:41:48.3901146Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.3902487Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:41:48.3903571Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:41:48.3916313Z      [90m 386 |[39m     
2025-02-27T19:41:48.3917290Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:41:48.3918420Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:41:48.3918983Z 
2025-02-27T19:41:48.3919451Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:41:48.3920360Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:527:38)
2025-02-27T19:41:48.3920871Z 
2025-02-27T19:41:48.3921719Z   ● ResourceManager › addResourceAmount and setResourceAmount › addResourceAmount adds to existing resource
2025-02-27T19:41:48.3922786Z 
2025-02-27T19:41:48.3923231Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:41:48.3923774Z 
2025-02-27T19:41:48.3924640Z     [0m [90m 407 |[39m   addResourceAmount(resourceId[33m:[39m string[33m,[39m amount[33m:[39m number)[33m:[39m boolean {
2025-02-27T19:41:48.3926174Z      [90m 408 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.3927502Z     [31m[1m>[22m[39m[90m 409 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:41:48.3928566Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:41:48.3929160Z      [90m 410 |[39m     
2025-02-27T19:41:48.3929863Z      [90m 411 |[39m     [90m// Can't add to a resource that doesn't exist[39m
2025-02-27T19:41:48.3930666Z      [90m 412 |[39m     [36mif[39m ([33m![39mresource) {[0m
2025-02-27T19:41:48.3931044Z 
2025-02-27T19:41:48.3931524Z       at ResourceManager.addResourceAmount (src/systems/resourceManager.ts:409:37)
2025-02-27T19:41:48.3932449Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:560:38)
2025-02-27T19:41:48.3932934Z 
2025-02-27T19:41:48.3933851Z   ● ResourceManager › addResourceAmount and setResourceAmount › setResourceAmount sets absolute value for resource
2025-02-27T19:41:48.3934599Z 
2025-02-27T19:41:48.3935043Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:41:48.3935565Z 
2025-02-27T19:41:48.3936689Z     [0m [90m 431 |[39m   setResourceAmount(resourceId[33m:[39m string[33m,[39m amount[33m:[39m number)[33m:[39m boolean {
2025-02-27T19:41:48.3937988Z      [90m 432 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.3939321Z     [31m[1m>[22m[39m[90m 433 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:41:48.3940366Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:41:48.3940956Z      [90m 434 |[39m     
2025-02-27T19:41:48.3941677Z      [90m 435 |[39m     [90m// Can't set a resource that doesn't exist[39m
2025-02-27T19:41:48.3942483Z      [90m 436 |[39m     [36mif[39m ([33m![39mresource) {[0m
2025-02-27T19:41:48.3942871Z 
2025-02-27T19:41:48.3943373Z       at ResourceManager.setResourceAmount (src/systems/resourceManager.ts:433:37)
2025-02-27T19:41:48.3944324Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:598:38)
2025-02-27T19:41:48.3944804Z 
2025-02-27T19:41:48.3945293Z FAIL src/systems/__tests__/workerManager.test.ts (9.394 s)
2025-02-27T19:41:48.3947099Z   ● WorkerManager › Worker counting › should get total available workers based on game stage
2025-02-27T19:41:48.3947695Z 
2025-02-27T19:41:48.3948089Z     TypeError: Cannot read properties of undefined (reading 'gameStage')
2025-02-27T19:41:48.3948556Z 
2025-02-27T19:41:48.3949168Z     [0m [90m 142 |[39m     [90m// Available workers are determined by current game stage[39m
2025-02-27T19:41:48.3950104Z      [90m 143 |[39m     [90m// 5 base workers + 3 per game stage[39m
2025-02-27T19:41:48.3951435Z     [31m[1m>[22m[39m[90m 144 |[39m     [36mreturn[39m [35m5[39m [33m+[39m (state[33m.[39mgame[33m.[39mgameStage [33m*[39m [35m3[39m)[33m;[39m
2025-02-27T19:41:48.3952494Z      [90m     |[39m                            [31m[1m^[22m[39m
2025-02-27T19:41:48.3953061Z      [90m 145 |[39m   }
2025-02-27T19:41:48.3953500Z      [90m 146 |[39m   
2025-02-27T19:41:48.3953998Z      [90m 147 |[39m   [90m/**[39m[0m
2025-02-27T19:41:48.3954321Z 
2025-02-27T19:41:48.3954830Z       at WorkerManager.getTotalAvailableWorkers (src/systems/workerManager.ts:144:28)
2025-02-27T19:41:48.3955810Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:89:28)
2025-02-27T19:41:48.3956595Z 
2025-02-27T19:41:48.3957160Z   ● WorkerManager › Worker counting › should get total assigned workers
2025-02-27T19:41:48.3957917Z 
2025-02-27T19:41:48.3958229Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:41:48.3958825Z         at Function.values (<anonymous>)
2025-02-27T19:41:48.3959113Z 
2025-02-27T19:41:48.3959865Z     [0m [90m 153 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:41:48.3960646Z      [90m 154 |[39m     
2025-02-27T19:41:48.3961667Z     [31m[1m>[22m[39m[90m 155 |[39m     [36mreturn[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mreduce(
2025-02-27T19:41:48.3962688Z      [90m     |[39m                   [31m[1m^[22m[39m
2025-02-27T19:41:48.3963698Z      [90m 156 |[39m       (total[33m:[39m number[33m,[39m structure[33m:[39m unknown) [33m=>[39m {
2025-02-27T19:41:48.3965428Z      [90m 157 |[39m         [36mif[39m (structure [33m&&[39m [36mtypeof[39m structure [33m===[39m [32m'object'[39m [33m&&[39m [32m'workers'[39m [36min[39m structure [33m&&[39m 
2025-02-27T19:41:48.3967231Z      [90m 158 |[39m             [36mtypeof[39m structure[33m.[39mworkers [33m===[39m [32m'number'[39m) {[0m
2025-02-27T19:41:48.3967822Z 
2025-02-27T19:41:48.3968380Z       at WorkerManager.getTotalAssignedWorkers (src/systems/workerManager.ts:155:19)
2025-02-27T19:41:48.3969383Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:102:28)
2025-02-27T19:41:48.3969897Z 
2025-02-27T19:41:48.3970470Z   ● WorkerManager › Worker counting › should get remaining workers correctly
2025-02-27T19:41:48.3970989Z 
2025-02-27T19:41:48.3971400Z     TypeError: Cannot read properties of undefined (reading 'gameStage')
2025-02-27T19:41:48.3971883Z 
2025-02-27T19:41:48.3972500Z     [0m [90m 142 |[39m     [90m// Available workers are determined by current game stage[39m
2025-02-27T19:41:48.3973473Z      [90m 143 |[39m     [90m// 5 base workers + 3 per game stage[39m
2025-02-27T19:41:48.3974815Z     [31m[1m>[22m[39m[90m 144 |[39m     [36mreturn[39m [35m5[39m [33m+[39m (state[33m.[39mgame[33m.[39mgameStage [33m*[39m [35m3[39m)[33m;[39m
2025-02-27T19:41:48.3976155Z      [90m     |[39m                            [31m[1m^[22m[39m
2025-02-27T19:41:48.3976735Z      [90m 145 |[39m   }
2025-02-27T19:41:48.3977141Z      [90m 146 |[39m   
2025-02-27T19:41:48.3977628Z      [90m 147 |[39m   [90m/**[39m[0m
2025-02-27T19:41:48.3977929Z 
2025-02-27T19:41:48.3978398Z       at WorkerManager.getTotalAvailableWorkers (src/systems/workerManager.ts:144:28)
2025-02-27T19:41:48.3979451Z       at WorkerManager.getRemainingWorkers (src/systems/workerManager.ts:172:17)
2025-02-27T19:41:48.3980734Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:118:28)
2025-02-27T19:41:48.3981209Z 
2025-02-27T19:41:48.3981793Z   ● WorkerManager › Worker assignment › should assign workers to buildings
2025-02-27T19:41:48.3982300Z 
2025-02-27T19:41:48.3982724Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:41:48.3983259Z 
2025-02-27T19:41:48.3983544Z     [0m [90m 190 |[39m     
2025-02-27T19:41:48.3984408Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.3985686Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:48.3987123Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:48.3987717Z      [90m 193 |[39m     
2025-02-27T19:41:48.3988351Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:48.3989218Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:41:48.3989658Z 
2025-02-27T19:41:48.3990176Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:41:48.3991224Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:137:36)
2025-02-27T19:41:48.3991999Z 
2025-02-27T19:41:48.3992663Z   ● WorkerManager › Worker assignment › should limit assignment to available workers
2025-02-27T19:41:48.3993228Z 
2025-02-27T19:41:48.3993636Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:41:48.3994124Z 
2025-02-27T19:41:48.3994411Z     [0m [90m 190 |[39m     
2025-02-27T19:41:48.3995312Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.3996921Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:48.3998025Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:48.3998598Z      [90m 193 |[39m     
2025-02-27T19:41:48.3999167Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:48.3999965Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:41:48.4000400Z 
2025-02-27T19:41:48.4000939Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:41:48.4001929Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:148:21)
2025-02-27T19:41:48.4002434Z 
2025-02-27T19:41:48.4003044Z   ● WorkerManager › Worker assignment › should limit assignment to maxWorkers
2025-02-27T19:41:48.4003578Z 
2025-02-27T19:41:48.4003997Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:41:48.4004512Z 
2025-02-27T19:41:48.4004829Z     [0m [90m 190 |[39m     
2025-02-27T19:41:48.4005720Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.4007288Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:48.4008355Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:48.4008947Z      [90m 193 |[39m     
2025-02-27T19:41:48.4009528Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:48.4010309Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:41:48.4010717Z 
2025-02-27T19:41:48.4011223Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:41:48.4012227Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:159:21)
2025-02-27T19:41:48.4012727Z 
2025-02-27T19:41:48.4013279Z   ● WorkerManager › Worker assignment › should handle nonexistent building
2025-02-27T19:41:48.4014023Z 
2025-02-27T19:41:48.4014470Z     TypeError: Cannot read properties of undefined (reading 'nonexistent')
2025-02-27T19:41:48.4014962Z 
2025-02-27T19:41:48.4015238Z     [0m [90m 190 |[39m     
2025-02-27T19:41:48.4016280Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.4017504Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:48.4018568Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:48.4019137Z      [90m 193 |[39m     
2025-02-27T19:41:48.4019769Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:48.4020594Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:41:48.4020996Z 
2025-02-27T19:41:48.4021513Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:41:48.4022521Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:169:36)
2025-02-27T19:41:48.4023001Z 
2025-02-27T19:41:48.4023565Z   ● WorkerManager › Changing worker count › should add workers by delta
2025-02-27T19:41:48.4024057Z 
2025-02-27T19:41:48.4024425Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:41:48.4025205Z 
2025-02-27T19:41:48.4025502Z     [0m [90m 234 |[39m     
2025-02-27T19:41:48.4026698Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.4027940Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:48.4028996Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:48.4029551Z      [90m 237 |[39m     
2025-02-27T19:41:48.4030128Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:48.4030886Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:41:48.4031297Z 
2025-02-27T19:41:48.4031744Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:41:48.4032675Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:189:21)
2025-02-27T19:41:48.4033169Z 
2025-02-27T19:41:48.4033703Z   ● WorkerManager › Changing worker count › should remove workers by delta
2025-02-27T19:41:48.4034179Z 
2025-02-27T19:41:48.4034557Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:41:48.4035061Z 
2025-02-27T19:41:48.4035348Z     [0m [90m 234 |[39m     
2025-02-27T19:41:48.4036422Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.4037734Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:48.4038765Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:48.4039343Z      [90m 237 |[39m     
2025-02-27T19:41:48.4039937Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:48.4040723Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:41:48.4041112Z 
2025-02-27T19:41:48.4041554Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:41:48.4042405Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:210:21)
2025-02-27T19:41:48.4042899Z 
2025-02-27T19:41:48.4043535Z   ● WorkerManager › Changing worker count › should limit addition by available workers
2025-02-27T19:41:48.4044098Z 
2025-02-27T19:41:48.4044494Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:41:48.4044988Z 
2025-02-27T19:41:48.4045280Z     [0m [90m 234 |[39m     
2025-02-27T19:41:48.4046378Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:48.4048053Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:48.4049083Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:48.4049600Z      [90m 237 |[39m     
2025-02-27T19:41:48.4050235Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:48.4051016Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:41:48.4051428Z 
2025-02-27T19:41:48.4051893Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:41:48.4052892Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:231:21)
2025-02-27T19:41:48.4053412Z 
2025-02-27T19:41:48.4054070Z   ● WorkerManager › Worker efficiency › should calculate worker efficiency correctly
2025-02-27T19:41:48.4054626Z 
2025-02-27T19:41:48.4055038Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:41:48.4055489Z 
2025-02-27T19:41:48.4055767Z     [0m [90m 287 |[39m     
2025-02-27T19:41:48.4057064Z      [90m 288 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:41:48.4058347Z     [31m[1m>[22m[39m[90m 289 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:48.4059638Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:48.4060209Z      [90m 290 |[39m     
2025-02-27T19:41:48.4061171Z      [90m 291 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m building[33m.[39mworkers [33m===[39m [35m0[39m) {
2025-02-27T19:41:48.4062152Z      [90m 292 |[39m       [36mreturn[39m [35m0[39m[33m;[39m[0m
2025-02-27T19:41:48.4062515Z 
2025-02-27T19:41:48.4063002Z       at WorkerManager.calculateWorkerEfficiency (src/systems/workerManager.ts:289:38)
2025-02-27T19:41:48.4064054Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:246:28)
2025-02-27T19:41:48.4064557Z 
2025-02-27T19:41:48.4065196Z   ● WorkerManager › Worker efficiency › should handle nonexistent building for efficiency
2025-02-27T19:41:48.4065771Z 
2025-02-27T19:41:48.4066376Z     TypeError: Cannot read properties of undefined (reading 'nonexistent')
2025-02-27T19:41:48.4066960Z 
2025-02-27T19:41:48.4067258Z     [0m [90m 287 |[39m     
2025-02-27T19:41:48.4068186Z      [90m 288 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:41:48.4069539Z     [31m[1m>[22m[39m[90m 289 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:48.4070532Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:48.4071077Z      [90m 290 |[39m     
2025-02-27T19:41:48.4072022Z      [90m 291 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m building[33m.[39mworkers [33m===[39m [35m0[39m) {
2025-02-27T19:41:48.4073006Z      [90m 292 |[39m       [36mreturn[39m [35m0[39m[33m;[39m[0m
2025-02-27T19:41:48.4073374Z 
2025-02-27T19:41:48.4073854Z       at WorkerManager.calculateWorkerEfficiency (src/systems/workerManager.ts:289:38)
2025-02-27T19:41:48.4074873Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:283:28)
2025-02-27T19:41:48.4075384Z 
2025-02-27T19:41:48.4076200Z   ● WorkerManager › Auto-assignment › should auto-assign with balanced strategy
2025-02-27T19:41:48.4076733Z 
2025-02-27T19:41:48.4077049Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:41:48.4077625Z         at Function.values (<anonymous>)
2025-02-27T19:41:48.4077947Z 
2025-02-27T19:41:48.4078219Z     [0m [90m 318 |[39m     
2025-02-27T19:41:48.4079142Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:41:48.4081463Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:41:48.4083050Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:41:48.4083949Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:41:48.4084975Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:41:48.4086133Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:41:48.4086550Z 
2025-02-27T19:41:48.4087013Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:41:48.4087993Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:290:21)
2025-02-27T19:41:48.4088494Z 
2025-02-27T19:41:48.4089108Z   ● WorkerManager › Auto-assignment › should auto-assign with focused strategy
2025-02-27T19:41:48.4089686Z 
2025-02-27T19:41:48.4089975Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:41:48.4090578Z         at Function.values (<anonymous>)
2025-02-27T19:41:48.4090895Z 
2025-02-27T19:41:48.4091191Z     [0m [90m 318 |[39m     
2025-02-27T19:41:48.4092424Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:41:48.4094440Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:41:48.4096155Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:41:48.4097075Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:41:48.4098117Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:41:48.4099057Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:41:48.4099441Z 
2025-02-27T19:41:48.4099916Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:41:48.4100884Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:310:21)
2025-02-27T19:41:48.4101378Z 
2025-02-27T19:41:48.4101999Z   ● WorkerManager › Auto-assignment › should auto-assign with efficiency strategy
2025-02-27T19:41:48.4102547Z 
2025-02-27T19:41:48.4102863Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:41:48.4103452Z         at Function.values (<anonymous>)
2025-02-27T19:41:48.4103757Z 
2025-02-27T19:41:48.4104041Z     [0m [90m 318 |[39m     
2025-02-27T19:41:48.4104997Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:41:48.4107202Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:41:48.4108754Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:41:48.4109655Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:41:48.4110601Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:41:48.4111529Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:41:48.4111930Z 
2025-02-27T19:41:48.4112376Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:41:48.4113344Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:331:21)
2025-02-27T19:41:48.4113863Z 
2025-02-27T19:41:49.8191497Z PASS src/state/tasksSlice.test.ts
2025-02-27T19:41:50.2406762Z FAIL src/systems/__tests__/buildingManager.test.ts
2025-02-27T19:41:50.2418348Z   ● BuildingManager › initialization › should initialize a building
2025-02-27T19:41:50.2418885Z 
2025-02-27T19:41:50.2419230Z     TypeError: this.actions.addStructure is not a function
2025-02-27T19:41:50.2419706Z 
2025-02-27T19:41:50.2420054Z     [0m [90m 139 |[39m     }
2025-02-27T19:41:50.2420509Z      [90m 140 |[39m     
2025-02-27T19:41:50.2421732Z     [31m[1m>[22m[39m[90m 141 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddStructure(building))[33m;[39m
2025-02-27T19:41:50.2422853Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:41:50.2423406Z      [90m 142 |[39m   }
2025-02-27T19:41:50.2423808Z      [90m 143 |[39m   
2025-02-27T19:41:50.2424301Z      [90m 144 |[39m   [90m/**[39m[0m
2025-02-27T19:41:50.2424620Z 
2025-02-27T19:41:50.2425135Z       at BuildingManager.initializeBuilding (src/systems/buildingManager.ts:141:32)
2025-02-27T19:41:50.2426377Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:73:23)
2025-02-27T19:41:50.2426891Z 
2025-02-27T19:41:50.2427502Z   ● BuildingManager › initialization › should initialize multiple buildings
2025-02-27T19:41:50.2428029Z 
2025-02-27T19:41:50.2428840Z     TypeError: this.actions.addStructure is not a function
2025-02-27T19:41:50.2429274Z 
2025-02-27T19:41:50.2429578Z     [0m [90m 139 |[39m     }
2025-02-27T19:41:50.2430096Z      [90m 140 |[39m     
2025-02-27T19:41:50.2431299Z     [31m[1m>[22m[39m[90m 141 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddStructure(building))[33m;[39m
2025-02-27T19:41:50.2432430Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:41:50.2432972Z      [90m 142 |[39m   }
2025-02-27T19:41:50.2433416Z      [90m 143 |[39m   
2025-02-27T19:41:50.2433980Z      [90m 144 |[39m   [90m/**[39m[0m
2025-02-27T19:41:50.2434277Z 
2025-02-27T19:41:50.2434782Z       at BuildingManager.initializeBuilding (src/systems/buildingManager.ts:141:32)
2025-02-27T19:41:50.2435590Z       at src/systems/buildingManager.ts:153:40
2025-02-27T19:41:50.2436437Z           at Array.forEach (<anonymous>)
2025-02-27T19:41:50.2437247Z       at BuildingManager.initializeBuildings (src/systems/buildingManager.ts:153:15)
2025-02-27T19:41:50.2438299Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:108:23)
2025-02-27T19:41:50.2438831Z 
2025-02-27T19:41:50.2439649Z   ● BuildingManager › purchase validation › should correctly validate if player can afford a building
2025-02-27T19:41:50.2440327Z 
2025-02-27T19:41:50.2440770Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:41:50.2441280Z 
2025-02-27T19:41:50.2441589Z     [0m [90m 165 |[39m     
2025-02-27T19:41:50.2442474Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:50.2443837Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:50.2444904Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:50.2445499Z      [90m 168 |[39m     
2025-02-27T19:41:50.2447606Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:41:50.2448799Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:41:50.2449330Z 
2025-02-27T19:41:50.2449836Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:41:50.2450810Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:160:39)
2025-02-27T19:41:50.2451312Z 
2025-02-27T19:41:50.2452003Z   ● BuildingManager › purchase validation › should return false for non-existent buildings
2025-02-27T19:41:50.2452964Z 
2025-02-27T19:41:50.2453409Z     TypeError: Cannot read properties of undefined (reading 'non_existent')
2025-02-27T19:41:50.2453917Z 
2025-02-27T19:41:50.2454174Z     [0m [90m 165 |[39m     
2025-02-27T19:41:50.2454993Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:50.2456497Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:50.2457521Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:50.2458113Z      [90m 168 |[39m     
2025-02-27T19:41:50.2458917Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:41:50.2460134Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:41:50.2460679Z 
2025-02-27T19:41:50.2461188Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:41:50.2462227Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:193:38)
2025-02-27T19:41:50.2462759Z 
2025-02-27T19:41:50.2463423Z   ● BuildingManager › purchase validation › should return false for locked buildings
2025-02-27T19:41:50.2464262Z 
2025-02-27T19:41:50.2464722Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:41:50.2465241Z 
2025-02-27T19:41:50.2465541Z     [0m [90m 165 |[39m     
2025-02-27T19:41:50.2466615Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:50.2467879Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:50.2468920Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:50.2469481Z      [90m 168 |[39m     
2025-02-27T19:41:50.2470312Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:41:50.2471497Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:41:50.2472065Z 
2025-02-27T19:41:50.2472587Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:41:50.2473584Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:226:38)
2025-02-27T19:41:50.2474077Z 
2025-02-27T19:41:50.2474673Z   ● BuildingManager › purchasing › should purchase a building and deduct resources
2025-02-27T19:41:50.2475205Z 
2025-02-27T19:41:50.2475608Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:41:50.2476292Z 
2025-02-27T19:41:50.2476532Z     [0m [90m 197 |[39m     
2025-02-27T19:41:50.2477358Z      [90m 198 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:50.2478586Z     [31m[1m>[22m[39m[90m 199 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:50.2479544Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:50.2480067Z      [90m 200 |[39m     
2025-02-27T19:41:50.2480608Z      [90m 201 |[39m     [90m// Deduct resources[39m
2025-02-27T19:41:50.2481893Z      [90m 202 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mdeductResources(building[33m.[39mcost))[33m;[39m[0m
2025-02-27T19:41:50.2482657Z 
2025-02-27T19:41:50.2483114Z       at BuildingManager.purchaseBuilding (src/systems/buildingManager.ts:199:38)
2025-02-27T19:41:50.2484046Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:273:38)
2025-02-27T19:41:50.2484536Z 
2025-02-27T19:41:50.2485328Z   ● BuildingManager › production calculation › should correctly calculate production based on level and workers
2025-02-27T19:41:50.2486420Z 
2025-02-27T19:41:50.2486833Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:41:50.2487315Z 
2025-02-27T19:41:50.2487557Z     [0m [90m 222 |[39m     
2025-02-27T19:41:50.2488383Z      [90m 223 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:50.2489610Z     [31m[1m>[22m[39m[90m 224 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:50.2490614Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:50.2491142Z      [90m 225 |[39m     
2025-02-27T19:41:50.2491704Z      [90m 226 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:50.2492365Z      [90m 227 |[39m       [36mreturn[39m[33m;[39m[0m
2025-02-27T19:41:50.2492694Z 
2025-02-27T19:41:50.2493195Z       at BuildingManager.recalculateProduction (src/systems/buildingManager.ts:224:38)
2025-02-27T19:41:50.2494176Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:329:23)
2025-02-27T19:41:50.2494603Z 
2025-02-27T19:41:50.3583452Z FAIL src/systems/__tests__/saveManager.test.ts
2025-02-27T19:41:50.3671811Z   ● Console
2025-02-27T19:41:50.3680213Z 
2025-02-27T19:41:50.3680448Z     console.error
2025-02-27T19:41:50.3681652Z       [ERROR in SaveManager.loadGame]: this.actions.resetGame is not a function undefined
2025-02-27T19:41:50.3682166Z 
2025-02-27T19:41:50.3683253Z     [0m [90m 135 |[39m       console[33m.[39merror([32m`[CRITICAL${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:41:50.3684737Z      [90m 136 |[39m     } [36melse[39m [36mif[39m (severity [33m===[39m [33mErrorSeverity[39m[33m.[39m[33mERROR[39m) {
2025-02-27T19:41:50.3686561Z     [31m[1m>[22m[39m[90m 137 |[39m       console[33m.[39merror([32m`[ERROR${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:41:50.3687686Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:50.3688495Z      [90m 138 |[39m     }
2025-02-27T19:41:50.3717168Z      [90m 139 |[39m     
2025-02-27T19:41:50.3718230Z      [90m 140 |[39m     [90m// Skip logging INFO and WARNING to console[39m[0m
2025-02-27T19:41:50.3718747Z 
2025-02-27T19:41:50.3719104Z       at ErrorLogger.logError (src/utils/errorUtils.ts:137:15)
2025-02-27T19:41:50.3721995Z       at SaveManager.loadGame (src/systems/saveManager.ts:205:19)
2025-02-27T19:41:50.3722904Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:177:34)
2025-02-27T19:41:50.3723419Z 
2025-02-27T19:41:50.3723575Z     console.error
2025-02-27T19:41:50.3724379Z       [ERROR in SaveManager.deleteSaveAndReset]: this.actions.resetGame is not a function undefined
2025-02-27T19:41:50.3725019Z 
2025-02-27T19:41:50.3726371Z     [0m [90m 135 |[39m       console[33m.[39merror([32m`[CRITICAL${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:41:50.3728098Z      [90m 136 |[39m     } [36melse[39m [36mif[39m (severity [33m===[39m [33mErrorSeverity[39m[33m.[39m[33mERROR[39m) {
2025-02-27T19:41:50.3729872Z     [31m[1m>[22m[39m[90m 137 |[39m       console[33m.[39merror([32m`[ERROR${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:41:50.3731096Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:50.3731656Z      [90m 138 |[39m     }
2025-02-27T19:41:50.3732099Z      [90m 139 |[39m     
2025-02-27T19:41:50.3732833Z      [90m 140 |[39m     [90m// Skip logging INFO and WARNING to console[39m[0m
2025-02-27T19:41:50.3733292Z 
2025-02-27T19:41:50.3733630Z       at ErrorLogger.logError (src/utils/errorUtils.ts:137:15)
2025-02-27T19:41:50.3734480Z       at SaveManager.deleteSaveAndReset (src/systems/saveManager.ts:237:19)
2025-02-27T19:41:50.3736061Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:264:34)
2025-02-27T19:41:50.3736623Z 
2025-02-27T19:41:50.3737232Z   ● SaveManager › loadGame › should dispatch actions to restore game state
2025-02-27T19:41:50.3737759Z 
2025-02-27T19:41:50.3738077Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:50.3738499Z 
2025-02-27T19:41:50.3738660Z     Expected: true
2025-02-27T19:41:50.3739004Z     Received: false
2025-02-27T19:41:50.3739209Z 
2025-02-27T19:41:50.3739496Z     [0m [90m 178 |[39m       
2025-02-27T19:41:50.3740028Z      [90m 179 |[39m       [90m// Assert[39m
2025-02-27T19:41:50.3740954Z     [31m[1m>[22m[39m[90m 180 |[39m       expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:50.3741754Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:41:50.3742337Z      [90m 181 |[39m       
2025-02-27T19:41:50.3743055Z      [90m 182 |[39m       [90m// Verify reset actions were dispatched[39m
2025-02-27T19:41:50.3744302Z      [90m 183 |[39m       expect(mockDispatch)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[0m
2025-02-27T19:41:50.3744998Z 
2025-02-27T19:41:50.3745426Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:180:22)
2025-02-27T19:41:50.3746518Z 
2025-02-27T19:41:50.3747170Z   ● SaveManager › resetGame › should dispatch reset actions for all state slices
2025-02-27T19:41:50.3747695Z 
2025-02-27T19:41:50.3748002Z     TypeError: this.actions.resetGame is not a function
2025-02-27T19:41:50.3748393Z 
2025-02-27T19:41:50.3748931Z     [0m [90m 217 |[39m     [36mthis[39m[33m.[39mensureInitialized()[33m;[39m
2025-02-27T19:41:50.3749605Z      [90m 218 |[39m     
2025-02-27T19:41:50.3750730Z     [31m[1m>[22m[39m[90m 219 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetGame())[33m;[39m
2025-02-27T19:41:50.3751842Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:41:50.3753059Z      [90m 220 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetResources())[33m;[39m
2025-02-27T19:41:50.3754579Z      [90m 221 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetStructures())[33m;[39m
2025-02-27T19:41:50.3755491Z      [90m 222 |[39m   }[0m
2025-02-27T19:41:50.3755761Z 
2025-02-27T19:41:50.3756331Z       at SaveManager.resetGame (src/systems/saveManager.ts:219:32)
2025-02-27T19:41:50.3757205Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:243:19)
2025-02-27T19:41:50.3757719Z 
2025-02-27T19:41:50.3758296Z   ● SaveManager › deleteSaveAndReset › should delete the save and reset the game
2025-02-27T19:41:50.3758812Z 
2025-02-27T19:41:50.3759133Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:50.3759517Z 
2025-02-27T19:41:50.3759668Z     Expected: true
2025-02-27T19:41:50.3760005Z     Received: false
2025-02-27T19:41:50.3760239Z 
2025-02-27T19:41:50.3760525Z     [0m [90m 265 |[39m       
2025-02-27T19:41:50.3761088Z      [90m 266 |[39m       [90m// Assert[39m
2025-02-27T19:41:50.3762000Z     [31m[1m>[22m[39m[90m 267 |[39m       expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:50.3762884Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:41:50.3763934Z      [90m 268 |[39m       expect(saveUtils[33m.[39mdeleteSave)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:41:50.3765259Z      [90m 269 |[39m       expect(mockDispatch)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({
2025-02-27T19:41:50.3766804Z      [90m 270 |[39m         type[33m:[39m expect[33m.[39mstringContaining([32m'game/resetGame'[39m)[0m
2025-02-27T19:41:50.3767381Z 
2025-02-27T19:41:50.3767799Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:267:22)
2025-02-27T19:41:50.3768311Z 
2025-02-27T19:41:51.5400952Z PASS src/core/GameLoop.test.ts
2025-02-27T19:41:51.5459309Z   ● Console
2025-02-27T19:41:51.5459543Z 
2025-02-27T19:41:51.5459672Z     console.log
2025-02-27T19:41:51.5460107Z       GameLoop: Registered handler, total: 1
2025-02-27T19:41:51.5460424Z 
2025-02-27T19:41:51.5460762Z       at GameLoop.registerHandler (src/core/GameLoop.ts:290:17)
2025-02-27T19:41:51.5461208Z 
2025-02-27T19:41:51.5461349Z     console.log
2025-02-27T19:41:51.5461730Z       GameLoop: Started with tick rate 1Hz
2025-02-27T19:41:51.5462053Z 
2025-02-27T19:41:51.5462316Z       at GameLoop.start (src/core/GameLoop.ts:119:15)
2025-02-27T19:41:51.5462667Z 
2025-02-27T19:41:51.5462808Z     console.log
2025-02-27T19:41:51.5463375Z       Warning not called, but this is acceptable in the mock environment
2025-02-27T19:41:51.5463818Z 
2025-02-27T19:41:51.5464152Z       at Object.<anonymous> (src/core/GameLoop.test.ts:309:15)
2025-02-27T19:41:51.5464526Z 
2025-02-27T19:41:51.5464664Z     console.log
2025-02-27T19:41:51.5465099Z       GameLoop: Stopped after 2 ticks and 1 frames
2025-02-27T19:41:51.5465467Z 
2025-02-27T19:41:51.5465708Z       at GameLoop.stop (src/core/GameLoop.ts:137:15)
2025-02-27T19:41:51.5466289Z 
2025-02-27T19:41:51.5466423Z     console.log
2025-02-27T19:41:51.5466862Z       GameLoop: Unregistered handler, remaining: 0
2025-02-27T19:41:51.5467207Z 
2025-02-27T19:41:51.5467952Z       at GameLoop.unregisterHandler (src/core/GameLoop.ts:307:17)
2025-02-27T19:41:51.5468379Z 
2025-02-27T19:41:51.5767408Z PASS src/utils/resourceUtils.test.ts
2025-02-27T19:41:51.7898399Z FAIL src/integration/tasks.integration.test.ts
2025-02-27T19:41:51.8397927Z   ● Console
2025-02-27T19:41:51.8398229Z 
2025-02-27T19:41:51.8398371Z     console.log
2025-02-27T19:41:51.8398836Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:51.8399196Z 
2025-02-27T19:41:51.8399657Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:51.8400210Z 
2025-02-27T19:41:51.8400361Z     console.error
2025-02-27T19:41:51.8401148Z       Error starting task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8402425Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8403765Z           at TaskManager.startTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:263:12)
2025-02-27T19:41:51.8405130Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:151:32)
2025-02-27T19:41:51.8406765Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8407714Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8408676Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8409991Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8411123Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8412155Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8413427Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8414877Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8416326Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8417924Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8420089Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8422033Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8423300Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8424584Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8425455Z 
2025-02-27T19:41:51.8429755Z     [0m [90m 311 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8430683Z      [90m 312 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8432014Z     [31m[1m>[22m[39m[90m 313 |[39m       console[33m.[39merror([32m`Error starting task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8433163Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8434144Z      [90m 314 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8434976Z      [90m 315 |[39m     }
2025-02-27T19:41:51.8435552Z      [90m 316 |[39m   }[0m
2025-02-27T19:41:51.8436108Z 
2025-02-27T19:41:51.8436687Z       at TaskManager.startTask (src/managers/TaskManager.ts:313:15)
2025-02-27T19:41:51.8437579Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:151:32)
2025-02-27T19:41:51.8438420Z 
2025-02-27T19:41:51.8438578Z     console.error
2025-02-27T19:41:51.8439321Z       Error starting task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8440692Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8442052Z           at TaskManager.startTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:263:12)
2025-02-27T19:41:51.8443418Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:168:32)
2025-02-27T19:41:51.8444854Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8445789Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8446932Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8448240Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8449572Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8450819Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8452321Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8453981Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8455472Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8457506Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8459635Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8461344Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8462811Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8464285Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8465139Z 
2025-02-27T19:41:51.8503897Z     [0m [90m 311 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8504987Z      [90m 312 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8506393Z     [31m[1m>[22m[39m[90m 313 |[39m       console[33m.[39merror([32m`Error starting task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8507466Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8508366Z      [90m 314 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8509041Z      [90m 315 |[39m     }
2025-02-27T19:41:51.8509487Z      [90m 316 |[39m   }[0m
2025-02-27T19:41:51.8509734Z 
2025-02-27T19:41:51.8510089Z       at TaskManager.startTask (src/managers/TaskManager.ts:313:15)
2025-02-27T19:41:51.8510950Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:168:32)
2025-02-27T19:41:51.8511446Z 
2025-02-27T19:41:51.8511583Z     console.error
2025-02-27T19:41:51.8512306Z       Error starting task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8513557Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8514851Z           at TaskManager.startTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:263:12)
2025-02-27T19:41:51.8516717Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:178:32)
2025-02-27T19:41:51.8557719Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8558678Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8559653Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8560973Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8562079Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8563156Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8564466Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8566122Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8567391Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8569120Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8571045Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8572547Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8573814Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8575127Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8576005Z 
2025-02-27T19:41:51.8576597Z     [0m [90m 311 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8577322Z      [90m 312 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8578475Z     [31m[1m>[22m[39m[90m 313 |[39m       console[33m.[39merror([32m`Error starting task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8579474Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8580343Z      [90m 314 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8581527Z      [90m 315 |[39m     }
2025-02-27T19:41:51.8581987Z      [90m 316 |[39m   }[0m
2025-02-27T19:41:51.8582234Z 
2025-02-27T19:41:51.8582599Z       at TaskManager.startTask (src/managers/TaskManager.ts:313:15)
2025-02-27T19:41:51.8583454Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:178:32)
2025-02-27T19:41:51.8583961Z 
2025-02-27T19:41:51.8584094Z     console.error
2025-02-27T19:41:51.8584882Z       Error unlocking task locked-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8586393Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8587758Z           at TaskManager.unlockTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:417:12)
2025-02-27T19:41:51.8589059Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:188:32)
2025-02-27T19:41:51.8590462Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8591373Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8592320Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8593897Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8594966Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8596188Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8597410Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8598805Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8600012Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8601638Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8603544Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8605050Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8606543Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8607805Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8608441Z 
2025-02-27T19:41:51.8608959Z     [0m [90m 439 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8609681Z      [90m 440 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8610839Z     [31m[1m>[22m[39m[90m 441 |[39m       console[33m.[39merror([32m`Error unlocking task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8611899Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8612751Z      [90m 442 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8613430Z      [90m 443 |[39m     }
2025-02-27T19:41:51.8613881Z      [90m 444 |[39m   }[0m
2025-02-27T19:41:51.8614128Z 
2025-02-27T19:41:51.8614503Z       at TaskManager.unlockTask (src/managers/TaskManager.ts:441:15)
2025-02-27T19:41:51.8615339Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:188:32)
2025-02-27T19:41:51.8616037Z 
2025-02-27T19:41:51.8616188Z     console.error
2025-02-27T19:41:51.8616939Z       Error unlocking task locked-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8618537Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8619836Z           at TaskManager.unlockTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:417:12)
2025-02-27T19:41:51.8621174Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:203:32)
2025-02-27T19:41:51.8622522Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8623410Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8624360Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8625632Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8626983Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8628054Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8629352Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8631081Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8632303Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8633930Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8636072Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8637535Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8638749Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8640038Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8640702Z 
2025-02-27T19:41:51.8641186Z     [0m [90m 439 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8641864Z      [90m 440 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8642975Z     [31m[1m>[22m[39m[90m 441 |[39m       console[33m.[39merror([32m`Error unlocking task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8643910Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8644710Z      [90m 442 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8645348Z      [90m 443 |[39m     }
2025-02-27T19:41:51.8645758Z      [90m 444 |[39m   }[0m
2025-02-27T19:41:51.8646167Z 
2025-02-27T19:41:51.8646535Z       at TaskManager.unlockTask (src/managers/TaskManager.ts:441:15)
2025-02-27T19:41:51.8647349Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:203:32)
2025-02-27T19:41:51.8647831Z 
2025-02-27T19:41:51.8647963Z     console.error
2025-02-27T19:41:51.8648679Z       Error completing task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8649922Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8651220Z           at TaskManager.completeTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:325:12)
2025-02-27T19:41:51.8652493Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:214:32)
2025-02-27T19:41:51.8654068Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8654916Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8655814Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8657213Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8658217Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8659210Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8660468Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8661893Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8663031Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8664657Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8667017Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8668540Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8669799Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8671058Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8671733Z 
2025-02-27T19:41:51.8672265Z     [0m [90m 372 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8672966Z      [90m 373 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8674127Z     [31m[1m>[22m[39m[90m 374 |[39m       console[33m.[39merror([32m`Error completing task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8675133Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8676187Z      [90m 375 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8676871Z      [90m 376 |[39m     }
2025-02-27T19:41:51.8677307Z      [90m 377 |[39m   }[0m
2025-02-27T19:41:51.8677554Z 
2025-02-27T19:41:51.8677947Z       at TaskManager.completeTask (src/managers/TaskManager.ts:374:15)
2025-02-27T19:41:51.8678839Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:214:32)
2025-02-27T19:41:51.8679318Z 
2025-02-27T19:41:51.8679472Z     console.error
2025-02-27T19:41:51.8680201Z       Error completing task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8681467Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8682803Z           at TaskManager.completeTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:325:12)
2025-02-27T19:41:51.8684099Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:229:32)
2025-02-27T19:41:51.8685476Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8686534Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8687389Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8688542Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8689864Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8690802Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8691949Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8693198Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8694315Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8695731Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8697634Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8699064Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8700221Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8701613Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8702227Z 
2025-02-27T19:41:51.8702678Z     [0m [90m 372 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8703297Z      [90m 373 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8704331Z     [31m[1m>[22m[39m[90m 374 |[39m       console[33m.[39merror([32m`Error completing task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8705181Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8706081Z      [90m 375 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8706670Z      [90m 376 |[39m     }
2025-02-27T19:41:51.8707041Z      [90m 377 |[39m   }[0m
2025-02-27T19:41:51.8707254Z 
2025-02-27T19:41:51.8707597Z       at TaskManager.completeTask (src/managers/TaskManager.ts:374:15)
2025-02-27T19:41:51.8708354Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:229:32)
2025-02-27T19:41:51.8708781Z 
2025-02-27T19:41:51.8708900Z     console.error
2025-02-27T19:41:51.8709534Z       Error canceling task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8710637Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8711784Z           at TaskManager.cancelTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:386:12)
2025-02-27T19:41:51.8712931Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:240:32)
2025-02-27T19:41:51.8714151Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8714941Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8715731Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8716990Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8717883Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8718810Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8719914Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8721155Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8722473Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8723895Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8725663Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8727179Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8728336Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8729569Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8730260Z 
2025-02-27T19:41:51.8730702Z     [0m [90m 403 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8731394Z      [90m 404 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8732519Z     [31m[1m>[22m[39m[90m 405 |[39m       console[33m.[39merror([32m`Error canceling task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8733712Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8734545Z      [90m 406 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8735195Z      [90m 407 |[39m     }
2025-02-27T19:41:51.8735619Z      [90m 408 |[39m   }[0m
2025-02-27T19:41:51.8736042Z 
2025-02-27T19:41:51.8736395Z       at TaskManager.cancelTask (src/managers/TaskManager.ts:405:15)
2025-02-27T19:41:51.8737150Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:240:32)
2025-02-27T19:41:51.8737580Z 
2025-02-27T19:41:51.8737713Z     console.error
2025-02-27T19:41:51.8738459Z       Error checking task requirements: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8739634Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8741008Z           at TaskManager.checkAllTaskRequirements (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:452:12)
2025-02-27T19:41:51.8742458Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:271:34)
2025-02-27T19:41:51.8743842Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8744772Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8746381Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8747786Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8748894Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8749963Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8751296Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8752739Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8753962Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8755599Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8757737Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8759589Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8760854Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8762097Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8762815Z 
2025-02-27T19:41:51.8763293Z     [0m [90m 465 |[39m       [36mreturn[39m unlocked[33m;[39m
2025-02-27T19:41:51.8763983Z      [90m 466 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8765177Z     [31m[1m>[22m[39m[90m 467 |[39m       console[33m.[39merror([32m'Error checking task requirements:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8766387Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8767205Z      [90m 468 |[39m       [36mreturn[39m [35m0[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8767874Z      [90m 469 |[39m     }
2025-02-27T19:41:51.8768324Z      [90m 470 |[39m   }[0m
2025-02-27T19:41:51.8768575Z 
2025-02-27T19:41:51.8769072Z       at TaskManager.checkAllTaskRequirements (src/managers/TaskManager.ts:467:15)
2025-02-27T19:41:51.8770292Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:271:34)
2025-02-27T19:41:51.8770769Z 
2025-02-27T19:41:51.8770907Z     console.error
2025-02-27T19:41:51.8771612Z       Error starting task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8772858Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8774165Z           at TaskManager.startTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:263:12)
2025-02-27T19:41:51.8775462Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:306:17)
2025-02-27T19:41:51.8779604Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8780561Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8781527Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8798914Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8800105Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8801162Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8802476Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8803900Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8805146Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8807004Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8808896Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8810397Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8811669Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8812931Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8813946Z 
2025-02-27T19:41:51.8814478Z     [0m [90m 311 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8815182Z      [90m 312 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8816528Z     [31m[1m>[22m[39m[90m 313 |[39m       console[33m.[39merror([32m`Error starting task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8817428Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8818211Z      [90m 314 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8818822Z      [90m 315 |[39m     }
2025-02-27T19:41:51.8819209Z      [90m 316 |[39m   }[0m
2025-02-27T19:41:51.8819442Z 
2025-02-27T19:41:51.8819792Z       at TaskManager.startTask (src/managers/TaskManager.ts:313:15)
2025-02-27T19:41:51.8820556Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:306:17)
2025-02-27T19:41:51.8821023Z 
2025-02-27T19:41:51.8821159Z     console.error
2025-02-27T19:41:51.8821891Z       Error completing task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8823117Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8824451Z           at TaskManager.completeTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:325:12)
2025-02-27T19:41:51.8826217Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:313:17)
2025-02-27T19:41:51.8827586Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8828475Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8829396Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8830659Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8831724Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8832746Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8834026Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8835430Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8836794Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8838402Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8840316Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8841808Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8843058Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8844308Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8844989Z 
2025-02-27T19:41:51.8845455Z     [0m [90m 372 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:51.8846306Z      [90m 373 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8847480Z     [31m[1m>[22m[39m[90m 374 |[39m       console[33m.[39merror([32m`Error completing task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8848449Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8849278Z      [90m 375 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8850233Z      [90m 376 |[39m     }
2025-02-27T19:41:51.8850667Z      [90m 377 |[39m   }[0m
2025-02-27T19:41:51.8850896Z 
2025-02-27T19:41:51.8851272Z       at TaskManager.completeTask (src/managers/TaskManager.ts:374:15)
2025-02-27T19:41:51.8852099Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:313:17)
2025-02-27T19:41:51.8852579Z 
2025-02-27T19:41:51.8852731Z     console.error
2025-02-27T19:41:51.8853531Z       Error getting progress for task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:41:51.8854848Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:41:51.8856400Z           at TaskManager.getTaskProgress (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:500:12)
2025-02-27T19:41:51.8857762Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:334:34)
2025-02-27T19:41:51.8859163Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:51.8860072Z           at new Promise (<anonymous>)
2025-02-27T19:41:51.8861020Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:51.8862564Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:51.8863633Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:51.8864698Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:51.8866161Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:51.8867573Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:51.8868818Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:51.8870466Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:51.8872373Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:51.8873855Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:51.8875117Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:51.8876542Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:51.8877181Z 
2025-02-27T19:41:51.8877499Z     [0m [90m 519 |[39m       }[33m;[39m
2025-02-27T19:41:51.8878048Z      [90m 520 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:51.8879236Z     [31m[1m>[22m[39m[90m 521 |[39m       console[33m.[39merror([32m`Error getting progress for task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:51.8880247Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:51.8881062Z      [90m 522 |[39m       [36mreturn[39m [36mnull[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:41:51.8881693Z      [90m 523 |[39m     }
2025-02-27T19:41:51.8882120Z      [90m 524 |[39m   }[0m
2025-02-27T19:41:51.8882358Z 
2025-02-27T19:41:51.8882752Z       at TaskManager.getTaskProgress (src/managers/TaskManager.ts:521:15)
2025-02-27T19:41:51.8883615Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:334:34)
2025-02-27T19:41:51.8884100Z 
2025-02-27T19:41:51.8884610Z   ● Task System Integration › should start a task when requirements are met
2025-02-27T19:41:51.8885380Z 
2025-02-27T19:41:51.8885665Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:51.8886204Z 
2025-02-27T19:41:51.8886346Z     Expected: true
2025-02-27T19:41:51.8886669Z     Received: false
2025-02-27T19:41:51.8886863Z 
2025-02-27T19:41:51.8887662Z     [0m [90m 151 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mstartTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:41:51.8888452Z      [90m 152 |[39m     
2025-02-27T19:41:51.8889233Z     [31m[1m>[22m[39m[90m 153 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:51.8890042Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:41:51.8890877Z      [90m 154 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:41:51.8891685Z      [90m 155 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:41:51.8892503Z      [90m 156 |[39m         type[33m:[39m [32m'tasks/startTask'[39m[33m,[39m[0m
2025-02-27T19:41:51.8892939Z 
2025-02-27T19:41:51.8893489Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:153:20)
2025-02-27T19:41:51.8893999Z 
2025-02-27T19:41:51.8894471Z   ● Task System Integration › should check if task requirements are met
2025-02-27T19:41:51.8895148Z 
2025-02-27T19:41:51.8895433Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:51.8895802Z 
2025-02-27T19:41:51.8896087Z     Expected: true
2025-02-27T19:41:51.8896413Z     Received: false
2025-02-27T19:41:51.8896607Z 
2025-02-27T19:41:51.8897392Z     [0m [90m 188 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39munlockTask([32m'locked-task'[39m)[33m;[39m
2025-02-27T19:41:51.8898193Z      [90m 189 |[39m     
2025-02-27T19:41:51.8898960Z     [31m[1m>[22m[39m[90m 190 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:51.8899757Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:41:51.8900609Z      [90m 191 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:41:51.8901432Z      [90m 192 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:41:51.8902242Z      [90m 193 |[39m         type[33m:[39m [32m'tasks/unlockTask'[39m[33m,[39m[0m
2025-02-27T19:41:51.8902668Z 
2025-02-27T19:41:51.8903072Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:190:20)
2025-02-27T19:41:51.8903544Z 
2025-02-27T19:41:51.8903967Z   ● Task System Integration › should complete an in-progress task
2025-02-27T19:41:51.8904370Z 
2025-02-27T19:41:51.8904652Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:51.8905012Z 
2025-02-27T19:41:51.8905141Z     Expected: true
2025-02-27T19:41:51.8905457Z     Received: false
2025-02-27T19:41:51.8905656Z 
2025-02-27T19:41:51.8906581Z     [0m [90m 214 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mcompleteTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:41:51.8907352Z      [90m 215 |[39m     
2025-02-27T19:41:51.8908058Z     [31m[1m>[22m[39m[90m 216 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:51.8908839Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:41:51.8909676Z      [90m 217 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:41:51.8910503Z      [90m 218 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:41:51.8911334Z      [90m 219 |[39m         type[33m:[39m [32m'tasks/completeTask'[39m[33m,[39m[0m
2025-02-27T19:41:51.8911762Z 
2025-02-27T19:41:51.8912163Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:216:20)
2025-02-27T19:41:51.8912632Z 
2025-02-27T19:41:51.8913051Z   ● Task System Integration › should cancel an in-progress task
2025-02-27T19:41:51.8913452Z 
2025-02-27T19:41:51.8913746Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:51.8914353Z 
2025-02-27T19:41:51.8914490Z     Expected: true
2025-02-27T19:41:51.8914804Z     Received: false
2025-02-27T19:41:51.8915005Z 
2025-02-27T19:41:51.8915758Z     [0m [90m 240 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mcancelTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:41:51.8919553Z      [90m 241 |[39m     
2025-02-27T19:41:51.8920395Z     [31m[1m>[22m[39m[90m 242 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:41:51.8921226Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:41:51.8922098Z      [90m 243 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:41:51.8922953Z      [90m 244 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:41:51.8923779Z      [90m 245 |[39m         type[33m:[39m [32m'tasks/cancelTask'[39m[33m,[39m[0m
2025-02-27T19:41:51.8924212Z 
2025-02-27T19:41:51.8924624Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:242:20)
2025-02-27T19:41:51.8925134Z 
2025-02-27T19:41:51.8925748Z   ● Task System Integration › should check all task requirements and unlock eligible tasks
2025-02-27T19:41:51.8926511Z 
2025-02-27T19:41:51.8926799Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:41:51.8927418Z 
2025-02-27T19:41:51.8927546Z     Expected: 2
2025-02-27T19:41:51.8927854Z     Received: 0
2025-02-27T19:41:51.8928034Z 
2025-02-27T19:41:51.8928798Z     [0m [90m 271 |[39m     [36mconst[39m unlocked [33m=[39m taskManager[33m.[39mcheckAllTaskRequirements()[33m;[39m
2025-02-27T19:41:51.8929588Z      [90m 272 |[39m     
2025-02-27T19:41:51.8930617Z     [31m[1m>[22m[39m[90m 273 |[39m     expect(unlocked)[33m.[39mtoBe([35m2[39m)[33m;[39m [90m// Two tasks should be unlocked[39m
2025-02-27T19:41:51.8931602Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:41:51.8932454Z      [90m 274 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:41:51.8933308Z      [90m 275 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:41:51.8934119Z      [90m 276 |[39m         type[33m:[39m [32m'tasks/unlockTask'[39m[33m,[39m[0m
2025-02-27T19:41:51.8934534Z 
2025-02-27T19:41:51.8934941Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:273:22)
2025-02-27T19:41:51.8935416Z 
2025-02-27T19:41:51.8936053Z   ● Task System Integration › should emit events when task status changes
2025-02-27T19:41:51.8936474Z 
2025-02-27T19:41:51.8936760Z     expect(jest.fn()).toHaveBeenCalledWith(...expected)
2025-02-27T19:41:51.8937134Z 
2025-02-27T19:41:51.8937281Z     Expected: "test-task"
2025-02-27T19:41:51.8937518Z 
2025-02-27T19:41:51.8937654Z     Number of calls: 0
2025-02-27T19:41:51.8937877Z 
2025-02-27T19:41:51.8938128Z     [0m [90m 314 |[39m     
2025-02-27T19:41:51.8938748Z      [90m 315 |[39m     [90m// Verify events were emitted[39m
2025-02-27T19:41:51.8939878Z     [31m[1m>[22m[39m[90m 316 |[39m     expect(startedListener)[33m.[39mtoHaveBeenCalledWith([32m'test-task'[39m)[33m;[39m
2025-02-27T19:41:51.8940920Z      [90m     |[39m                             [31m[1m^[22m[39m
2025-02-27T19:41:51.8941918Z      [90m 317 |[39m     expect(completedListener)[33m.[39mtoHaveBeenCalledWith([32m'test-task'[39m)[33m;[39m
2025-02-27T19:41:51.8942764Z      [90m 318 |[39m   })[33m;[39m
2025-02-27T19:41:51.8943244Z      [90m 319 |[39m   [0m
2025-02-27T19:41:51.8943487Z 
2025-02-27T19:41:51.8943910Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:316:29)
2025-02-27T19:41:51.8944393Z 
2025-02-27T19:41:51.8944931Z   ● Task System Integration › should provide progress information for a task
2025-02-27T19:41:51.8945415Z 
2025-02-27T19:41:51.8945619Z     expect(received).not.toBeNull()
2025-02-27T19:41:51.8946089Z 
2025-02-27T19:41:51.8946234Z     Received: null
2025-02-27T19:41:51.8946442Z 
2025-02-27T19:41:51.8947286Z     [0m [90m 334 |[39m     [36mconst[39m progress [33m=[39m taskManager[33m.[39mgetTaskProgress([32m'test-task'[39m)[33m;[39m
2025-02-27T19:41:51.8948447Z      [90m 335 |[39m     
2025-02-27T19:41:51.8949297Z     [31m[1m>[22m[39m[90m 336 |[39m     expect(progress)[33m.[39mnot[33m.[39mtoBeNull()[33m;[39m
2025-02-27T19:41:51.8950194Z      [90m     |[39m                          [31m[1m^[22m[39m
2025-02-27T19:41:51.8951425Z      [90m 337 |[39m     expect(progress[33m?[39m[33m.[39mstatus)[33m.[39mtoBe([33mTaskStatus[39m[33m.[39m[33mIN_PROGRESS[39m)[33m;[39m
2025-02-27T19:41:51.8952788Z      [90m 338 |[39m     expect(progress[33m?[39m[33m.[39mprogress)[33m.[39mtoBe([35m50[39m)[33m;[39m
2025-02-27T19:41:51.8954148Z      [90m 339 |[39m     expect(progress[33m?[39m[33m.[39mtimeRemaining)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m
2025-02-27T19:41:51.8954820Z 
2025-02-27T19:41:51.8955250Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:336:26)
2025-02-27T19:41:51.8955759Z 
2025-02-27T19:41:52.5009463Z FAIL src/systems/__tests__/eventManager.test.ts
2025-02-27T19:41:52.5010884Z   ● Test suite failed to run
2025-02-27T19:41:52.5011414Z 
2025-02-27T19:41:52.5017857Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m65[0m:[93m42[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5022843Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5026636Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5029340Z 
2025-02-27T19:41:52.5031014Z     [7m65[0m     expect(() => eventManager.initialize(store)).not.toThrow();
2025-02-27T19:41:52.5033001Z     [7m  [0m [91m                                         ~~~~~[0m
2025-02-27T19:41:52.5034552Z 
2025-02-27T19:41:52.5036491Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5038723Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5046102Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5046646Z         'tutorial' is declared here.
2025-02-27T19:41:52.5049872Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m72[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5078999Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5080855Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5082156Z 
2025-02-27T19:41:52.5082610Z     [7m72[0m     eventManager.initialize(store);
2025-02-27T19:41:52.5083259Z     [7m  [0m [91m                            ~~~~~[0m
2025-02-27T19:41:52.5083566Z 
2025-02-27T19:41:52.5083903Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5084630Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5085249Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5085697Z         'tutorial' is declared here.
2025-02-27T19:41:52.5088872Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m85[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5091792Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5093587Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5094849Z 
2025-02-27T19:41:52.5095215Z     [7m85[0m     eventManager.initialize(store);
2025-02-27T19:41:52.5096105Z     [7m  [0m [91m                            ~~~~~[0m
2025-02-27T19:41:52.5096462Z 
2025-02-27T19:41:52.5096843Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5097647Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5098304Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5098758Z         'tutorial' is declared here.
2025-02-27T19:41:52.5101789Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m113[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5104529Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5106493Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5107765Z 
2025-02-27T19:41:52.5108141Z     [7m113[0m     eventManager.initialize(store);
2025-02-27T19:41:52.5108792Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:41:52.5109108Z 
2025-02-27T19:41:52.5109462Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5110197Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5110842Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5111301Z         'tutorial' is declared here.
2025-02-27T19:41:52.5114357Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m131[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5117000Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5118767Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5119978Z 
2025-02-27T19:41:52.5120344Z     [7m131[0m     eventManager.initialize(store);
2025-02-27T19:41:52.5120987Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:41:52.5121318Z 
2025-02-27T19:41:52.5121653Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5122371Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5122984Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5123430Z         'tutorial' is declared here.
2025-02-27T19:41:52.5126599Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m165[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5129329Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5131124Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5132400Z 
2025-02-27T19:41:52.5132767Z     [7m165[0m     eventManager.initialize(store);
2025-02-27T19:41:52.5133400Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:41:52.5133714Z 
2025-02-27T19:41:52.5134047Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5134757Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5135376Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5135809Z         'tutorial' is declared here.
2025-02-27T19:41:52.5139005Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m185[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5141698Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5143490Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5144761Z 
2025-02-27T19:41:52.5145096Z     [7m185[0m     eventManager.initialize(store);
2025-02-27T19:41:52.5145741Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:41:52.5146206Z 
2025-02-27T19:41:52.5146563Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5147272Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5147895Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5148359Z         'tutorial' is declared here.
2025-02-27T19:41:52.5151450Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m226[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5153920Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5155641Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5157120Z 
2025-02-27T19:41:52.5157501Z     [7m226[0m     eventManager.initialize(store);
2025-02-27T19:41:52.5158175Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:41:52.5158482Z 
2025-02-27T19:41:52.5158830Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5159559Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5160185Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5160625Z         'tutorial' is declared here.
2025-02-27T19:41:52.5163694Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m258[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5166620Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5168421Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5169738Z 
2025-02-27T19:41:52.5170140Z     [7m258[0m     eventManager.initialize(store);
2025-02-27T19:41:52.5170766Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:41:52.5171105Z 
2025-02-27T19:41:52.5171462Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5172221Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5172861Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5173326Z         'tutorial' is declared here.
2025-02-27T19:41:52.5176572Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m284[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:52.5179331Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:52.5181134Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:52.5182414Z 
2025-02-27T19:41:52.5182785Z     [7m284[0m     eventManager.initialize(store);
2025-02-27T19:41:52.5183443Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:41:52.5183755Z 
2025-02-27T19:41:52.5184103Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:52.5184828Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:52.5185444Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:52.5186186Z         'tutorial' is declared here.
2025-02-27T19:41:52.5186491Z 
2025-02-27T19:41:52.6318208Z PASS src/utils/__tests__/saveUtils.test.ts
2025-02-27T19:41:52.6491830Z   ● Console
2025-02-27T19:41:52.6492457Z 
2025-02-27T19:41:52.6492797Z     console.error
2025-02-27T19:41:52.6493464Z       Failed to save game: Error: Storage quota exceeded
2025-02-27T19:41:52.6494630Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:123:15)
2025-02-27T19:41:52.6496153Z           at /home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:397:39
2025-02-27T19:41:52.6499112Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:404:13)
2025-02-27T19:41:52.6510088Z           at Object.mockConstructor [as setItem] (/home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:108:19)
2025-02-27T19:41:52.6511373Z           at saveGame (/home/runner/work/idle-game/idle-game/src/utils/saveUtils.ts:56:18)
2025-02-27T19:41:52.6512556Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:127:30)
2025-02-27T19:41:52.6513829Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:52.6514776Z           at new Promise (<anonymous>)
2025-02-27T19:41:52.6515766Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:52.6517306Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:52.6518866Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:52.6520191Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:52.6521735Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:52.6523439Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:52.6525049Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:52.6526667Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:52.6528543Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:52.6530769Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:52.6532405Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:52.6534246Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:52.6536581Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:52.6538964Z 
2025-02-27T19:41:52.6540689Z     [0m [90m 58 |[39m     [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:52.6541928Z      [90m 59 |[39m   } [36mcatch[39m (error) {
2025-02-27T19:41:52.6544148Z     [31m[1m>[22m[39m[90m 60 |[39m     console[33m.[39merror([32m'Failed to save game:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:52.6546058Z      [90m    |[39m             [31m[1m^[22m[39m
2025-02-27T19:41:52.6547106Z      [90m 61 |[39m     [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:52.6548566Z      [90m 62 |[39m   }
2025-02-27T19:41:52.6549288Z      [90m 63 |[39m }[0m
2025-02-27T19:41:52.6549718Z 
2025-02-27T19:41:52.6550096Z       at saveGame (src/utils/saveUtils.ts:60:13)
2025-02-27T19:41:52.6551016Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:127:30)
2025-02-27T19:41:52.6551678Z 
2025-02-27T19:41:52.6551982Z     console.error
2025-02-27T19:41:52.6552771Z       Failed to load game: SyntaxError: Unexpected token i in JSON at position 0
2025-02-27T19:41:52.6553682Z           at JSON.parse (<anonymous>)
2025-02-27T19:41:52.6554641Z           at loadGame (/home/runner/work/idle-game/idle-game/src/utils/saveUtils.ts:79:37)
2025-02-27T19:41:52.6556245Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:164:30)
2025-02-27T19:41:52.6557899Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:52.6559009Z           at new Promise (<anonymous>)
2025-02-27T19:41:52.6560087Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:52.6561689Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:52.6563399Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:52.6564908Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:52.6568127Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:52.6569682Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:52.6571544Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:52.6572898Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:52.6574644Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:52.6576905Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:52.6578520Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:52.6579793Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:52.6581154Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:52.6581913Z 
2025-02-27T19:41:52.6582382Z     [0m [90m 93 |[39m     [36mreturn[39m saveData[33m;[39m
2025-02-27T19:41:52.6583140Z      [90m 94 |[39m   } [36mcatch[39m (error) {
2025-02-27T19:41:52.6584289Z     [31m[1m>[22m[39m[90m 95 |[39m     console[33m.[39merror([32m'Failed to load game:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:52.6585583Z      [90m    |[39m             [31m[1m^[22m[39m
2025-02-27T19:41:52.6586492Z      [90m 96 |[39m     [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:41:52.6587034Z      [90m 97 |[39m   }
2025-02-27T19:41:52.6587433Z      [90m 98 |[39m }[0m
2025-02-27T19:41:52.6587668Z 
2025-02-27T19:41:52.6587904Z       at loadGame (src/utils/saveUtils.ts:95:13)
2025-02-27T19:41:52.6588604Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:164:30)
2025-02-27T19:41:52.6589057Z 
2025-02-27T19:41:52.6589194Z     console.error
2025-02-27T19:41:52.6589622Z       Failed to delete save: Error: Storage error
2025-02-27T19:41:52.6590572Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:214:15)
2025-02-27T19:41:52.6591718Z           at /home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:397:39
2025-02-27T19:41:52.6592897Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:404:13)
2025-02-27T19:41:52.6594334Z           at Object.mockConstructor [as removeItem] (/home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:103:19)
2025-02-27T19:41:52.6595615Z           at deleteSave (/home/runner/work/idle-game/idle-game/src/utils/saveUtils.ts:105:18)
2025-02-27T19:41:52.6598303Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:218:32)
2025-02-27T19:41:52.6599631Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:52.6600542Z           at new Promise (<anonymous>)
2025-02-27T19:41:52.6601486Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:52.6602791Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:52.6603904Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:52.6604959Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:52.6606426Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:52.6607854Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:52.6609274Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:52.6610768Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:52.6612463Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:52.6614385Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:52.6616039Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:52.6617378Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:52.6618724Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:52.6619474Z 
2025-02-27T19:41:52.6619971Z     [0m [90m 108 |[39m     [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:41:52.6620693Z      [90m 109 |[39m   } [36mcatch[39m (error) {
2025-02-27T19:41:52.6621863Z     [31m[1m>[22m[39m[90m 110 |[39m     console[33m.[39merror([32m'Failed to delete save:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:52.6623107Z      [90m     |[39m             [31m[1m^[22m[39m
2025-02-27T19:41:52.6623869Z      [90m 111 |[39m     [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:52.6624517Z      [90m 112 |[39m   }
2025-02-27T19:41:52.6624988Z      [90m 113 |[39m }[0m
2025-02-27T19:41:52.6625238Z 
2025-02-27T19:41:52.6625496Z       at deleteSave (src/utils/saveUtils.ts:110:13)
2025-02-27T19:41:52.6626454Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:218:32)
2025-02-27T19:41:52.6626927Z 
2025-02-27T19:41:52.6627077Z     console.error
2025-02-27T19:41:52.6627474Z       No backup found at index 0
2025-02-27T19:41:52.6627728Z 
2025-02-27T19:41:52.6628007Z     [0m [90m 165 |[39m     
2025-02-27T19:41:52.6628673Z      [90m 166 |[39m     [36mif[39m ([33m![39mserializedState) {
2025-02-27T19:41:52.6629885Z     [31m[1m>[22m[39m[90m 167 |[39m       console[33m.[39merror([32m'No backup found at index'[39m[33m,[39m backupIndex)[33m;[39m
2025-02-27T19:41:52.6630916Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:52.6631679Z      [90m 168 |[39m       [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:41:52.6632300Z      [90m 169 |[39m     }
2025-02-27T19:41:52.6632800Z      [90m 170 |[39m     [0m
2025-02-27T19:41:52.6633062Z 
2025-02-27T19:41:52.6633380Z       at restoreFromBackup (src/utils/saveUtils.ts:167:15)
2025-02-27T19:41:52.6634153Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:272:39)
2025-02-27T19:41:52.6634640Z 
2025-02-27T19:41:52.6634777Z     console.error
2025-02-27T19:41:52.6635140Z       Invalid backup index
2025-02-27T19:41:52.6635418Z 
2025-02-27T19:41:52.6635753Z     [0m [90m 157 |[39m   [36mtry[39m {
2025-02-27T19:41:52.6636949Z      [90m 158 |[39m     [36mif[39m (backupIndex [33m>=[39m [33mBACKUP_SAVE_KEYS[39m[33m.[39mlength) {
2025-02-27T19:41:52.6638217Z     [31m[1m>[22m[39m[90m 159 |[39m       console[33m.[39merror([32m'Invalid backup index'[39m)[33m;[39m
2025-02-27T19:41:52.6639156Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:52.6639909Z      [90m 160 |[39m       [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:41:52.6640516Z      [90m 161 |[39m     }
2025-02-27T19:41:52.6641009Z      [90m 162 |[39m     [0m
2025-02-27T19:41:52.6641266Z 
2025-02-27T19:41:52.6641589Z       at restoreFromBackup (src/utils/saveUtils.ts:159:15)
2025-02-27T19:41:52.6642372Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:280:39)
2025-02-27T19:41:52.6642835Z 
2025-02-27T19:41:52.6642982Z     console.error
2025-02-27T19:41:52.6643607Z       Failed to import save: SyntaxError: Unexpected token o in JSON at position 1
2025-02-27T19:41:52.6644685Z           at JSON.parse (<anonymous>)
2025-02-27T19:41:52.6645521Z           at importSave (/home/runner/work/idle-game/idle-game/src/utils/saveUtils.ts:197:37)
2025-02-27T19:41:52.6646891Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:324:32)
2025-02-27T19:41:52.6648260Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:52.6649177Z           at new Promise (<anonymous>)
2025-02-27T19:41:52.6650114Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:52.6651414Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:52.6652492Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:52.6653536Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:52.6654804Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:52.6656376Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:52.6658017Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:52.6659226Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:52.6660824Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:52.6662690Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:52.6664180Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:52.6665418Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:52.6666877Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:52.6667557Z 
2025-02-27T19:41:52.6667990Z     [0m [90m 208 |[39m     [36mreturn[39m saveData[33m;[39m
2025-02-27T19:41:52.6668642Z      [90m 209 |[39m   } [36mcatch[39m (error) {
2025-02-27T19:41:52.6669689Z     [31m[1m>[22m[39m[90m 210 |[39m     console[33m.[39merror([32m'Failed to import save:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:52.6670588Z      [90m     |[39m             [31m[1m^[22m[39m
2025-02-27T19:41:52.6671270Z      [90m 211 |[39m     [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:41:52.6671831Z      [90m 212 |[39m   }
2025-02-27T19:41:52.6672227Z      [90m 213 |[39m }[0m
2025-02-27T19:41:52.6672448Z 
2025-02-27T19:41:52.6672692Z       at importSave (src/utils/saveUtils.ts:210:13)
2025-02-27T19:41:52.6673374Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:324:32)
2025-02-27T19:41:52.6673813Z 
2025-02-27T19:41:52.6673938Z     console.error
2025-02-27T19:41:52.6674288Z       Invalid save data format
2025-02-27T19:41:52.6674547Z 
2025-02-27T19:41:52.6674890Z     [0m [90m 199 |[39m     [90m// Validate the data[39m
2025-02-27T19:41:52.6676277Z      [90m 200 |[39m     [36mif[39m ([33m![39msaveData [33m||[39m [33m![39msaveData[33m.[39mversion [33m||[39m [33m![39msaveData[33m.[39mstate) {
2025-02-27T19:41:52.6677622Z     [31m[1m>[22m[39m[90m 201 |[39m       console[33m.[39merror([32m'Invalid save data format'[39m)[33m;[39m
2025-02-27T19:41:52.6678446Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:52.6679352Z      [90m 202 |[39m       [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:41:52.6679876Z      [90m 203 |[39m     }
2025-02-27T19:41:52.6680307Z      [90m 204 |[39m     [0m
2025-02-27T19:41:52.6680544Z 
2025-02-27T19:41:52.6680778Z       at importSave (src/utils/saveUtils.ts:201:15)
2025-02-27T19:41:52.6681456Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:335:32)
2025-02-27T19:41:52.6681890Z 
2025-02-27T19:41:52.8828147Z PASS src/managers/TaskManager.test.ts
2025-02-27T19:41:52.9123252Z   ● Console
2025-02-27T19:41:52.9123454Z 
2025-02-27T19:41:52.9123540Z     console.log
2025-02-27T19:41:52.9123813Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9124019Z 
2025-02-27T19:41:52.9124285Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9124600Z 
2025-02-27T19:41:52.9124680Z     console.log
2025-02-27T19:41:52.9124909Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9125124Z 
2025-02-27T19:41:52.9125372Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9125667Z 
2025-02-27T19:41:52.9125738Z     console.log
2025-02-27T19:41:52.9126132Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9126312Z 
2025-02-27T19:41:52.9126555Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9127146Z 
2025-02-27T19:41:52.9127229Z     console.error
2025-02-27T19:41:52.9127454Z       Task non-existent-task not found
2025-02-27T19:41:52.9127623Z 
2025-02-27T19:41:52.9127860Z     [0m [90m 267 |[39m       [90m// Validate task exists[39m
2025-02-27T19:41:52.9128263Z      [90m 268 |[39m       [36mif[39m ([33m![39mtask) {
2025-02-27T19:41:52.9129067Z     [31m[1m>[22m[39m[90m 269 |[39m         console[33m.[39merror([32m`Task ${taskId} not found`[39m)[33m;[39m
2025-02-27T19:41:52.9129859Z      [90m     |[39m                 [31m[1m^[22m[39m
2025-02-27T19:41:52.9130555Z      [90m 270 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:52.9131132Z      [90m 271 |[39m       }
2025-02-27T19:41:52.9131615Z      [90m 272 |[39m       [0m
2025-02-27T19:41:52.9131879Z 
2025-02-27T19:41:52.9132235Z       at TaskManager.startTask (src/managers/TaskManager.ts:269:17)
2025-02-27T19:41:52.9133003Z       at Object.<anonymous> (src/managers/TaskManager.test.ts:148:43)
2025-02-27T19:41:52.9133414Z 
2025-02-27T19:41:52.9133539Z     console.warn
2025-02-27T19:41:52.9134036Z       Task in-progress-task is not available (status: in_progress)
2025-02-27T19:41:52.9134424Z 
2025-02-27T19:41:52.9134827Z     [0m [90m 279 |[39m       [90m// Check if task is available[39m
2025-02-27T19:41:52.9136045Z      [90m 280 |[39m       [36mif[39m (task[33m.[39mstatus [33m!==[39m [33mTaskStatus[39m[33m.[39m[33mAVAILABLE[39m) {
2025-02-27T19:41:52.9137466Z     [31m[1m>[22m[39m[90m 281 |[39m         console[33m.[39mwarn([32m`Task ${taskId} is not available (status: ${task.status})`[39m)[33m;[39m
2025-02-27T19:41:52.9138403Z      [90m     |[39m                 [31m[1m^[22m[39m
2025-02-27T19:41:52.9139029Z      [90m 282 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:52.9139563Z      [90m 283 |[39m       }
2025-02-27T19:41:52.9140030Z      [90m 284 |[39m       [0m
2025-02-27T19:41:52.9140271Z 
2025-02-27T19:41:52.9140607Z       at TaskManager.startTask (src/managers/TaskManager.ts:281:17)
2025-02-27T19:41:52.9141293Z       at Object.<anonymous> (src/managers/TaskManager.test.ts:152:42)
2025-02-27T19:41:52.9141689Z 
2025-02-27T19:41:52.9141809Z     console.warn
2025-02-27T19:41:52.9142249Z       Task locked-task is not available (status: locked)
2025-02-27T19:41:52.9142586Z 
2025-02-27T19:41:52.9142946Z     [0m [90m 279 |[39m       [90m// Check if task is available[39m
2025-02-27T19:41:52.9143950Z      [90m 280 |[39m       [36mif[39m (task[33m.[39mstatus [33m!==[39m [33mTaskStatus[39m[33m.[39m[33mAVAILABLE[39m) {
2025-02-27T19:41:52.9145625Z     [31m[1m>[22m[39m[90m 281 |[39m         console[33m.[39mwarn([32m`Task ${taskId} is not available (status: ${task.status})`[39m)[33m;[39m
2025-02-27T19:41:52.9197333Z      [90m     |[39m                 [31m[1m^[22m[39m
2025-02-27T19:41:52.9198083Z      [90m 282 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:41:52.9198721Z      [90m 283 |[39m       }
2025-02-27T19:41:52.9199174Z      [90m 284 |[39m       [0m
2025-02-27T19:41:52.9199423Z 
2025-02-27T19:41:52.9199764Z       at TaskManager.startTask (src/managers/TaskManager.ts:281:17)
2025-02-27T19:41:52.9200501Z       at Object.<anonymous> (src/managers/TaskManager.test.ts:156:38)
2025-02-27T19:41:52.9200905Z 
2025-02-27T19:41:52.9201034Z     console.log
2025-02-27T19:41:52.9201418Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9201716Z 
2025-02-27T19:41:52.9202135Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9202639Z 
2025-02-27T19:41:52.9202756Z     console.log
2025-02-27T19:41:52.9203124Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9203417Z 
2025-02-27T19:41:52.9203822Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9204307Z 
2025-02-27T19:41:52.9204806Z     console.log
2025-02-27T19:41:52.9205191Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9205477Z 
2025-02-27T19:41:52.9206061Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9206553Z 
2025-02-27T19:41:52.9206671Z     console.log
2025-02-27T19:41:52.9207044Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9207341Z 
2025-02-27T19:41:52.9207750Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9208229Z 
2025-02-27T19:41:52.9208346Z     console.log
2025-02-27T19:41:52.9208710Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9208998Z 
2025-02-27T19:41:52.9209407Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9209868Z 
2025-02-27T19:41:52.9209989Z     console.log
2025-02-27T19:41:52.9210343Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9210631Z 
2025-02-27T19:41:52.9211047Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9211529Z 
2025-02-27T19:41:52.9211642Z     console.log
2025-02-27T19:41:52.9212014Z       TaskManager: Registered with GameLoop
2025-02-27T19:41:52.9212295Z 
2025-02-27T19:41:52.9212700Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:41:52.9213164Z 
2025-02-27T19:41:53.4830371Z PASS src/state/middleware/taskMiddleware.test.ts
2025-02-27T19:41:53.5369390Z FAIL src/systems/__tests__/gameLoop.test.ts
2025-02-27T19:41:53.5374203Z   ● Test suite failed to run
2025-02-27T19:41:53.5378554Z 
2025-02-27T19:41:53.5385037Z     [96msrc/systems/__tests__/gameLoop.test.ts[0m:[93m87[0m:[93m25[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; game: GameState; structures: StructuresState; events: EventsState; tasks: TasksState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:41:53.5391899Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:41:53.5398225Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; game: GameState; structures: StructuresState; events: EventsState; tasks: TasksState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:41:53.5403506Z 
2025-02-27T19:41:53.5408096Z     [7m87[0m     gameLoop.initialize(store);
2025-02-27T19:41:53.5411552Z     [7m  [0m [91m                        ~~~~~[0m
2025-02-27T19:41:53.5413923Z 
2025-02-27T19:41:53.5416675Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:53.5427394Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:53.5428074Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:53.5428554Z         'tutorial' is declared here.
2025-02-27T19:41:53.5428847Z 
2025-02-27T19:41:54.1287448Z PASS src/core/GameTimer.test.ts
2025-02-27T19:41:54.3266736Z FAIL src/gameCore.integration.test.tsx
2025-02-27T19:41:54.3267940Z   ● Game Core Systems Integration › Building purchase consumes resources correctly
2025-02-27T19:41:54.3268500Z 
2025-02-27T19:41:54.3268949Z     TypeError: Cannot read properties of undefined (reading 'communityGarden')
2025-02-27T19:41:54.3269503Z 
2025-02-27T19:41:54.3269816Z     [0m [90m 165 |[39m     
2025-02-27T19:41:54.3270717Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:54.3272048Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:54.3273252Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:54.3273849Z      [90m 168 |[39m     
2025-02-27T19:41:54.3274704Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:41:54.3276696Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:41:54.3277294Z 
2025-02-27T19:41:54.3277825Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:41:54.3278902Z       at BuildingManager.purchaseBuilding (src/systems/buildingManager.ts:194:58)
2025-02-27T19:41:54.3279898Z       at Object.<anonymous> (src/gameCore.integration.test.tsx:171:36)
2025-02-27T19:41:54.3280377Z 
2025-02-27T19:41:54.3281022Z   ● Game Core Systems Integration › Building level affects production calculation
2025-02-27T19:41:54.3281587Z 
2025-02-27T19:41:54.3282058Z     TypeError: Cannot read properties of undefined (reading 'communityGarden')
2025-02-27T19:41:54.3282583Z 
2025-02-27T19:41:54.3282880Z     [0m [90m 274 |[39m     
2025-02-27T19:41:54.3283783Z      [90m 275 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:54.3285147Z     [31m[1m>[22m[39m[90m 276 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:54.3286475Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:54.3287087Z      [90m 277 |[39m     
2025-02-27T19:41:54.3287716Z      [90m 278 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:54.3288492Z      [90m 279 |[39m       [36mreturn[39m {}[33m;[39m[0m
2025-02-27T19:41:54.3288866Z 
2025-02-27T19:41:54.3289389Z       at BuildingManager.calculateUpgradeCost (src/systems/buildingManager.ts:276:38)
2025-02-27T19:41:54.3290375Z       at Object.<anonymous> (src/gameCore.integration.test.tsx:209:41)
2025-02-27T19:41:54.3290863Z 
2025-02-27T19:41:54.7407965Z PASS src/core/GameManager.test.ts
2025-02-27T19:41:54.7668366Z   ● Console
2025-02-27T19:41:54.7672221Z 
2025-02-27T19:41:54.7675608Z     console.log
2025-02-27T19:41:54.7677357Z       GameManager: Started time scale sync interval
2025-02-27T19:41:54.7681253Z 
2025-02-27T19:41:54.7685040Z       at GameManager.startTimeScaleSync (src/core/GameManager.ts:269:15)
2025-02-27T19:41:54.7686706Z 
2025-02-27T19:41:54.7690564Z     console.log
2025-02-27T19:41:54.7694731Z       GameManager: Started Redux time sync interval
2025-02-27T19:41:54.7698778Z 
2025-02-27T19:41:54.7702595Z       at GameManager.startReduxTimeSync (src/core/GameManager.ts:309:15)
2025-02-27T19:41:54.7706838Z 
2025-02-27T19:41:54.7707236Z     console.error
2025-02-27T19:41:54.7711932Z       Error checking all progression items: TypeError: Cannot read properties of undefined (reading 'milestoneIds')
2025-02-27T19:41:54.7713690Z           at selectMilestoneIds (/home/runner/work/idle-game/idle-game/src/redux/progressionSlice.ts:199:92)
2025-02-27T19:41:54.7716941Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:41:54.7722194Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:41:54.7724068Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:41:54.7725774Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:41:54.7730986Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:41:54.7758962Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:41:54.7761196Z           at ProgressionManager.checkAllProgressionItems (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:710:56)
2025-02-27T19:41:54.7763122Z           at GameManager.updateResourceSystem (/home/runner/work/idle-game/idle-game/src/core/GameManager.ts:471:30)
2025-02-27T19:41:54.7764780Z           at GameManager.update (/home/runner/work/idle-game/idle-game/src/core/GameManager.ts:420:12)
2025-02-27T19:41:54.7766869Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/core/GameManager.test.ts:110:5)
2025-02-27T19:41:54.7768365Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:54.7769379Z           at new Promise (<anonymous>)
2025-02-27T19:41:54.7770539Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:54.7771862Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:54.7772916Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:54.7773944Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:54.7775203Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:54.7776834Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:54.7778037Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:54.7779642Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:54.7781493Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:54.7782955Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:54.7784184Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:54.7785413Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:54.7786222Z 
2025-02-27T19:41:54.7786642Z     [0m [90m 725 |[39m       }
2025-02-27T19:41:54.7787159Z      [90m 726 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:54.7788225Z     [31m[1m>[22m[39m[90m 727 |[39m       console[33m.[39merror([32m'Error checking all progression items:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:54.7789234Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:54.7789695Z      [90m 728 |[39m     }
2025-02-27T19:41:54.7790441Z      [90m 729 |[39m     
2025-02-27T19:41:54.7791033Z      [90m 730 |[39m     [36mif[39m (itemsUpdated [33m>[39m [35m0[39m) {[0m
2025-02-27T19:41:54.7791428Z 
2025-02-27T19:41:54.7792099Z       at ProgressionManager.checkAllProgressionItems (src/managers/progression/ProgressionManager.ts:727:15)
2025-02-27T19:41:54.7793195Z       at GameManager.updateResourceSystem (src/core/GameManager.ts:471:30)
2025-02-27T19:41:54.7793937Z       at GameManager.update (src/core/GameManager.ts:420:12)
2025-02-27T19:41:54.7794593Z       at Object.<anonymous> (src/core/GameManager.test.ts:110:5)
2025-02-27T19:41:54.7794967Z 
2025-02-27T19:41:54.7795109Z     console.error
2025-02-27T19:41:54.7796065Z       Error checking all progression items: TypeError: Cannot read properties of undefined (reading 'milestoneIds')
2025-02-27T19:41:54.7797296Z           at selectMilestoneIds (/home/runner/work/idle-game/idle-game/src/redux/progressionSlice.ts:199:92)
2025-02-27T19:41:54.7798622Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:41:54.7800055Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:41:54.7801356Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:41:54.7802956Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:41:54.7804410Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:41:54.7805739Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:41:54.7807478Z           at ProgressionManager.checkAllProgressionItems (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:710:56)
2025-02-27T19:41:54.7809105Z           at GameManager.updateResourceSystem (/home/runner/work/idle-game/idle-game/src/core/GameManager.ts:471:30)
2025-02-27T19:41:54.7810367Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/core/GameManager.test.ts:133:26)
2025-02-27T19:41:54.7811583Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:54.7812498Z           at new Promise (<anonymous>)
2025-02-27T19:41:54.7813424Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:54.7814713Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:54.7815777Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:54.7816984Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:54.7818291Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:54.7819693Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:54.7820941Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:54.7822579Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:54.7824498Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:54.7826162Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:54.7827402Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:54.7829003Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:54.7829675Z 
2025-02-27T19:41:54.7830051Z     [0m [90m 725 |[39m       }
2025-02-27T19:41:54.7830654Z      [90m 726 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:54.7831895Z     [31m[1m>[22m[39m[90m 727 |[39m       console[33m.[39merror([32m'Error checking all progression items:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:54.7832933Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:54.7833426Z      [90m 728 |[39m     }
2025-02-27T19:41:54.7833842Z      [90m 729 |[39m     
2025-02-27T19:41:54.7834523Z      [90m 730 |[39m     [36mif[39m (itemsUpdated [33m>[39m [35m0[39m) {[0m
2025-02-27T19:41:54.7834950Z 
2025-02-27T19:41:54.7835652Z       at ProgressionManager.checkAllProgressionItems (src/managers/progression/ProgressionManager.ts:727:15)
2025-02-27T19:41:54.7836958Z       at GameManager.updateResourceSystem (src/core/GameManager.ts:471:30)
2025-02-27T19:41:54.7837756Z       at Object.<anonymous> (src/core/GameManager.test.ts:133:26)
2025-02-27T19:41:54.7838162Z 
2025-02-27T19:41:54.7838304Z     console.error
2025-02-27T19:41:54.7839396Z       Error checking all progression items: TypeError: Cannot read properties of undefined (reading 'milestoneIds')
2025-02-27T19:41:54.7840693Z           at selectMilestoneIds (/home/runner/work/idle-game/idle-game/src/redux/progressionSlice.ts:199:92)
2025-02-27T19:41:54.7842059Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:41:54.7843544Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:41:54.7844933Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:41:54.7846538Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:41:54.7848059Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:41:54.7849454Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:41:54.7851067Z           at ProgressionManager.checkAllProgressionItems (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:710:56)
2025-02-27T19:41:54.7852743Z           at GameManager.updateResourceSystem (/home/runner/work/idle-game/idle-game/src/core/GameManager.ts:471:30)
2025-02-27T19:41:54.7854036Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/core/GameManager.test.ts:153:26)
2025-02-27T19:41:54.7855384Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:41:54.7856467Z           at new Promise (<anonymous>)
2025-02-27T19:41:54.7857404Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:41:54.7858686Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:41:54.7859742Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:41:54.7860780Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:41:54.7862061Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:41:54.7863494Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:41:54.7864748Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:41:54.7866796Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:41:54.7868692Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:41:54.7870198Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:41:54.7871450Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:41:54.7872672Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:41:54.7873301Z 
2025-02-27T19:41:54.7873678Z     [0m [90m 725 |[39m       }
2025-02-27T19:41:54.7874178Z      [90m 726 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:41:54.7875197Z     [31m[1m>[22m[39m[90m 727 |[39m       console[33m.[39merror([32m'Error checking all progression items:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:41:54.7876226Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:41:54.7876648Z      [90m 728 |[39m     }
2025-02-27T19:41:54.7877290Z      [90m 729 |[39m     
2025-02-27T19:41:54.7877852Z      [90m 730 |[39m     [36mif[39m (itemsUpdated [33m>[39m [35m0[39m) {[0m
2025-02-27T19:41:54.7878207Z 
2025-02-27T19:41:54.7878785Z       at ProgressionManager.checkAllProgressionItems (src/managers/progression/ProgressionManager.ts:727:15)
2025-02-27T19:41:54.7879820Z       at GameManager.updateResourceSystem (src/core/GameManager.ts:471:30)
2025-02-27T19:41:54.7880511Z       at Object.<anonymous> (src/core/GameManager.test.ts:153:26)
2025-02-27T19:41:54.7880841Z 
2025-02-27T19:41:54.8235536Z FAIL src/state/selectors.test.ts
2025-02-27T19:41:54.8239346Z   ● Test suite failed to run
2025-02-27T19:41:54.8246951Z 
2025-02-27T19:41:54.8250986Z     [96msrc/state/selectors.test.ts[0m:[93m94[0m:[93m32[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ resources: { 'collective-power': Resource; solidarity: Resource; 'community-trust': Resource; }; structures: { 'union-office': Structure; 'community-center': Structure; 'alternative-media': Structure; }; game: { ...; }; tasks: { ...; }; events: { ...; }; progression: { ...; }; }' to type 'RootState' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
2025-02-27T19:41:54.8256193Z       Property 'tutorial' is missing in type '{ resources: { 'collective-power': Resource; solidarity: Resource; 'community-trust': Resource; }; structures: { 'union-office': Structure; 'community-center': Structure; 'alternative-media': Structure; }; game: { ...; }; tasks: { ...; }; events: { ...; }; progression: { ...; }; }' but required in type 'RootState'.
2025-02-27T19:41:54.8258094Z 
2025-02-27T19:41:54.8258502Z     [7m 94[0m   const mockState: RootState = {
2025-02-27T19:41:54.8259190Z     [7m   [0m [91m                               ~[0m
2025-02-27T19:41:54.8259784Z     [7m 95[0m     resources: {
2025-02-27T19:41:54.8260310Z     [7m   [0m [91m~~~~~~~~~~~~~~~~[0m
2025-02-27T19:41:54.8260757Z     [7m...[0m 
2025-02-27T19:41:54.8261142Z     [7m163[0m     }
2025-02-27T19:41:54.8261601Z     [7m   [0m [91m~~~~~[0m
2025-02-27T19:41:54.8262108Z     [7m164[0m   } as RootState;
2025-02-27T19:41:54.8262676Z     [7m   [0m [91m~~~~~~~~~~~~~~~~[0m
2025-02-27T19:41:54.8262971Z 
2025-02-27T19:41:54.8263344Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:41:54.8264113Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:41:54.8264768Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:41:54.8265248Z         'tutorial' is declared here.
2025-02-27T19:41:54.8265542Z 
2025-02-27T19:41:55.4626487Z PASS src/tests/gameSystemCoherenceTest.test.ts
2025-02-27T19:41:55.5581960Z PASS src/systems/gameLoop.test.ts
2025-02-27T19:41:55.5614308Z   ● Console
2025-02-27T19:41:55.5615715Z 
2025-02-27T19:41:55.5617433Z     console.log
2025-02-27T19:41:55.5619087Z       GameLoop: Window event listeners attached
2025-02-27T19:41:55.5620638Z 
2025-02-27T19:41:55.5622297Z       at GameLoop.setupWindowEventListeners (src/systems/gameLoop.ts:516:13)
2025-02-27T19:41:55.5623958Z 
2025-02-27T19:41:55.5625239Z     console.log
2025-02-27T19:41:55.5627163Z       gameSlice.addPlayTime: Adding 10.00s, old=0.00, new=10.00
2025-02-27T19:41:55.5656451Z 
2025-02-27T19:41:55.5657491Z       at addPlayTime (src/state/gameSlice.ts:62:17)
2025-02-27T19:41:55.5658097Z           at Array.reduce (<anonymous>)
2025-02-27T19:41:55.5658406Z 
2025-02-27T19:41:55.9317811Z FAIL src/workers.integration.test.tsx
2025-02-27T19:41:55.9320237Z   ● Worker System Integration Test › WorkerManager can assign and manage workers
2025-02-27T19:41:55.9322114Z 
2025-02-27T19:41:55.9323729Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:41:55.9325369Z 
2025-02-27T19:41:55.9327104Z     [0m [90m 190 |[39m     
2025-02-27T19:41:55.9329258Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:41:55.9332268Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:41:55.9334596Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:41:55.9336651Z      [90m 193 |[39m     
2025-02-27T19:41:55.9338531Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:41:55.9340610Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:41:55.9406794Z 
2025-02-27T19:41:55.9407793Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:41:55.9408866Z       at Object.<anonymous> (src/workers.integration.test.tsx:105:19)
2025-02-27T19:41:55.9409304Z 
2025-02-27T19:41:56.4992251Z FAIL src/systems/__tests__/oppressionSystem.test.ts
2025-02-27T19:41:56.4993287Z   ● Console
2025-02-27T19:41:56.4993623Z 
2025-02-27T19:41:56.5026665Z     console.log
2025-02-27T19:41:56.5066649Z       Resources before: {
2025-02-27T19:41:56.5067082Z         "collective-power": {
2025-02-27T19:41:56.5067578Z           "id": "collective-power",
2025-02-27T19:41:56.5068091Z           "name": "Collective Power",
2025-02-27T19:41:56.5068519Z           "amount": 0,
2025-02-27T19:41:56.5068857Z           "maxAmount": 1000,
2025-02-27T19:41:56.5069231Z           "perSecond": 0.1,
2025-02-27T19:41:56.5069665Z           "basePerSecond": 0.1,
2025-02-27T19:41:56.5070149Z           "description": "Test power resource",
2025-02-27T19:41:56.5070615Z           "unlocked": true,
2025-02-27T19:41:56.5071038Z           "category": "primary",
2025-02-27T19:41:56.5071456Z           "clickPower": 1
2025-02-27T19:41:56.5071788Z         },
2025-02-27T19:41:56.5072087Z         "oppression": {
2025-02-27T19:41:56.5072445Z           "id": "oppression",
2025-02-27T19:41:56.5072894Z           "name": "Corporate Oppression",
2025-02-27T19:41:56.5073318Z           "amount": 0,
2025-02-27T19:41:56.5073664Z           "maxAmount": 1000,
2025-02-27T19:41:56.5074053Z           "perSecond": 0.05,
2025-02-27T19:41:56.5074474Z           "basePerSecond": 0.05,
2025-02-27T19:41:56.5074979Z           "description": "Test oppression resource",
2025-02-27T19:41:56.5075749Z           "unlocked": true,
2025-02-27T19:41:56.5076350Z           "category": "threat"
2025-02-27T19:41:56.5076882Z         }
2025-02-27T19:41:56.5077262Z       }
2025-02-27T19:41:56.5077509Z 
2025-02-27T19:41:56.5078098Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:63:13)
2025-02-27T19:41:56.5078598Z 
2025-02-27T19:41:56.5079463Z   ● Oppression System › oppression resource should generate at the specified rate
2025-02-27T19:41:56.5080574Z 
2025-02-27T19:41:56.5081100Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:41:56.5081698Z 
2025-02-27T19:41:56.5083350Z     [0m [90m 178 |[39m     
2025-02-27T19:41:56.5084775Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:41:56.5087446Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:41:56.5090042Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:41:56.5090774Z      [90m 181 |[39m     
2025-02-27T19:41:56.5091439Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:41:56.5092412Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:41:56.5093031Z 
2025-02-27T19:41:56.5093660Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:41:56.5094754Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:67:21)
2025-02-27T19:41:56.5095264Z 
2025-02-27T19:41:56.5096135Z   ● Oppression System › oppression should continue to generate in multiple ticks
2025-02-27T19:41:56.5096982Z 
2025-02-27T19:41:56.5097369Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:41:56.5097808Z 
2025-02-27T19:41:56.5098092Z     [0m [90m 178 |[39m     
2025-02-27T19:41:56.5099028Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:41:56.5101350Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:41:56.5103035Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:41:56.5103579Z      [90m 181 |[39m     
2025-02-27T19:41:56.5104136Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:41:56.5105031Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:41:56.5105513Z 
2025-02-27T19:41:56.5106259Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:41:56.5107224Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:85:23)
2025-02-27T19:41:56.5107729Z 
2025-02-27T19:41:56.5108397Z   ● Oppression System › oppression should generate even if its perSecond property is modified
2025-02-27T19:41:56.5108987Z 
2025-02-27T19:41:56.5109345Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:41:56.5109759Z 
2025-02-27T19:41:56.5110012Z     [0m [90m 178 |[39m     
2025-02-27T19:41:56.5110888Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:41:56.5113157Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:41:56.5114798Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:41:56.5115316Z      [90m 181 |[39m     
2025-02-27T19:41:56.5115988Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:41:56.5116825Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:41:56.5117276Z 
2025-02-27T19:41:56.5117727Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:41:56.5118643Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:107:21)
2025-02-27T19:41:56.5119358Z 
2025-02-27T19:41:56.5119946Z   ● Oppression System › oppression generation should scale with time delta correctly
2025-02-27T19:41:56.5120477Z 
2025-02-27T19:41:56.5120830Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:41:56.5121276Z 
2025-02-27T19:41:56.5121505Z     [0m [90m 178 |[39m     
2025-02-27T19:41:56.5122396Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:41:56.5124619Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:41:56.5126399Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:41:56.5126967Z      [90m 181 |[39m     
2025-02-27T19:41:56.5127511Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:41:56.5128361Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:41:56.5128831Z 
2025-02-27T19:41:56.5129278Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:41:56.5130490Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:127:23)
2025-02-27T19:41:56.5130992Z 
2025-02-27T19:41:56.8582935Z PASS src/components/progression/__tests__/ProgressionTracker.test.tsx
2025-02-27T19:41:57.3317472Z PASS src/systems/__tests__/gameEndConditions.test.ts
2025-02-27T19:41:57.5247493Z PASS src/utils/__tests__/timeUtils.test.ts
2025-02-27T19:41:57.5784669Z PASS src/components/buildings/__tests__/BuildingItem.test.tsx
2025-02-27T19:41:57.8445019Z PASS src/state/structuresSlice.test.ts
2025-02-27T19:41:58.7018531Z PASS src/components/ResourceList.test.tsx
2025-02-27T19:41:59.1637595Z PASS src/components/buildings/__tests__/BuildingList.test.tsx
2025-02-27T19:42:00.7667734Z PASS src/components/__tests__/GameTimer.test.tsx
2025-02-27T19:42:00.9512946Z PASS src/components/progression/__tests__/MilestoneProgressStrip.test.tsx
2025-02-27T19:42:01.5660814Z PASS src/components/ResourceDisplay.test.tsx
2025-02-27T19:42:01.9277443Z FAIL src/components/App.test.tsx
2025-02-27T19:42:01.9279490Z   ● Test suite failed to run
2025-02-27T19:42:01.9280902Z 
2025-02-27T19:42:01.9283058Z     [96msrc/managers/TutorialManager.ts[0m:[93m3[0m:[93m10[0m - [91merror[0m[90m TS2305: [0mModule '"../state/store"' has no exported member 'AppState'.
2025-02-27T19:42:01.9284138Z 
2025-02-27T19:42:01.9284653Z     [7m3[0m import { AppState } from '../state/store';
2025-02-27T19:42:01.9285230Z     [7m [0m [91m         ~~~~~~~~[0m
2025-02-27T19:42:01.9287100Z     [96msrc/managers/TutorialManager.ts[0m:[93m79[0m:[93m24[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:42:01.9288403Z 
2025-02-27T19:42:01.9288800Z     [7m79[0m       const tutorial = tutorialContent[currentStep];
2025-02-27T19:42:01.9289522Z     [7m  [0m [91m                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:42:01.9291335Z     [96msrc/managers/TutorialManager.ts[0m:[93m99[0m:[93m24[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:42:01.9292447Z 
2025-02-27T19:42:01.9292820Z     [7m99[0m       const tutorial = tutorialContent[currentStep];
2025-02-27T19:42:01.9293525Z     [7m  [0m [91m                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:42:01.9295428Z     [96msrc/managers/TutorialManager.ts[0m:[93m155[0m:[93m14[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:42:01.9297187Z 
2025-02-27T19:42:01.9297561Z     [7m155[0m       return tutorialContent[currentStep];
2025-02-27T19:42:01.9298240Z     [7m   [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:42:01.9298555Z 
2025-02-27T19:42:02.0827420Z PASS src/components/__tests__/OfflineProgressModal.test.tsx
2025-02-27T19:42:02.0896832Z   ● Console
2025-02-27T19:42:02.0900689Z 
2025-02-27T19:42:02.0904303Z     console.error
2025-02-27T19:42:02.0908108Z       An update to OfflineProgressModal inside a test was not wrapped in act(...).
2025-02-27T19:42:02.0910797Z       
2025-02-27T19:42:02.0913413Z       When testing, code that causes React state updates should be wrapped into act(...):
2025-02-27T19:42:02.0916359Z       
2025-02-27T19:42:02.0918090Z       act(() => {
2025-02-27T19:42:02.0920311Z         /* fire events that update state */
2025-02-27T19:42:02.0945453Z       });
2025-02-27T19:42:02.0950083Z       /* assert on the output */
2025-02-27T19:42:02.0950551Z       
2025-02-27T19:42:02.0956960Z       This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
2025-02-27T19:42:02.0957705Z 
2025-02-27T19:42:02.0958385Z     [0m [90m 37 |[39m       [90m// Reset closing state after the animation completes[39m
2025-02-27T19:42:02.0959615Z      [90m 38 |[39m       setTimeout(() [33m=>[39m {
2025-02-27T19:42:02.0960362Z     [31m[1m>[22m[39m[90m 39 |[39m         setIsClosing([36mfalse[39m)[33m;[39m
2025-02-27T19:42:02.0961039Z      [90m    |[39m         [31m[1m^[22m[39m
2025-02-27T19:42:02.0961688Z      [90m 40 |[39m       }[33m,[39m [35m100[39m)[33m;[39m
2025-02-27T19:42:02.0962542Z      [90m 41 |[39m     }[33m,[39m [35m300[39m)[33m;[39m [90m// Animation duration[39m
2025-02-27T19:42:02.0963262Z      [90m 42 |[39m   }[33m;[39m[0m
2025-02-27T19:42:02.0963569Z 
2025-02-27T19:42:02.0964005Z       at node_modules/react-dom/cjs/react-dom-client.development.js:15751:19
2025-02-27T19:42:02.0965026Z       at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:42:02.0966488Z       at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:15750:9)
2025-02-27T19:42:02.0967706Z       at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:14311:11)
2025-02-27T19:42:02.0968868Z       at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:7208:13)
2025-02-27T19:42:02.0969941Z       at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:7161:7)
2025-02-27T19:42:02.0970768Z       at src/components/OfflineProgressModal.tsx:39:9
2025-02-27T19:42:02.0971501Z       at callTimer (node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:744:24)
2025-02-27T19:42:02.0972397Z       at doTickInner (node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1312:29)
2025-02-27T19:42:02.0973319Z       at doTick (node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1393:20)
2025-02-27T19:42:02.0974209Z       at Object.tick (node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1401:20)
2025-02-27T19:42:02.0975284Z       at FakeTimers.advanceTimersByTime (node_modules/@jest/fake-timers/build/modernFakeTimers.js:94:19)
2025-02-27T19:42:02.0976672Z       at Object.<anonymous> (src/components/__tests__/OfflineProgressModal.test.tsx:83:10)
2025-02-27T19:42:02.0977243Z 
2025-02-27T19:42:02.6707557Z PASS src/components/ui/__tests__/Dropdown.test.tsx
2025-02-27T19:42:02.6717465Z   ● Console
2025-02-27T19:42:02.6720980Z 
2025-02-27T19:42:02.6724363Z     console.log
2025-02-27T19:42:02.6728241Z       Dropdown styles: {
2025-02-27T19:42:02.6732011Z         backgroundColor: 'rgb(25, 25, 25)',
2025-02-27T19:42:02.6735735Z         border: '1px solid #333',
2025-02-27T19:42:02.6739530Z         padding: '8px'
2025-02-27T19:42:02.6743106Z       }
2025-02-27T19:42:02.6747150Z 
2025-02-27T19:42:02.6750860Z       at Object.<anonymous> (src/components/ui/__tests__/Dropdown.test.tsx:70:15)
2025-02-27T19:42:02.6754679Z 
2025-02-27T19:42:03.3407614Z PASS src/components/tutorial/__tests__/TutorialModal.test.tsx
2025-02-27T19:42:03.5639886Z PASS src/components/ui/__tests__/Modal.test.tsx
2025-02-27T19:42:03.9417588Z PASS src/state/resourcesSlice.test.ts
2025-02-27T19:42:04.1182980Z PASS src/components/resources/__tests__/PassiveUpgradePanel.test.tsx
2025-02-27T19:42:04.8744395Z PASS src/components/resources/__tests__/ResourceDisplay.test.tsx
2025-02-27T19:42:05.0394909Z PASS src/components/GameTimer.test.tsx
2025-02-27T19:42:05.2851256Z PASS src/components/ui/__tests__/Icon.test.tsx
2025-02-27T19:42:05.4307067Z PASS src/state/gameSlice.test.ts
2025-02-27T19:42:05.4319535Z   ● Console
2025-02-27T19:42:05.4323661Z 
2025-02-27T19:42:05.4327911Z     console.log
2025-02-27T19:42:05.4332470Z       gameSlice.addPlayTime: Adding 50.00s, old=100.00, new=150.00
2025-02-27T19:42:05.4352427Z 
2025-02-27T19:42:05.4353101Z       at addPlayTime (src/state/gameSlice.ts:62:17)
2025-02-27T19:42:05.4353897Z           at Array.reduce (<anonymous>)
2025-02-27T19:42:05.4354263Z 
2025-02-27T19:42:05.4354421Z     console.log
2025-02-27T19:42:05.4355014Z       gameSlice.setTotalPlayTime: Setting time from 0.00s to 500.00s
2025-02-27T19:42:05.4356177Z 
2025-02-27T19:42:05.4356506Z       at setTotalPlayTime (src/state/gameSlice.ts:70:15)
2025-02-27T19:42:05.4357113Z           at Array.reduce (<anonymous>)
2025-02-27T19:42:05.4357428Z 
2025-02-27T19:42:05.9417723Z PASS src/components/ui/__tests__/Button.test.tsx
2025-02-27T19:42:06.1124560Z PASS src/components/workers/__tests__/WorkerOverview.test.tsx
2025-02-27T19:42:06.3222856Z PASS src/components/ui/__tests__/Card.test.tsx
2025-02-27T19:42:06.5663310Z PASS src/index.integration.test.tsx
2025-02-27T19:42:06.7741664Z PASS src/utils/testHelpers.test.ts
2025-02-27T19:42:07.0225247Z PASS src/state/actions/__tests__/workerActions.test.ts
2025-02-27T19:42:07.2677435Z PASS src/structure.test.ts
2025-02-27T19:42:07.2943316Z PASS src/components/layout/__tests__/Layout.test.tsx
2025-02-27T19:42:07.3241295Z   ● Console
2025-02-27T19:42:07.3261445Z 
2025-02-27T19:42:07.3261719Z     console.error
2025-02-27T19:42:07.3262367Z       TypeError: Cannot read properties of undefined (reading 'activeEvents')
2025-02-27T19:42:07.3263348Z           at /home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:17:40
2025-02-27T19:42:07.3264596Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:42:07.3266255Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:42:07.3267647Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:42:07.3268664Z           at /home/runner/work/idle-game/idle-game/src/state/hooks.ts:21:18
2025-02-27T19:42:07.3269900Z           at recomputationWrapper (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:392:63)
2025-02-27T19:42:07.3271266Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:42:07.3272655Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:412:39)
2025-02-27T19:42:07.3274050Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:42:07.3275358Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/hooks/useSelector.ts:171:28)
2025-02-27T19:42:07.3277333Z           at memoizedSelector (/home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:46:30)
2025-02-27T19:42:07.3279347Z           at /home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:70:22
2025-02-27T19:42:07.3281538Z           at mountSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:6214:24)
2025-02-27T19:42:07.3283299Z           at Object.useSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:22810:16)
2025-02-27T19:42:07.3285231Z           at Object.<anonymous>.process.env.NODE_ENV.exports.useSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:1507:34)
2025-02-27T19:42:07.3287980Z           at Object.<anonymous>.process.env.NODE_ENV.exports.useSyncExternalStoreWithSelector (/home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:81:19)
2025-02-27T19:42:07.3290383Z           at useSelector2 (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/hooks/useSelector.ts:243:27)
2025-02-27T19:42:07.3291638Z           at useMemoSelector (/home/runner/work/idle-game/idle-game/src/state/hooks.ts:27:21)
2025-02-27T19:42:07.3292825Z           at EventPanel (/home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:28:39)
2025-02-27T19:42:07.3294406Z           at Object.react-stack-bottom-frame (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:22428:20)
2025-02-27T19:42:07.3296813Z           at renderWithHooks (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:5757:22)
2025-02-27T19:42:07.3298557Z           at updateFunctionComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:8018:19)
2025-02-27T19:42:07.3300356Z           at updateSimpleMemoComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:7869:14)
2025-02-27T19:42:07.3302149Z           at updateMemoComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:7802:13)
2025-02-27T19:42:07.3303789Z           at beginWork (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:10103:18)
2025-02-27T19:42:07.3305370Z           at runWithFiberInDEV (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:42:07.3307680Z           at performUnitOfWork (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:15052:22)
2025-02-27T19:42:07.3309364Z           at workLoopSync (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14870:41)
2025-02-27T19:42:07.3310962Z           at renderRootSync (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14850:11)
2025-02-27T19:42:07.3312601Z           at performWorkOnRoot (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14384:44)
2025-02-27T19:42:07.3314424Z           at performWorkOnRootViaSchedulerTask (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:15931:7)
2025-02-27T19:42:07.3316236Z           at flushActQueue (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:862:34)
2025-02-27T19:42:07.3317765Z           at Object.<anonymous>.process.env.NODE_ENV.exports.act (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:1151:10)
2025-02-27T19:42:07.3319186Z           at /home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/act-compat.js:47:25
2025-02-27T19:42:07.3320519Z           at renderRoot (/home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/pure.js:188:26)
2025-02-27T19:42:07.3321829Z           at render (/home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/pure.js:287:10)
2025-02-27T19:42:07.3323518Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/components/layout/__tests__/Layout.test.tsx:44:11)
2025-02-27T19:42:07.3324942Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:42:07.3326039Z           at new Promise (<anonymous>)
2025-02-27T19:42:07.3326987Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:42:07.3328277Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:42:07.3329390Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:42:07.3330464Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:42:07.3331760Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:42:07.3333184Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:42:07.3334429Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:42:07.3336618Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:42:07.3338164Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:42:07.3339267Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:42:07.3340205Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:42:07.3341160Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12) {
2025-02-27T19:42:07.3342033Z         [stack]: "TypeError: Cannot read properties of undefined (reading 'activeEvents')\n" +
2025-02-27T19:42:07.3342887Z           '    at /home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:17:40\n' +
2025-02-27T19:42:07.3343897Z           '    at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)\n' +
2025-02-27T19:42:07.3345094Z           '    at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)\n' +
2025-02-27T19:42:07.3346351Z           '    at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)\n' +
2025-02-27T19:42:07.3347166Z           '    at /home/runner/work/idle-game/idle-game/src/state/hooks.ts:21:18\n' +
2025-02-27T19:42:07.3348139Z           '    at recomputationWrapper (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:392:63)\n' +
2025-02-27T19:42:07.3349249Z           '    at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)\n' +
2025-02-27T19:42:07.3350358Z           '    at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:412:39)\n' +
2025-02-27T19:42:07.3351478Z           '    at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)\n' +
2025-02-27T19:42:07.3352635Z           '    at memoized (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/hooks/useSelector.ts:171:28)\n' +
2025-02-27T19:42:07.3373094Z           '    at memoizedSelector (/home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:46:30)\n' +
2025-02-27T19:42:07.3375179Z           '    at /home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:70:22\n' +
2025-02-27T19:42:07.3377692Z           '    at mountSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:6214:24)\n' +
2025-02-27T19:42:07.3379593Z           '    at Object.useSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:22810:16)\n' +
2025-02-27T19:42:07.3381695Z           '    at Object.<anonymous>.process.env.NODE_ENV.exports.useSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:1507:34)\n' +
2025-02-27T19:42:07.3384459Z           '    at Object.<anonymous>.process.env.NODE_ENV.exports.useSyncExternalStoreWithSelector (/home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:81:19)\n' +
2025-02-27T19:42:07.3387041Z           '    at useSelector2 (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/hooks/useSelector.ts:243:27)\n' +
2025-02-27T19:42:07.3388388Z           '    at useMemoSelector (/home/runner/work/idle-game/idle-game/src/state/hooks.ts:27:21)\n' +
2025-02-27T19:42:07.3389568Z           '    at EventPanel (/home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:28:39)\n' +
2025-02-27T19:42:07.3391558Z           '    at Object.react-stack-bottom-frame (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:22428:20)\n' +
2025-02-27T19:42:07.3393320Z           '    at renderWithHooks (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:5757:22)\n' +
2025-02-27T19:42:07.3395125Z           '    at updateFunctionComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:8018:19)\n' +
2025-02-27T19:42:07.3397082Z           '    at updateSimpleMemoComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:7869:14)\n' +
2025-02-27T19:42:07.3398719Z           '    at updateMemoComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:7802:13)\n' +
2025-02-27T19:42:07.3400247Z           '    at beginWork (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:10103:18)\n' +
2025-02-27T19:42:07.3401777Z           '    at runWithFiberInDEV (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:543:16)\n' +
2025-02-27T19:42:07.3403520Z           '    at performUnitOfWork (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:15052:22)\n' +
2025-02-27T19:42:07.3405232Z           '    at workLoopSync (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14870:41)\n' +
2025-02-27T19:42:07.3407206Z           '    at renderRootSync (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14850:11)\n' +
2025-02-27T19:42:07.3408968Z           '    at performWorkOnRoot (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14384:44)\n' +
2025-02-27T19:42:07.3410902Z           '    at performWorkOnRootViaSchedulerTask (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:15931:7)\n' +
2025-02-27T19:42:07.3412642Z           '    at flushActQueue (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:862:34)\n' +
2025-02-27T19:42:07.3414322Z           '    at Object.<anonymous>.process.env.NODE_ENV.exports.act (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:1151:10)\n' +
2025-02-27T19:42:07.3416289Z           '    at /home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/act-compat.js:47:25\n' +
2025-02-27T19:42:07.3418068Z           '    at renderRoot (/home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/pure.js:188:26)\n' +
2025-02-27T19:42:07.3419457Z           '    at render (/home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/pure.js:287:10)\n' +
2025-02-27T19:42:07.3420891Z           '    at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/components/layout/__tests__/Layout.test.tsx:44:11)\n' +
2025-02-27T19:42:07.3422326Z           '    at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)\n' +
2025-02-27T19:42:07.3423294Z           '    at new Promise (<anonymous>)\n' +
2025-02-27T19:42:07.3424282Z           '    at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)\n' +
2025-02-27T19:42:07.3425612Z           '    at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)\n' +
2025-02-27T19:42:07.3426951Z           '    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n' +
2025-02-27T19:42:07.3428054Z           '    at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)\n' +
2025-02-27T19:42:07.3429323Z           '    at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)\n' +
2025-02-27T19:42:07.3431139Z           '    at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)\n' +
2025-02-27T19:42:07.3432469Z           '    at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)\n' +
2025-02-27T19:42:07.3434214Z           '    at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n' +
2025-02-27T19:42:07.3436441Z           '    at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n' +
2025-02-27T19:42:07.3438027Z           '    at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)\n' +
2025-02-27T19:42:07.3439385Z           '    at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)\n' +
2025-02-27T19:42:07.3440676Z           '    at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)',
2025-02-27T19:42:07.3441815Z         [message]: "Cannot read properties of undefined (reading 'activeEvents')"
2025-02-27T19:42:07.3442476Z       }
2025-02-27T19:42:07.3442766Z       
2025-02-27T19:42:07.3443234Z       The above error occurred in the <EventPanel> component.
2025-02-27T19:42:07.3443745Z       
2025-02-27T19:42:07.3444557Z       React will try to recreate this component tree from scratch using the error boundary you provided, ErrorBoundary.
2025-02-27T19:42:07.3445245Z 
2025-02-27T19:42:07.3446213Z     [0m [90m 42 |[39m describe([32m'Layout Component'[39m[33m,[39m () [33m=>[39m {
2025-02-27T19:42:07.3447405Z      [90m 43 |[39m   test([32m'renders all layout components correctly'[39m[33m,[39m () [33m=>[39m {
2025-02-27T19:42:07.3448305Z     [31m[1m>[22m[39m[90m 44 |[39m     render(
2025-02-27T19:42:07.3448907Z      [90m    |[39m           [31m[1m^[22m[39m
2025-02-27T19:42:07.3449751Z      [90m 45 |[39m       [33m<[39m[33mProvider[39m store[33m=[39m{store}[33m>[39m
2025-02-27T19:42:07.3451473Z      [90m 46 |[39m         [33m<[39m[33mLayout[39m sidebarContent[33m=[39m{[33m<[39m[33mdiv[39m[33m>[39m[33mSidebar[39m [33mContent[39m[33m<[39m[33m/[39m[33mdiv[39m[33m>[39m}[33m>[39m
2025-02-27T19:42:07.3453151Z      [90m 47 |[39m           [33m<[39m[33mdiv[39m[33m>[39m[33mMain[39m [33mContent[39m[33m<[39m[33m/[39m[33mdiv[39m[33m>[39m[0m
2025-02-27T19:42:07.3454082Z 
2025-02-27T19:42:07.3454705Z       at defaultOnCaughtError (node_modules/react-dom/cjs/react-dom-client.development.js:7445:21)
2025-02-27T19:42:07.3456068Z       at logCaughtError (node_modules/react-dom/cjs/react-dom-client.development.js:7484:9)
2025-02-27T19:42:07.3457122Z       at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:42:07.3458546Z       at ErrorBoundary.inst.componentDidCatch.update.callback (node_modules/react-dom/cjs/react-dom-client.development.js:7531:11)
2025-02-27T19:42:07.3459844Z       at callCallback (node_modules/react-dom/cjs/react-dom-client.development.js:10680:16)
2025-02-27T19:42:07.3460840Z       at commitCallbacks (node_modules/react-dom/cjs/react-dom-client.development.js:10700:11)
2025-02-27T19:42:07.3461884Z       at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:42:07.3463030Z       at commitClassCallbacks (node_modules/react-dom/cjs/react-dom-client.development.js:10919:11)
2025-02-27T19:42:07.3464280Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11490:25)
2025-02-27T19:42:07.3465588Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3467105Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11529:11)
2025-02-27T19:42:07.3468777Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3470072Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11413:11)
2025-02-27T19:42:07.3471390Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3472723Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11585:11)
2025-02-27T19:42:07.3474020Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3475321Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11413:11)
2025-02-27T19:42:07.3476846Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3478165Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11495:11)
2025-02-27T19:42:07.3479358Z       at commitLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12406:7)
2025-02-27T19:42:07.3480449Z       at commitRootImpl (node_modules/react-dom/cjs/react-dom-client.development.js:15352:11)
2025-02-27T19:42:07.3481505Z       at commitRoot (node_modules/react-dom/cjs/react-dom-client.development.js:15251:11)
2025-02-27T19:42:07.3482556Z       at performWorkOnRoot (node_modules/react-dom/cjs/react-dom-client.development.js:14445:15)
2025-02-27T19:42:07.3483766Z       at performWorkOnRootViaSchedulerTask (node_modules/react-dom/cjs/react-dom-client.development.js:15931:7)
2025-02-27T19:42:07.3484884Z       at flushActQueue (node_modules/react/cjs/react.development.js:862:34)
2025-02-27T19:42:07.3486127Z       at Object.<anonymous>.process.env.NODE_ENV.exports.act (node_modules/react/cjs/react.development.js:1151:10)
2025-02-27T19:42:07.3487119Z       at node_modules/@testing-library/react/dist/act-compat.js:47:25
2025-02-27T19:42:07.3487918Z       at renderRoot (node_modules/@testing-library/react/dist/pure.js:188:26)
2025-02-27T19:42:07.3488684Z       at render (node_modules/@testing-library/react/dist/pure.js:287:10)
2025-02-27T19:42:07.3489528Z       at Object.<anonymous> (src/components/layout/__tests__/Layout.test.tsx:44:11)
2025-02-27T19:42:07.3490033Z 
2025-02-27T19:42:07.3490178Z     console.error
2025-02-27T19:42:07.3490871Z       [ERROR in UnknownComponent]: Cannot read properties of undefined (reading 'activeEvents') {
2025-02-27T19:42:07.3491652Z         component: 'UnknownComponent',
2025-02-27T19:42:07.3492504Z         componentStack: '\n' +
2025-02-27T19:42:07.3493401Z           '    at EventPanel (/home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:16:37)\n' +
2025-02-27T19:42:07.3494720Z           '    at ErrorBoundary (/home/runner/work/idle-game/idle-game/src/components/error/ErrorBoundary.tsx:36:5)\n' +
2025-02-27T19:42:07.3495660Z           '    at div (<anonymous>)\n' +
2025-02-27T19:42:07.3496798Z           '    at Layout (/home/runner/work/idle-game/idle-game/src/components/layout/Layout.tsx:16:42)\n' +
2025-02-27T19:42:07.3498079Z           '    at Provider (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/components/Provider.tsx:60:11)'
2025-02-27T19:42:07.3498956Z       }
2025-02-27T19:42:07.3499137Z 
2025-02-27T19:42:07.3500304Z     [0m [90m 135 |[39m       console[33m.[39merror([32m`[CRITICAL${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:42:07.3501933Z      [90m 136 |[39m     } [36melse[39m [36mif[39m (severity [33m===[39m [33mErrorSeverity[39m[33m.[39m[33mERROR[39m) {
2025-02-27T19:42:07.3503621Z     [31m[1m>[22m[39m[90m 137 |[39m       console[33m.[39merror([32m`[ERROR${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:42:07.3505044Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:42:07.3505566Z      [90m 138 |[39m     }
2025-02-27T19:42:07.3506220Z      [90m 139 |[39m     
2025-02-27T19:42:07.3506944Z      [90m 140 |[39m     [90m// Skip logging INFO and WARNING to console[39m[0m
2025-02-27T19:42:07.3507390Z 
2025-02-27T19:42:07.3507709Z       at ErrorLogger.logError (src/utils/errorUtils.ts:137:15)
2025-02-27T19:42:07.3508604Z       at ErrorBoundary.componentDidCatch (src/components/error/ErrorBoundary.tsx:58:31)
2025-02-27T19:42:07.3509803Z       at Object.react-stack-bottom-frame (node_modules/react-dom/cjs/react-dom-client.development.js:22481:20)
2025-02-27T19:42:07.3511329Z       at ErrorBoundary.inst.componentDidCatch.update.callback (node_modules/react-dom/cjs/react-dom-client.development.js:7542:11)
2025-02-27T19:42:07.3512717Z       at callCallback (node_modules/react-dom/cjs/react-dom-client.development.js:10680:16)
2025-02-27T19:42:07.3513824Z       at commitCallbacks (node_modules/react-dom/cjs/react-dom-client.development.js:10700:11)
2025-02-27T19:42:07.3514949Z       at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:42:07.3516305Z       at commitClassCallbacks (node_modules/react-dom/cjs/react-dom-client.development.js:10919:11)
2025-02-27T19:42:07.3517445Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11490:25)
2025-02-27T19:42:07.3518741Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3520030Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11529:11)
2025-02-27T19:42:07.3521356Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3522682Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11413:11)
2025-02-27T19:42:07.3523987Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3525299Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11585:11)
2025-02-27T19:42:07.3526941Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3528247Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11413:11)
2025-02-27T19:42:07.3529567Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:42:07.3531227Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11495:11)
2025-02-27T19:42:07.3532425Z       at commitLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12406:7)
2025-02-27T19:42:07.3533531Z       at commitRootImpl (node_modules/react-dom/cjs/react-dom-client.development.js:15352:11)
2025-02-27T19:42:07.3534566Z       at commitRoot (node_modules/react-dom/cjs/react-dom-client.development.js:15251:11)
2025-02-27T19:42:07.3535638Z       at performWorkOnRoot (node_modules/react-dom/cjs/react-dom-client.development.js:14445:15)
2025-02-27T19:42:07.3537094Z       at performWorkOnRootViaSchedulerTask (node_modules/react-dom/cjs/react-dom-client.development.js:15931:7)
2025-02-27T19:42:07.3538195Z       at flushActQueue (node_modules/react/cjs/react.development.js:862:34)
2025-02-27T19:42:07.3539229Z       at Object.<anonymous>.process.env.NODE_ENV.exports.act (node_modules/react/cjs/react.development.js:1151:10)
2025-02-27T19:42:07.3540274Z       at node_modules/@testing-library/react/dist/act-compat.js:47:25
2025-02-27T19:42:07.3541083Z       at renderRoot (node_modules/@testing-library/react/dist/pure.js:188:26)
2025-02-27T19:42:07.3541901Z       at render (node_modules/@testing-library/react/dist/pure.js:287:10)
2025-02-27T19:42:07.3543199Z       at Object.<anonymous> (src/components/layout/__tests__/Layout.test.tsx:44:11)
2025-02-27T19:42:07.3543708Z 
2025-02-27T19:42:07.4407222Z PASS src/config.test.ts
2025-02-27T19:42:07.7187226Z PASS src/managers/GameLoopManager.test.ts
2025-02-27T19:42:07.7233493Z   ● Console
2025-02-27T19:42:07.7236602Z 
2025-02-27T19:42:07.7238486Z     console.log
2025-02-27T19:42:07.7240519Z       GameLoopManager: Registered tick handler, total handlers: 1
2025-02-27T19:42:07.7242657Z 
2025-02-27T19:42:07.7245015Z       at GameLoopManager.registerTickHandler (src/managers/GameLoopManager.ts:39:17)
2025-02-27T19:42:07.7247418Z 
2025-02-27T19:42:07.7538663Z PASS src/index.test.ts
2025-02-27T19:42:07.7947262Z PASS src/styles/index.test.ts
2025-02-27T19:42:08.2848275Z PASS src/utils/EventEmitter.test.ts
2025-02-27T19:42:08.2947442Z PASS src/test-semantic-release.test.ts
2025-02-27T19:42:08.5703147Z PASS src/hello-world.test.ts
2025-02-27T19:42:08.7676168Z 
2025-02-27T19:42:08.7678134Z Summary of all failing tests
2025-02-27T19:42:08.7682856Z FAIL src/managers/progression/ProgressionManager.test.ts (9.382 s)
2025-02-27T19:42:08.7686942Z   ● ProgressionManager › checkRequirements › should return true when all requirements are met
2025-02-27T19:42:08.7687357Z 
2025-02-27T19:42:08.7689265Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.7689648Z 
2025-02-27T19:42:08.7689844Z     Expected: true
2025-02-27T19:42:08.7690924Z     Received: false
2025-02-27T19:42:08.7691124Z 
2025-02-27T19:42:08.7700770Z     [0m [90m 49 |[39m       ][33m;[39m
2025-02-27T19:42:08.7701994Z      [90m 50 |[39m
2025-02-27T19:42:08.7710089Z     [31m[1m>[22m[39m[90m 51 |[39m       expect(manager[33m.[39mcheckRequirements(requirements))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.7714664Z      [90m    |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:42:08.7720621Z      [90m 52 |[39m       expect(mockEvaluate)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)[33m;[39m
2025-02-27T19:42:08.7722238Z      [90m 53 |[39m     })[33m;[39m
2025-02-27T19:42:08.7723312Z      [90m 54 |[39m[0m
2025-02-27T19:42:08.7723527Z 
2025-02-27T19:42:08.7728027Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:51:55)
2025-02-27T19:42:08.7728651Z 
2025-02-27T19:42:08.7731096Z   ● ProgressionManager › checkRequirements › should return false if any requirement is not met
2025-02-27T19:42:08.7731757Z 
2025-02-27T19:42:08.7732429Z     expect(jest.fn()).toHaveBeenCalledTimes(expected)
2025-02-27T19:42:08.7732836Z 
2025-02-27T19:42:08.7733524Z     Expected number of calls: 2
2025-02-27T19:42:08.7734687Z     Received number of calls: 0
2025-02-27T19:42:08.7734970Z 
2025-02-27T19:42:08.7735781Z     [0m [90m 76 |[39m
2025-02-27T19:42:08.7740626Z      [90m 77 |[39m       expect(manager[33m.[39mcheckRequirements(requirements))[33m.[39mtoBe([36mfalse[39m)[33m;[39m
2025-02-27T19:42:08.7744026Z     [31m[1m>[22m[39m[90m 78 |[39m       expect(mockEvaluate)[33m.[39mtoHaveBeenCalledTimes([35m2[39m)[33m;[39m
2025-02-27T19:42:08.7745748Z      [90m    |[39m                            [31m[1m^[22m[39m
2025-02-27T19:42:08.7747152Z      [90m 79 |[39m     })[33m;[39m
2025-02-27T19:42:08.7748058Z      [90m 80 |[39m
2025-02-27T19:42:08.7752279Z      [90m 81 |[39m     it([32m'should handle empty requirements array'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:42:08.7752869Z 
2025-02-27T19:42:08.7755190Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:78:28)
2025-02-27T19:42:08.7755809Z 
2025-02-27T19:42:08.7759123Z   ● ProgressionManager › evaluateRequirement › should correctly evaluate gameStage requirement
2025-02-27T19:42:08.7759800Z 
2025-02-27T19:42:08.7761393Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.7761797Z 
2025-02-27T19:42:08.7761940Z     Expected: true
2025-02-27T19:42:08.7762530Z     Received: false
2025-02-27T19:42:08.7762734Z 
2025-02-27T19:42:08.7763832Z     [0m [90m 116 |[39m
2025-02-27T19:42:08.7767096Z      [90m 117 |[39m       [90m// Use the private method for testing[39m
2025-02-27T19:42:08.7772862Z     [31m[1m>[22m[39m[90m 118 |[39m       expect((manager [36mas[39m any)[33m.[39mevaluateRequirement(requirement))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.7776523Z      [90m     |[39m                                                                 [31m[1m^[22m[39m
2025-02-27T19:42:08.7777644Z      [90m 119 |[39m     })[33m;[39m
2025-02-27T19:42:08.7778530Z      [90m 120 |[39m
2025-02-27T19:42:08.7790109Z      [90m 121 |[39m     it([32m'should handle unknown requirement types'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:42:08.7790744Z 
2025-02-27T19:42:08.7793072Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:118:65)
2025-02-27T19:42:08.7793674Z 
2025-02-27T19:42:08.7797805Z   ● ProgressionManager › completeMilestone › should complete a milestone when requirements are met
2025-02-27T19:42:08.7798625Z 
2025-02-27T19:42:08.7800257Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.7800675Z 
2025-02-27T19:42:08.7800827Z     Expected: true
2025-02-27T19:42:08.7804286Z     Received: false
2025-02-27T19:42:08.7805287Z 
2025-02-27T19:42:08.7805812Z     [0m [90m 143 |[39m
2025-02-27T19:42:08.7806813Z      [90m 144 |[39m       [90m// Complete the milestone[39m
2025-02-27T19:42:08.7814825Z     [31m[1m>[22m[39m[90m 145 |[39m       expect(manager[33m.[39mcompleteMilestone([32m'milestone1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.7827597Z      [90m     |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:42:08.7830808Z      [90m 146 |[39m       expect(completeMilestone)[33m.[39mtoHaveBeenCalledWith({
2025-02-27T19:42:08.7833065Z      [90m 147 |[39m         id[33m:[39m [32m'milestone1'[39m[33m,[39m
2025-02-27T19:42:08.7847335Z      [90m 148 |[39m         completedAt[33m:[39m [35m1000[39m[0m
2025-02-27T19:42:08.7849215Z 
2025-02-27T19:42:08.7851221Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:145:55)
2025-02-27T19:42:08.7853673Z 
2025-02-27T19:42:08.7854506Z   ● ProgressionManager › completeMilestone › should not complete a milestone that is already completed
2025-02-27T19:42:08.7855198Z 
2025-02-27T19:42:08.7855513Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.7856077Z 
2025-02-27T19:42:08.7856223Z     Expected: true
2025-02-27T19:42:08.7856566Z     Received: false
2025-02-27T19:42:08.7856776Z 
2025-02-27T19:42:08.7857708Z     [0m [90m 163 |[39m       [90m// Attempt to complete the milestone[39m
2025-02-27T19:42:08.7858802Z      [90m 164 |[39m       [90m// The implementation now returns true regardless of completion status[39m
2025-02-27T19:42:08.7860327Z     [31m[1m>[22m[39m[90m 165 |[39m       expect(manager[33m.[39mcompleteMilestone([32m'milestone1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.7864795Z      [90m     |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:42:08.7872661Z      [90m 166 |[39m       [90m// The implementation now calls completeMilestone even for already completed milestones[39m
2025-02-27T19:42:08.7873935Z      [90m 167 |[39m       expect(completeMilestone)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:42:08.7874724Z      [90m 168 |[39m     })[33m;[39m[0m
2025-02-27T19:42:08.7875026Z 
2025-02-27T19:42:08.7875521Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:165:55)
2025-02-27T19:42:08.7876281Z 
2025-02-27T19:42:08.7877928Z   ● ProgressionManager › unlockAchievement › should unlock an achievement when requirements are met
2025-02-27T19:42:08.7878612Z 
2025-02-27T19:42:08.7880991Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.7881861Z 
2025-02-27T19:42:08.7882212Z     Expected: true
2025-02-27T19:42:08.7882864Z     Received: false
2025-02-27T19:42:08.7883083Z 
2025-02-27T19:42:08.7883462Z     [0m [90m 184 |[39m
2025-02-27T19:42:08.7884187Z      [90m 185 |[39m       [90m// Unlock the achievement[39m
2025-02-27T19:42:08.7888464Z     [31m[1m>[22m[39m[90m 186 |[39m       expect(manager[33m.[39munlockAchievement([32m'achievement1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.7889712Z      [90m     |[39m                                                         [31m[1m^[22m[39m
2025-02-27T19:42:08.7890757Z      [90m 187 |[39m       expect(unlockAchievement)[33m.[39mtoHaveBeenCalledWith({
2025-02-27T19:42:08.7896964Z      [90m 188 |[39m         id[33m:[39m [32m'achievement1'[39m[33m,[39m
2025-02-27T19:42:08.7899101Z      [90m 189 |[39m         unlockedAt[33m:[39m [35m1000[39m[0m
2025-02-27T19:42:08.7899484Z 
2025-02-27T19:42:08.7900827Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:186:57)
2025-02-27T19:42:08.7901422Z 
2025-02-27T19:42:08.7903853Z   ● ProgressionManager › unlockAchievement › should not unlock an achievement that is already unlocked
2025-02-27T19:42:08.7904526Z 
2025-02-27T19:42:08.7904822Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.7905195Z 
2025-02-27T19:42:08.7905339Z     Expected: true
2025-02-27T19:42:08.7905673Z     Received: false
2025-02-27T19:42:08.7906028Z 
2025-02-27T19:42:08.7907076Z     [0m [90m 204 |[39m       [90m// Attempt to unlock the achievement[39m
2025-02-27T19:42:08.7909605Z      [90m 205 |[39m       [90m// The implementation now returns true regardless of unlock status[39m
2025-02-27T19:42:08.7929243Z     [31m[1m>[22m[39m[90m 206 |[39m       expect(manager[33m.[39munlockAchievement([32m'achievement1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.7930484Z      [90m     |[39m                                                         [31m[1m^[22m[39m
2025-02-27T19:42:08.7933182Z      [90m 207 |[39m       [90m// The implementation now calls unlockAchievement even for already unlocked achievements[39m
2025-02-27T19:42:08.7934473Z      [90m 208 |[39m       expect(unlockAchievement)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:42:08.7935249Z      [90m 209 |[39m     })[33m;[39m[0m
2025-02-27T19:42:08.7935549Z 
2025-02-27T19:42:08.7937052Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:206:57)
2025-02-27T19:42:08.7937651Z 
2025-02-27T19:42:08.7939677Z   ● ProgressionManager › shouldFeatureBeUnlocked › should return true if a completed milestone unlocks the feature
2025-02-27T19:42:08.7940763Z 
2025-02-27T19:42:08.7941070Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.7941461Z 
2025-02-27T19:42:08.7941599Z     Expected: true
2025-02-27T19:42:08.7941939Z     Received: false
2025-02-27T19:42:08.7942136Z 
2025-02-27T19:42:08.7942407Z     [0m [90m 288 |[39m       
2025-02-27T19:42:08.7943132Z      [90m 289 |[39m       [90m// Check if feature should be unlocked[39m
2025-02-27T19:42:08.7946919Z     [31m[1m>[22m[39m[90m 290 |[39m       expect(manager[33m.[39mshouldFeatureBeUnlocked([32m'feature1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.7948161Z      [90m     |[39m                                                           [31m[1m^[22m[39m
2025-02-27T19:42:08.7948780Z      [90m 291 |[39m     })[33m;[39m
2025-02-27T19:42:08.7949241Z      [90m 292 |[39m
2025-02-27T19:42:08.7951907Z      [90m 293 |[39m     it([32m'should return false if no completed milestone unlocks the feature'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:42:08.7952480Z 
2025-02-27T19:42:08.7953076Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:290:59)
2025-02-27T19:42:08.7953513Z 
2025-02-27T19:42:08.7954066Z FAIL src/systems/resourceManager.test.ts (9.329 s)
2025-02-27T19:42:08.7956284Z   ● ResourceManager › initializeResources › dispatches addResource action for each initial resource
2025-02-27T19:42:08.7957448Z 
2025-02-27T19:42:08.7957782Z     TypeError: this.actions.addResource is not a function
2025-02-27T19:42:08.7958189Z 
2025-02-27T19:42:08.7960863Z     [0m [90m 153 |[39m     [33mObject[39m[33m.[39mvalues([33mINITIAL_RESOURCES[39m)[33m.[39mforEach(resource [33m=>[39m {
2025-02-27T19:42:08.7966089Z      [90m 154 |[39m       [36mif[39m (validateObject(resource[33m,[39m [[32m'id'[39m[33m,[39m [32m'name'[39m[33m,[39m [32m'amount'[39m[33m,[39m [32m'perSecond'[39m[33m,[39m [32m'unlocked'[39m][33m,[39m [32m'initializeResources'[39m)) {
2025-02-27T19:42:08.7968138Z     [31m[1m>[22m[39m[90m 155 |[39m         [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddResource(resource))[33m;[39m
2025-02-27T19:42:08.7969289Z      [90m     |[39m                                    [31m[1m^[22m[39m
2025-02-27T19:42:08.7969855Z      [90m 156 |[39m       }
2025-02-27T19:42:08.7970376Z      [90m 157 |[39m     })[33m;[39m
2025-02-27T19:42:08.7971035Z      [90m 158 |[39m   }[0m
2025-02-27T19:42:08.7971310Z 
2025-02-27T19:42:08.7971988Z       at src/systems/resourceManager.ts:155:36
2025-02-27T19:42:08.7973063Z           at Array.forEach (<anonymous>)
2025-02-27T19:42:08.7975340Z       at ResourceManager.initializeResources (src/systems/resourceManager.ts:153:38)
2025-02-27T19:42:08.7977022Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:54:23)
2025-02-27T19:42:08.7977623Z 
2025-02-27T19:42:08.7979562Z   ● ResourceManager › updateResources › updates resource amounts based on perSecond rates and elapsed time
2025-02-27T19:42:08.7980368Z 
2025-02-27T19:42:08.7980857Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:42:08.7981302Z 
2025-02-27T19:42:08.7981574Z     [0m [90m 178 |[39m     
2025-02-27T19:42:08.7983466Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:42:08.7990337Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:42:08.7992006Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:42:08.7992555Z      [90m 181 |[39m     
2025-02-27T19:42:08.7993108Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:42:08.7993975Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:42:08.7994521Z 
2025-02-27T19:42:08.7995777Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:42:08.7997863Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:105:23)
2025-02-27T19:42:08.7998292Z 
2025-02-27T19:42:08.8000383Z   ● ResourceManager › calculateResourceGeneration › calculates and updates resource generation rates based on structures
2025-02-27T19:42:08.8001279Z 
2025-02-27T19:42:08.8001593Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:42:08.8002196Z         at Function.values (<anonymous>)
2025-02-27T19:42:08.8002494Z 
2025-02-27T19:42:08.8002760Z     [0m [90m 251 |[39m     
2025-02-27T19:42:08.8004089Z      [90m 252 |[39m     [90m// Add production from all structures[39m
2025-02-27T19:42:08.8008094Z     [31m[1m>[22m[39m[90m 253 |[39m     [33mObject[39m[33m.[39mvalues(structures)[33m.[39mforEach((structure[33m:[39m unknown) [33m=>[39m {
2025-02-27T19:42:08.8009144Z      [90m     |[39m            [31m[1m^[22m[39m
2025-02-27T19:42:08.8011052Z      [90m 254 |[39m       [90m// Skip structures that aren't built or don't have workers assigned[39m
2025-02-27T19:42:08.8014466Z      [90m 255 |[39m       [36mif[39m ([33m![39mstructure [33m||[39m [36mtypeof[39m structure [33m!==[39m [32m'object'[39m [33m||[39m
2025-02-27T19:42:08.8018334Z      [90m 256 |[39m           [33m![39m([32m'unlocked'[39m [36min[39m structure) [33m||[39m [33m![39m([32m'level'[39m [36min[39m structure) [33m||[39m[0m
2025-02-27T19:42:08.8019042Z 
2025-02-27T19:42:08.8019665Z       at ResourceManager.calculateResourceGeneration (src/systems/resourceManager.ts:253:12)
2025-02-27T19:42:08.8021135Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:197:23)
2025-02-27T19:42:08.8021626Z 
2025-02-27T19:42:08.8023182Z   ● ResourceManager › canAfford › returns true when all resources are available and sufficient
2025-02-27T19:42:08.8023547Z 
2025-02-27T19:42:08.8024412Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:42:08.8024918Z 
2025-02-27T19:42:08.8029012Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:42:08.8031382Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:42:08.8034288Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:42:08.8035716Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:42:08.8041081Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:42:08.8042225Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:42:08.8042807Z      [90m 346 |[39m       }[0m
2025-02-27T19:42:08.8043066Z 
2025-02-27T19:42:08.8048346Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:42:08.8050067Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:256:38)
2025-02-27T19:42:08.8050494Z 
2025-02-27T19:42:08.8052349Z   ● ResourceManager › canAfford › returns false when any resource is insufficient
2025-02-27T19:42:08.8052810Z 
2025-02-27T19:42:08.8053935Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:42:08.8054425Z 
2025-02-27T19:42:08.8058279Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:42:08.8060589Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:42:08.8063404Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:42:08.8064802Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:42:08.8069893Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:42:08.8070944Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:42:08.8071789Z      [90m 346 |[39m       }[0m
2025-02-27T19:42:08.8072041Z 
2025-02-27T19:42:08.8073729Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:42:08.8075165Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:297:38)
2025-02-27T19:42:08.8075581Z 
2025-02-27T19:42:08.8077705Z   ● ResourceManager › canAfford › returns false when any resource is not unlocked
2025-02-27T19:42:08.8078192Z 
2025-02-27T19:42:08.8079220Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:42:08.8079697Z 
2025-02-27T19:42:08.8083343Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:42:08.8085684Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:42:08.8088618Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:42:08.8089922Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:42:08.8094864Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:42:08.8096057Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:42:08.8096797Z      [90m 346 |[39m       }[0m
2025-02-27T19:42:08.8097062Z 
2025-02-27T19:42:08.8098700Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:42:08.8100649Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:338:38)
2025-02-27T19:42:08.8101080Z 
2025-02-27T19:42:08.8102676Z   ● ResourceManager › canAfford › returns false when any resource is missing
2025-02-27T19:42:08.8103141Z 
2025-02-27T19:42:08.8104296Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:42:08.8104798Z 
2025-02-27T19:42:08.8108523Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:42:08.8110759Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:42:08.8113574Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:42:08.8114954Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:42:08.8120068Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:42:08.8121176Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:42:08.8121832Z      [90m 346 |[39m       }[0m
2025-02-27T19:42:08.8122106Z 
2025-02-27T19:42:08.8123848Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:42:08.8125652Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:369:38)
2025-02-27T19:42:08.8126331Z 
2025-02-27T19:42:08.8128851Z   ● ResourceManager › applyResourceCost › dispatches addResourceAmount with negative values for each cost
2025-02-27T19:42:08.8129460Z 
2025-02-27T19:42:08.8130255Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:42:08.8130750Z 
2025-02-27T19:42:08.8134403Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:42:08.8136860Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:42:08.8139727Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:42:08.8141036Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:42:08.8146153Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:42:08.8148020Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:42:08.8148635Z      [90m 346 |[39m       }[0m
2025-02-27T19:42:08.8148897Z 
2025-02-27T19:42:08.8149297Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:42:08.8150262Z       at ResourceManager.applyResourceCost (src/systems/resourceManager.ts:363:15)
2025-02-27T19:42:08.8151136Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:415:38)
2025-02-27T19:42:08.8151397Z 
2025-02-27T19:42:08.8153154Z   ● ResourceManager › unlockResource › unlocks a locked resource and returns true
2025-02-27T19:42:08.8153689Z 
2025-02-27T19:42:08.8154319Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:42:08.8154789Z 
2025-02-27T19:42:08.8156173Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:42:08.8158791Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8161573Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:42:08.8162676Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:42:08.8163200Z      [90m 386 |[39m     
2025-02-27T19:42:08.8165725Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:42:08.8168049Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:42:08.8168563Z 
2025-02-27T19:42:08.8169345Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:42:08.8170759Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:462:38)
2025-02-27T19:42:08.8171193Z 
2025-02-27T19:42:08.8172769Z   ● ResourceManager › unlockResource › returns false for already unlocked resources
2025-02-27T19:42:08.8173292Z 
2025-02-27T19:42:08.8174155Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:42:08.8174617Z 
2025-02-27T19:42:08.8176644Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:42:08.8178976Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8181815Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:42:08.8182959Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:42:08.8183486Z      [90m 386 |[39m     
2025-02-27T19:42:08.8186201Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:42:08.8188538Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:42:08.8188994Z 
2025-02-27T19:42:08.8189663Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:42:08.8191232Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:499:38)
2025-02-27T19:42:08.8191660Z 
2025-02-27T19:42:08.8193125Z   ● ResourceManager › unlockResource › returns false for non-existent resources
2025-02-27T19:42:08.8193820Z 
2025-02-27T19:42:08.8194653Z     TypeError: Cannot read properties of undefined (reading 'non-existent')
2025-02-27T19:42:08.8195152Z 
2025-02-27T19:42:08.8197109Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:42:08.8199443Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8202419Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:42:08.8203621Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:42:08.8204262Z      [90m 386 |[39m     
2025-02-27T19:42:08.8207051Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:42:08.8209487Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:42:08.8209948Z 
2025-02-27T19:42:08.8210794Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:42:08.8212244Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:527:38)
2025-02-27T19:42:08.8212677Z 
2025-02-27T19:42:08.8215327Z   ● ResourceManager › addResourceAmount and setResourceAmount › addResourceAmount adds to existing resource
2025-02-27T19:42:08.8216192Z 
2025-02-27T19:42:08.8216756Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:42:08.8217254Z 
2025-02-27T19:42:08.8220014Z     [0m [90m 407 |[39m   addResourceAmount(resourceId[33m:[39m string[33m,[39m amount[33m:[39m number)[33m:[39m boolean {
2025-02-27T19:42:08.8222084Z      [90m 408 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8225116Z     [31m[1m>[22m[39m[90m 409 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:42:08.8226570Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:42:08.8227523Z      [90m 410 |[39m     
2025-02-27T19:42:08.8229185Z      [90m 411 |[39m     [90m// Can't add to a resource that doesn't exist[39m
2025-02-27T19:42:08.8231575Z      [90m 412 |[39m     [36mif[39m ([33m![39mresource) {[0m
2025-02-27T19:42:08.8231970Z 
2025-02-27T19:42:08.8232425Z       at ResourceManager.addResourceAmount (src/systems/resourceManager.ts:409:37)
2025-02-27T19:42:08.8233277Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:560:38)
2025-02-27T19:42:08.8234802Z 
2025-02-27T19:42:08.8235686Z   ● ResourceManager › addResourceAmount and setResourceAmount › setResourceAmount sets absolute value for resource
2025-02-27T19:42:08.8236528Z 
2025-02-27T19:42:08.8236812Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:42:08.8237301Z 
2025-02-27T19:42:08.8238006Z     [0m [90m 431 |[39m   setResourceAmount(resourceId[33m:[39m string[33m,[39m amount[33m:[39m number)[33m:[39m boolean {
2025-02-27T19:42:08.8238743Z      [90m 432 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8240826Z     [31m[1m>[22m[39m[90m 433 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:42:08.8241874Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:42:08.8242424Z      [90m 434 |[39m     
2025-02-27T19:42:08.8243103Z      [90m 435 |[39m     [90m// Can't set a resource that doesn't exist[39m
2025-02-27T19:42:08.8243872Z      [90m 436 |[39m     [36mif[39m ([33m![39mresource) {[0m
2025-02-27T19:42:08.8244236Z 
2025-02-27T19:42:08.8244717Z       at ResourceManager.setResourceAmount (src/systems/resourceManager.ts:433:37)
2025-02-27T19:42:08.8245411Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:598:38)
2025-02-27T19:42:08.8246072Z 
2025-02-27T19:42:08.8266440Z FAIL src/systems/__tests__/workerManager.test.ts (9.394 s)
2025-02-27T19:42:08.8268082Z   ● WorkerManager › Worker counting › should get total available workers based on game stage
2025-02-27T19:42:08.8268659Z 
2025-02-27T19:42:08.8269221Z     TypeError: Cannot read properties of undefined (reading 'gameStage')
2025-02-27T19:42:08.8269702Z 
2025-02-27T19:42:08.8271557Z     [0m [90m 142 |[39m     [90m// Available workers are determined by current game stage[39m
2025-02-27T19:42:08.8272483Z      [90m 143 |[39m     [90m// 5 base workers + 3 per game stage[39m
2025-02-27T19:42:08.8276142Z     [31m[1m>[22m[39m[90m 144 |[39m     [36mreturn[39m [35m5[39m [33m+[39m (state[33m.[39mgame[33m.[39mgameStage [33m*[39m [35m3[39m)[33m;[39m
2025-02-27T19:42:08.8277263Z      [90m     |[39m                            [31m[1m^[22m[39m
2025-02-27T19:42:08.8277806Z      [90m 145 |[39m   }
2025-02-27T19:42:08.8278221Z      [90m 146 |[39m   
2025-02-27T19:42:08.8278706Z      [90m 147 |[39m   [90m/**[39m[0m
2025-02-27T19:42:08.8279001Z 
2025-02-27T19:42:08.8280724Z       at WorkerManager.getTotalAvailableWorkers (src/systems/workerManager.ts:144:28)
2025-02-27T19:42:08.8281677Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:89:28)
2025-02-27T19:42:08.8282306Z 
2025-02-27T19:42:08.8283508Z   ● WorkerManager › Worker counting › should get total assigned workers
2025-02-27T19:42:08.8283974Z 
2025-02-27T19:42:08.8284316Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:42:08.8285193Z         at Function.values (<anonymous>)
2025-02-27T19:42:08.8285485Z 
2025-02-27T19:42:08.8288754Z     [0m [90m 153 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:42:08.8289485Z      [90m 154 |[39m     
2025-02-27T19:42:08.8292559Z     [31m[1m>[22m[39m[90m 155 |[39m     [36mreturn[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mreduce(
2025-02-27T19:42:08.8293444Z      [90m     |[39m                   [31m[1m^[22m[39m
2025-02-27T19:42:08.8296195Z      [90m 156 |[39m       (total[33m:[39m number[33m,[39m structure[33m:[39m unknown) [33m=>[39m {
2025-02-27T19:42:08.8300959Z      [90m 157 |[39m         [36mif[39m (structure [33m&&[39m [36mtypeof[39m structure [33m===[39m [32m'object'[39m [33m&&[39m [32m'workers'[39m [36min[39m structure [33m&&[39m 
2025-02-27T19:42:08.8303141Z      [90m 158 |[39m             [36mtypeof[39m structure[33m.[39mworkers [33m===[39m [32m'number'[39m) {[0m
2025-02-27T19:42:08.8303654Z 
2025-02-27T19:42:08.8304647Z       at WorkerManager.getTotalAssignedWorkers (src/systems/workerManager.ts:155:19)
2025-02-27T19:42:08.8306704Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:102:28)
2025-02-27T19:42:08.8307170Z 
2025-02-27T19:42:08.8308327Z   ● WorkerManager › Worker counting › should get remaining workers correctly
2025-02-27T19:42:08.8308801Z 
2025-02-27T19:42:08.8309793Z     TypeError: Cannot read properties of undefined (reading 'gameStage')
2025-02-27T19:42:08.8310245Z 
2025-02-27T19:42:08.8312417Z     [0m [90m 142 |[39m     [90m// Available workers are determined by current game stage[39m
2025-02-27T19:42:08.8313650Z      [90m 143 |[39m     [90m// 5 base workers + 3 per game stage[39m
2025-02-27T19:42:08.8318205Z     [31m[1m>[22m[39m[90m 144 |[39m     [36mreturn[39m [35m5[39m [33m+[39m (state[33m.[39mgame[33m.[39mgameStage [33m*[39m [35m3[39m)[33m;[39m
2025-02-27T19:42:08.8319039Z      [90m     |[39m                            [31m[1m^[22m[39m
2025-02-27T19:42:08.8319551Z      [90m 145 |[39m   }
2025-02-27T19:42:08.8319928Z      [90m 146 |[39m   
2025-02-27T19:42:08.8320961Z      [90m 147 |[39m   [90m/**[39m[0m
2025-02-27T19:42:08.8321241Z 
2025-02-27T19:42:08.8323042Z       at WorkerManager.getTotalAvailableWorkers (src/systems/workerManager.ts:144:28)
2025-02-27T19:42:08.8324745Z       at WorkerManager.getRemainingWorkers (src/systems/workerManager.ts:172:17)
2025-02-27T19:42:08.8326886Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:118:28)
2025-02-27T19:42:08.8327362Z 
2025-02-27T19:42:08.8328535Z   ● WorkerManager › Worker assignment › should assign workers to buildings
2025-02-27T19:42:08.8329011Z 
2025-02-27T19:42:08.8329774Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:42:08.8330221Z 
2025-02-27T19:42:08.8330446Z     [0m [90m 190 |[39m     
2025-02-27T19:42:08.8333393Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8336505Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8337751Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8338261Z      [90m 193 |[39m     
2025-02-27T19:42:08.8339886Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.8351043Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:42:08.8351663Z 
2025-02-27T19:42:08.8352296Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:42:08.8353196Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:137:36)
2025-02-27T19:42:08.8353499Z 
2025-02-27T19:42:08.8354356Z   ● WorkerManager › Worker assignment › should limit assignment to available workers
2025-02-27T19:42:08.8354889Z 
2025-02-27T19:42:08.8355167Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:42:08.8355507Z 
2025-02-27T19:42:08.8355984Z     [0m [90m 190 |[39m     
2025-02-27T19:42:08.8356731Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8357698Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8358536Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8358876Z      [90m 193 |[39m     
2025-02-27T19:42:08.8359442Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.8360179Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:42:08.8360552Z 
2025-02-27T19:42:08.8361154Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:42:08.8362086Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:148:21)
2025-02-27T19:42:08.8362550Z 
2025-02-27T19:42:08.8363068Z   ● WorkerManager › Worker assignment › should limit assignment to maxWorkers
2025-02-27T19:42:08.8363544Z 
2025-02-27T19:42:08.8364142Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:42:08.8364593Z 
2025-02-27T19:42:08.8364834Z     [0m [90m 190 |[39m     
2025-02-27T19:42:08.8367633Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8370401Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8371501Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8372018Z      [90m 193 |[39m     
2025-02-27T19:42:08.8373283Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.8375159Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:42:08.8375549Z 
2025-02-27T19:42:08.8376821Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:42:08.8378498Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:159:21)
2025-02-27T19:42:08.8378967Z 
2025-02-27T19:42:08.8380209Z   ● WorkerManager › Worker assignment › should handle nonexistent building
2025-02-27T19:42:08.8380673Z 
2025-02-27T19:42:08.8381574Z     TypeError: Cannot read properties of undefined (reading 'nonexistent')
2025-02-27T19:42:08.8382139Z 
2025-02-27T19:42:08.8382378Z     [0m [90m 190 |[39m     
2025-02-27T19:42:08.8384696Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8387624Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8388761Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8389392Z      [90m 193 |[39m     
2025-02-27T19:42:08.8390511Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.8392421Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:42:08.8392802Z 
2025-02-27T19:42:08.8393936Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:42:08.8395509Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:169:36)
2025-02-27T19:42:08.8396117Z 
2025-02-27T19:42:08.8397248Z   ● WorkerManager › Changing worker count › should add workers by delta
2025-02-27T19:42:08.8397903Z 
2025-02-27T19:42:08.8398667Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:42:08.8399108Z 
2025-02-27T19:42:08.8399363Z     [0m [90m 234 |[39m     
2025-02-27T19:42:08.8401912Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8404686Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8406015Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8406534Z      [90m 237 |[39m     
2025-02-27T19:42:08.8407940Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.8409714Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:42:08.8410090Z 
2025-02-27T19:42:08.8411113Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:42:08.8412947Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:189:21)
2025-02-27T19:42:08.8413450Z 
2025-02-27T19:42:08.8414454Z   ● WorkerManager › Changing worker count › should remove workers by delta
2025-02-27T19:42:08.8414912Z 
2025-02-27T19:42:08.8415735Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:42:08.8416425Z 
2025-02-27T19:42:08.8416673Z     [0m [90m 234 |[39m     
2025-02-27T19:42:08.8418944Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8421855Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8422999Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8423617Z      [90m 237 |[39m     
2025-02-27T19:42:08.8424780Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.8426699Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:42:08.8427078Z 
2025-02-27T19:42:08.8428151Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:42:08.8429984Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:210:21)
2025-02-27T19:42:08.8430452Z 
2025-02-27T19:42:08.8431809Z   ● WorkerManager › Changing worker count › should limit addition by available workers
2025-02-27T19:42:08.8432259Z 
2025-02-27T19:42:08.8433135Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:42:08.8433688Z 
2025-02-27T19:42:08.8433920Z     [0m [90m 234 |[39m     
2025-02-27T19:42:08.8436353Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8439128Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8440279Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8440916Z      [90m 237 |[39m     
2025-02-27T19:42:08.8442125Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.8443954Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:42:08.8444323Z 
2025-02-27T19:42:08.8445297Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:42:08.8447312Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:231:21)
2025-02-27T19:42:08.8447779Z 
2025-02-27T19:42:08.8448934Z   ● WorkerManager › Worker efficiency › should calculate worker efficiency correctly
2025-02-27T19:42:08.8449475Z 
2025-02-27T19:42:08.8450201Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:42:08.8450659Z 
2025-02-27T19:42:08.8450889Z     [0m [90m 287 |[39m     
2025-02-27T19:42:08.8453665Z      [90m 288 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:42:08.8456711Z     [31m[1m>[22m[39m[90m 289 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8457691Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8458199Z      [90m 290 |[39m     
2025-02-27T19:42:08.8461348Z      [90m 291 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m building[33m.[39mworkers [33m===[39m [35m0[39m) {
2025-02-27T19:42:08.8462527Z      [90m 292 |[39m       [36mreturn[39m [35m0[39m[33m;[39m[0m
2025-02-27T19:42:08.8462891Z 
2025-02-27T19:42:08.8464505Z       at WorkerManager.calculateWorkerEfficiency (src/systems/workerManager.ts:289:38)
2025-02-27T19:42:08.8466148Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:246:28)
2025-02-27T19:42:08.8466611Z 
2025-02-27T19:42:08.8468398Z   ● WorkerManager › Worker efficiency › should handle nonexistent building for efficiency
2025-02-27T19:42:08.8468862Z 
2025-02-27T19:42:08.8469608Z     TypeError: Cannot read properties of undefined (reading 'nonexistent')
2025-02-27T19:42:08.8470185Z 
2025-02-27T19:42:08.8470423Z     [0m [90m 287 |[39m     
2025-02-27T19:42:08.8473056Z      [90m 288 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:42:08.8475787Z     [31m[1m>[22m[39m[90m 289 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8477239Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8477907Z      [90m 290 |[39m     
2025-02-27T19:42:08.8481127Z      [90m 291 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m building[33m.[39mworkers [33m===[39m [35m0[39m) {
2025-02-27T19:42:08.8482074Z      [90m 292 |[39m       [36mreturn[39m [35m0[39m[33m;[39m[0m
2025-02-27T19:42:08.8482428Z 
2025-02-27T19:42:08.8484279Z       at WorkerManager.calculateWorkerEfficiency (src/systems/workerManager.ts:289:38)
2025-02-27T19:42:08.8486042Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:283:28)
2025-02-27T19:42:08.8486510Z 
2025-02-27T19:42:08.8488060Z   ● WorkerManager › Auto-assignment › should auto-assign with balanced strategy
2025-02-27T19:42:08.8488561Z 
2025-02-27T19:42:08.8488960Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:42:08.8489844Z         at Function.values (<anonymous>)
2025-02-27T19:42:08.8490129Z 
2025-02-27T19:42:08.8490378Z     [0m [90m 318 |[39m     
2025-02-27T19:42:08.8493454Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:42:08.8499294Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:42:08.8500644Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:42:08.8501707Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:42:08.8504189Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:42:08.8505658Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:42:08.8506191Z 
2025-02-27T19:42:08.8507479Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:42:08.8509384Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:290:21)
2025-02-27T19:42:08.8509864Z 
2025-02-27T19:42:08.8510914Z   ● WorkerManager › Auto-assignment › should auto-assign with focused strategy
2025-02-27T19:42:08.8511391Z 
2025-02-27T19:42:08.8511965Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:42:08.8512879Z         at Function.values (<anonymous>)
2025-02-27T19:42:08.8513387Z 
2025-02-27T19:42:08.8513643Z     [0m [90m 318 |[39m     
2025-02-27T19:42:08.8516429Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:42:08.8520970Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:42:08.8522308Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:42:08.8523311Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:42:08.8525786Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:42:08.8527659Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:42:08.8528040Z 
2025-02-27T19:42:08.8529128Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:42:08.8531046Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:310:21)
2025-02-27T19:42:08.8531523Z 
2025-02-27T19:42:08.8532900Z   ● WorkerManager › Auto-assignment › should auto-assign with efficiency strategy
2025-02-27T19:42:08.8533396Z 
2025-02-27T19:42:08.8533869Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:42:08.8534710Z         at Function.values (<anonymous>)
2025-02-27T19:42:08.8535015Z 
2025-02-27T19:42:08.8535416Z     [0m [90m 318 |[39m     
2025-02-27T19:42:08.8538756Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:42:08.8544408Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:42:08.8545643Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:42:08.8547017Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:42:08.8549571Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:42:08.8551188Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:42:08.8551562Z 
2025-02-27T19:42:08.8552951Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:42:08.8554800Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:331:21)
2025-02-27T19:42:08.8555433Z 
2025-02-27T19:42:08.8556447Z FAIL src/systems/__tests__/buildingManager.test.ts
2025-02-27T19:42:08.8558607Z   ● BuildingManager › initialization › should initialize a building
2025-02-27T19:42:08.8559164Z 
2025-02-27T19:42:08.8559467Z     TypeError: this.actions.addStructure is not a function
2025-02-27T19:42:08.8559960Z 
2025-02-27T19:42:08.8560305Z     [0m [90m 139 |[39m     }
2025-02-27T19:42:08.8560734Z      [90m 140 |[39m     
2025-02-27T19:42:08.8564613Z     [31m[1m>[22m[39m[90m 141 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddStructure(building))[33m;[39m
2025-02-27T19:42:08.8565409Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:42:08.8566140Z      [90m 142 |[39m   }
2025-02-27T19:42:08.8566548Z      [90m 143 |[39m   
2025-02-27T19:42:08.8567503Z      [90m 144 |[39m   [90m/**[39m[0m
2025-02-27T19:42:08.8567784Z 
2025-02-27T19:42:08.8569884Z       at BuildingManager.initializeBuilding (src/systems/buildingManager.ts:141:32)
2025-02-27T19:42:08.8571359Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:73:23)
2025-02-27T19:42:08.8571833Z 
2025-02-27T19:42:08.8573103Z   ● BuildingManager › initialization › should initialize multiple buildings
2025-02-27T19:42:08.8573767Z 
2025-02-27T19:42:08.8574177Z     TypeError: this.actions.addStructure is not a function
2025-02-27T19:42:08.8574562Z 
2025-02-27T19:42:08.8574814Z     [0m [90m 139 |[39m     }
2025-02-27T19:42:08.8575268Z      [90m 140 |[39m     
2025-02-27T19:42:08.8579851Z     [31m[1m>[22m[39m[90m 141 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddStructure(building))[33m;[39m
2025-02-27T19:42:08.8580793Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:42:08.8581299Z      [90m 142 |[39m   }
2025-02-27T19:42:08.8581674Z      [90m 143 |[39m   
2025-02-27T19:42:08.8582712Z      [90m 144 |[39m   [90m/**[39m[0m
2025-02-27T19:42:08.8583011Z 
2025-02-27T19:42:08.8584767Z       at BuildingManager.initializeBuilding (src/systems/buildingManager.ts:141:32)
2025-02-27T19:42:08.8585622Z       at src/systems/buildingManager.ts:153:40
2025-02-27T19:42:08.8586358Z           at Array.forEach (<anonymous>)
2025-02-27T19:42:08.8588686Z       at BuildingManager.initializeBuildings (src/systems/buildingManager.ts:153:15)
2025-02-27T19:42:08.8590324Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:108:23)
2025-02-27T19:42:08.8590812Z 
2025-02-27T19:42:08.8592988Z   ● BuildingManager › purchase validation › should correctly validate if player can afford a building
2025-02-27T19:42:08.8593457Z 
2025-02-27T19:42:08.8594119Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:42:08.8594693Z 
2025-02-27T19:42:08.8594935Z     [0m [90m 165 |[39m     
2025-02-27T19:42:08.8597577Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8600493Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8601706Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8602362Z      [90m 168 |[39m     
2025-02-27T19:42:08.8604760Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:42:08.8609652Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:42:08.8610204Z 
2025-02-27T19:42:08.8617095Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:42:08.8618064Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:160:39)
2025-02-27T19:42:08.8618556Z 
2025-02-27T19:42:08.8619196Z   ● BuildingManager › purchase validation › should return false for non-existent buildings
2025-02-27T19:42:08.8620005Z 
2025-02-27T19:42:08.8620411Z     TypeError: Cannot read properties of undefined (reading 'non_existent')
2025-02-27T19:42:08.8620849Z 
2025-02-27T19:42:08.8621097Z     [0m [90m 165 |[39m     
2025-02-27T19:42:08.8621895Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8623099Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8624038Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8624544Z      [90m 168 |[39m     
2025-02-27T19:42:08.8625289Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:42:08.8627443Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:42:08.8627991Z 
2025-02-27T19:42:08.8628485Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:42:08.8629805Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:193:38)
2025-02-27T19:42:08.8630292Z 
2025-02-27T19:42:08.8631733Z   ● BuildingManager › purchase validation › should return false for locked buildings
2025-02-27T19:42:08.8632383Z 
2025-02-27T19:42:08.8633284Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:42:08.8633761Z 
2025-02-27T19:42:08.8634011Z     [0m [90m 165 |[39m     
2025-02-27T19:42:08.8636635Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8639353Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8640430Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8640965Z      [90m 168 |[39m     
2025-02-27T19:42:08.8643344Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:42:08.8646021Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:42:08.8646469Z 
2025-02-27T19:42:08.8647301Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:42:08.8649121Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:226:38)
2025-02-27T19:42:08.8649613Z 
2025-02-27T19:42:08.8650917Z   ● BuildingManager › purchasing › should purchase a building and deduct resources
2025-02-27T19:42:08.8651384Z 
2025-02-27T19:42:08.8652240Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:42:08.8652811Z 
2025-02-27T19:42:08.8653045Z     [0m [90m 197 |[39m     
2025-02-27T19:42:08.8655282Z      [90m 198 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8658234Z     [31m[1m>[22m[39m[90m 199 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8659341Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8659990Z      [90m 200 |[39m     
2025-02-27T19:42:08.8660950Z      [90m 201 |[39m     [90m// Deduct resources[39m
2025-02-27T19:42:08.8665003Z      [90m 202 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mdeductResources(building[33m.[39mcost))[33m;[39m[0m
2025-02-27T19:42:08.8665587Z 
2025-02-27T19:42:08.8666193Z       at BuildingManager.purchaseBuilding (src/systems/buildingManager.ts:199:38)
2025-02-27T19:42:08.8667735Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:273:38)
2025-02-27T19:42:08.8668217Z 
2025-02-27T19:42:08.8670882Z   ● BuildingManager › production calculation › should correctly calculate production based on level and workers
2025-02-27T19:42:08.8671836Z 
2025-02-27T19:42:08.8672259Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:42:08.8672741Z 
2025-02-27T19:42:08.8672975Z     [0m [90m 222 |[39m     
2025-02-27T19:42:08.8674614Z      [90m 223 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.8677838Z     [31m[1m>[22m[39m[90m 224 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.8678982Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8679493Z      [90m 225 |[39m     
2025-02-27T19:42:08.8680882Z      [90m 226 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.8681964Z      [90m 227 |[39m       [36mreturn[39m[33m;[39m[0m
2025-02-27T19:42:08.8682281Z 
2025-02-27T19:42:08.8684001Z       at BuildingManager.recalculateProduction (src/systems/buildingManager.ts:224:38)
2025-02-27T19:42:08.8685432Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:329:23)
2025-02-27T19:42:08.8686067Z 
2025-02-27T19:42:08.8686974Z FAIL src/systems/__tests__/saveManager.test.ts
2025-02-27T19:42:08.8688866Z   ● SaveManager › loadGame › should dispatch actions to restore game state
2025-02-27T19:42:08.8689595Z 
2025-02-27T19:42:08.8689883Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.8690260Z 
2025-02-27T19:42:08.8690389Z     Expected: true
2025-02-27T19:42:08.8690696Z     Received: false
2025-02-27T19:42:08.8690881Z 
2025-02-27T19:42:08.8691128Z     [0m [90m 178 |[39m       
2025-02-27T19:42:08.8692174Z      [90m 179 |[39m       [90m// Assert[39m
2025-02-27T19:42:08.8694712Z     [31m[1m>[22m[39m[90m 180 |[39m       expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.8695670Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8696332Z      [90m 181 |[39m       
2025-02-27T19:42:08.8698261Z      [90m 182 |[39m       [90m// Verify reset actions were dispatched[39m
2025-02-27T19:42:08.8700981Z      [90m 183 |[39m       expect(mockDispatch)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[0m
2025-02-27T19:42:08.8701441Z 
2025-02-27T19:42:08.8702089Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:180:22)
2025-02-27T19:42:08.8702542Z 
2025-02-27T19:42:08.8703972Z   ● SaveManager › resetGame › should dispatch reset actions for all state slices
2025-02-27T19:42:08.8704469Z 
2025-02-27T19:42:08.8704744Z     TypeError: this.actions.resetGame is not a function
2025-02-27T19:42:08.8705142Z 
2025-02-27T19:42:08.8706957Z     [0m [90m 217 |[39m     [36mthis[39m[33m.[39mensureInitialized()[33m;[39m
2025-02-27T19:42:08.8707557Z      [90m 218 |[39m     
2025-02-27T19:42:08.8710894Z     [31m[1m>[22m[39m[90m 219 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetGame())[33m;[39m
2025-02-27T19:42:08.8711712Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:42:08.8714992Z      [90m 220 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetResources())[33m;[39m
2025-02-27T19:42:08.8717843Z      [90m 221 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetStructures())[33m;[39m
2025-02-27T19:42:08.8718541Z      [90m 222 |[39m   }[0m
2025-02-27T19:42:08.8718695Z 
2025-02-27T19:42:08.8719284Z       at SaveManager.resetGame (src/systems/saveManager.ts:219:32)
2025-02-27T19:42:08.8721140Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:243:19)
2025-02-27T19:42:08.8721600Z 
2025-02-27T19:42:08.8722790Z   ● SaveManager › deleteSaveAndReset › should delete the save and reset the game
2025-02-27T19:42:08.8723243Z 
2025-02-27T19:42:08.8723786Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.8724340Z 
2025-02-27T19:42:08.8724474Z     Expected: true
2025-02-27T19:42:08.8724778Z     Received: false
2025-02-27T19:42:08.8724963Z 
2025-02-27T19:42:08.8725203Z     [0m [90m 265 |[39m       
2025-02-27T19:42:08.8726499Z      [90m 266 |[39m       [90m// Assert[39m
2025-02-27T19:42:08.8729020Z     [31m[1m>[22m[39m[90m 267 |[39m       expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.8729926Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8732592Z      [90m 268 |[39m       expect(saveUtils[33m.[39mdeleteSave)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:42:08.8735065Z      [90m 269 |[39m       expect(mockDispatch)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({
2025-02-27T19:42:08.8737437Z      [90m 270 |[39m         type[33m:[39m expect[33m.[39mstringContaining([32m'game/resetGame'[39m)[0m
2025-02-27T19:42:08.8737877Z 
2025-02-27T19:42:08.8738635Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:267:22)
2025-02-27T19:42:08.8739099Z 
2025-02-27T19:42:08.8739819Z FAIL src/integration/tasks.integration.test.ts
2025-02-27T19:42:08.8741778Z   ● Task System Integration › should start a task when requirements are met
2025-02-27T19:42:08.8742231Z 
2025-02-27T19:42:08.8742521Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.8743084Z 
2025-02-27T19:42:08.8743213Z     Expected: true
2025-02-27T19:42:08.8743520Z     Received: false
2025-02-27T19:42:08.8743712Z 
2025-02-27T19:42:08.8746952Z     [0m [90m 151 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mstartTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:42:08.8747586Z      [90m 152 |[39m     
2025-02-27T19:42:08.8749321Z     [31m[1m>[22m[39m[90m 153 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.8750245Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:42:08.8752410Z      [90m 154 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:42:08.8753415Z      [90m 155 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:42:08.8755441Z      [90m 156 |[39m         type[33m:[39m [32m'tasks/startTask'[39m[33m,[39m[0m
2025-02-27T19:42:08.8755984Z 
2025-02-27T19:42:08.8756967Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:153:20)
2025-02-27T19:42:08.8758034Z 
2025-02-27T19:42:08.8758517Z   ● Task System Integration › should check if task requirements are met
2025-02-27T19:42:08.8758961Z 
2025-02-27T19:42:08.8759509Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.8759868Z 
2025-02-27T19:42:08.8759996Z     Expected: true
2025-02-27T19:42:08.8760301Z     Received: false
2025-02-27T19:42:08.8760485Z 
2025-02-27T19:42:08.8763738Z     [0m [90m 188 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39munlockTask([32m'locked-task'[39m)[33m;[39m
2025-02-27T19:42:08.8764388Z      [90m 189 |[39m     
2025-02-27T19:42:08.8766211Z     [31m[1m>[22m[39m[90m 190 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.8767109Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:42:08.8769308Z      [90m 191 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:42:08.8770332Z      [90m 192 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:42:08.8772366Z      [90m 193 |[39m         type[33m:[39m [32m'tasks/unlockTask'[39m[33m,[39m[0m
2025-02-27T19:42:08.8772783Z 
2025-02-27T19:42:08.8773745Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:190:20)
2025-02-27T19:42:08.8774207Z 
2025-02-27T19:42:08.8775170Z   ● Task System Integration › should complete an in-progress task
2025-02-27T19:42:08.8775571Z 
2025-02-27T19:42:08.8776309Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.8776663Z 
2025-02-27T19:42:08.8777044Z     Expected: true
2025-02-27T19:42:08.8777355Z     Received: false
2025-02-27T19:42:08.8777539Z 
2025-02-27T19:42:08.8780596Z     [0m [90m 214 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mcompleteTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:42:08.8781226Z      [90m 215 |[39m     
2025-02-27T19:42:08.8782934Z     [31m[1m>[22m[39m[90m 216 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.8783779Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:42:08.8786115Z      [90m 217 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:42:08.8787160Z      [90m 218 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:42:08.8789297Z      [90m 219 |[39m         type[33m:[39m [32m'tasks/completeTask'[39m[33m,[39m[0m
2025-02-27T19:42:08.8789710Z 
2025-02-27T19:42:08.8790715Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:216:20)
2025-02-27T19:42:08.8791190Z 
2025-02-27T19:42:08.8792001Z   ● Task System Integration › should cancel an in-progress task
2025-02-27T19:42:08.8792391Z 
2025-02-27T19:42:08.8792989Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.8793348Z 
2025-02-27T19:42:08.8793479Z     Expected: true
2025-02-27T19:42:08.8793778Z     Received: false
2025-02-27T19:42:08.8794163Z 
2025-02-27T19:42:08.8797338Z     [0m [90m 240 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mcancelTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:42:08.8797968Z      [90m 241 |[39m     
2025-02-27T19:42:08.8799717Z     [31m[1m>[22m[39m[90m 242 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:42:08.8800577Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:42:08.8802771Z      [90m 243 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:42:08.8803766Z      [90m 244 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:42:08.8805971Z      [90m 245 |[39m         type[33m:[39m [32m'tasks/cancelTask'[39m[33m,[39m[0m
2025-02-27T19:42:08.8806384Z 
2025-02-27T19:42:08.8807335Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:242:20)
2025-02-27T19:42:08.8807796Z 
2025-02-27T19:42:08.8809538Z   ● Task System Integration › should check all task requirements and unlock eligible tasks
2025-02-27T19:42:08.8810091Z 
2025-02-27T19:42:08.8810365Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:42:08.8810727Z 
2025-02-27T19:42:08.8810849Z     Expected: 2
2025-02-27T19:42:08.8811148Z     Received: 0
2025-02-27T19:42:08.8811325Z 
2025-02-27T19:42:08.8814269Z     [0m [90m 271 |[39m     [36mconst[39m unlocked [33m=[39m taskManager[33m.[39mcheckAllTaskRequirements()[33m;[39m
2025-02-27T19:42:08.8814898Z      [90m 272 |[39m     
2025-02-27T19:42:08.8817803Z     [31m[1m>[22m[39m[90m 273 |[39m     expect(unlocked)[33m.[39mtoBe([35m2[39m)[33m;[39m [90m// Two tasks should be unlocked[39m
2025-02-27T19:42:08.8818748Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:42:08.8820723Z      [90m 274 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:42:08.8821692Z      [90m 275 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:42:08.8823756Z      [90m 276 |[39m         type[33m:[39m [32m'tasks/unlockTask'[39m[33m,[39m[0m
2025-02-27T19:42:08.8824192Z 
2025-02-27T19:42:08.8825172Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:273:22)
2025-02-27T19:42:08.8825640Z 
2025-02-27T19:42:08.8826913Z   ● Task System Integration › should emit events when task status changes
2025-02-27T19:42:08.8827376Z 
2025-02-27T19:42:08.8827788Z     expect(jest.fn()).toHaveBeenCalledWith(...expected)
2025-02-27T19:42:08.8828156Z 
2025-02-27T19:42:08.8828294Z     Expected: "test-task"
2025-02-27T19:42:08.8828527Z 
2025-02-27T19:42:08.8828656Z     Number of calls: 0
2025-02-27T19:42:08.8829138Z 
2025-02-27T19:42:08.8829373Z     [0m [90m 314 |[39m     
2025-02-27T19:42:08.8831066Z      [90m 315 |[39m     [90m// Verify events were emitted[39m
2025-02-27T19:42:08.8834187Z     [31m[1m>[22m[39m[90m 316 |[39m     expect(startedListener)[33m.[39mtoHaveBeenCalledWith([32m'test-task'[39m)[33m;[39m
2025-02-27T19:42:08.8835044Z      [90m     |[39m                             [31m[1m^[22m[39m
2025-02-27T19:42:08.8837389Z      [90m 317 |[39m     expect(completedListener)[33m.[39mtoHaveBeenCalledWith([32m'test-task'[39m)[33m;[39m
2025-02-27T19:42:08.8838226Z      [90m 318 |[39m   })[33m;[39m
2025-02-27T19:42:08.8838652Z      [90m 319 |[39m   [0m
2025-02-27T19:42:08.8838807Z 
2025-02-27T19:42:08.8840012Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:316:29)
2025-02-27T19:42:08.8840490Z 
2025-02-27T19:42:08.8841615Z   ● Task System Integration › should provide progress information for a task
2025-02-27T19:42:08.8842094Z 
2025-02-27T19:42:08.8842294Z     expect(received).not.toBeNull()
2025-02-27T19:42:08.8842562Z 
2025-02-27T19:42:08.8842694Z     Received: null
2025-02-27T19:42:08.8842876Z 
2025-02-27T19:42:08.8846372Z     [0m [90m 334 |[39m     [36mconst[39m progress [33m=[39m taskManager[33m.[39mgetTaskProgress([32m'test-task'[39m)[33m;[39m
2025-02-27T19:42:08.8847318Z      [90m 335 |[39m     
2025-02-27T19:42:08.8849101Z     [31m[1m>[22m[39m[90m 336 |[39m     expect(progress)[33m.[39mnot[33m.[39mtoBeNull()[33m;[39m
2025-02-27T19:42:08.8849918Z      [90m     |[39m                          [31m[1m^[22m[39m
2025-02-27T19:42:08.8851002Z      [90m 337 |[39m     expect(progress[33m?[39m[33m.[39mstatus)[33m.[39mtoBe([33mTaskStatus[39m[33m.[39m[33mIN_PROGRESS[39m)[33m;[39m
2025-02-27T19:42:08.8852959Z      [90m 338 |[39m     expect(progress[33m?[39m[33m.[39mprogress)[33m.[39mtoBe([35m50[39m)[33m;[39m
2025-02-27T19:42:08.8855784Z      [90m 339 |[39m     expect(progress[33m?[39m[33m.[39mtimeRemaining)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m
2025-02-27T19:42:08.8856400Z 
2025-02-27T19:42:08.8856978Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:336:26)
2025-02-27T19:42:08.8857452Z 
2025-02-27T19:42:08.8858370Z FAIL src/systems/__tests__/eventManager.test.ts
2025-02-27T19:42:08.8858922Z   ● Test suite failed to run
2025-02-27T19:42:08.8859159Z 
2025-02-27T19:42:08.8869808Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m65[0m:[93m42[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.8871265Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.8874977Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.8876309Z 
2025-02-27T19:42:08.8876601Z     [7m65[0m     expect(() => eventManager.initialize(store)).not.toThrow();
2025-02-27T19:42:08.8877269Z     [7m  [0m [91m                                         ~~~~~[0m
2025-02-27T19:42:08.8877588Z 
2025-02-27T19:42:08.8878343Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.8879754Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.8880356Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.8881069Z         'tutorial' is declared here.
2025-02-27T19:42:08.8891794Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m72[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.8893822Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.8899580Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.8901026Z 
2025-02-27T19:42:08.8901649Z     [7m72[0m     eventManager.initialize(store);
2025-02-27T19:42:08.8902335Z     [7m  [0m [91m                            ~~~~~[0m
2025-02-27T19:42:08.8902673Z 
2025-02-27T19:42:08.8903039Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.8903798Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.8904433Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.8904925Z         'tutorial' is declared here.
2025-02-27T19:42:08.8911492Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m85[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.8913158Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.8916696Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.8917704Z 
2025-02-27T19:42:08.8918052Z     [7m85[0m     eventManager.initialize(store);
2025-02-27T19:42:08.8918573Z     [7m  [0m [91m                            ~~~~~[0m
2025-02-27T19:42:08.8918882Z 
2025-02-27T19:42:08.8919214Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.8920370Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.8920969Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.8921715Z         'tutorial' is declared here.
2025-02-27T19:42:08.8932571Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m113[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.8933997Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.8937992Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.8939072Z 
2025-02-27T19:42:08.8939414Z     [7m113[0m     eventManager.initialize(store);
2025-02-27T19:42:08.8939920Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:42:08.8940240Z 
2025-02-27T19:42:08.8940572Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.8941719Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.8942325Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.8943801Z         'tutorial' is declared here.
2025-02-27T19:42:08.8951220Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m131[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.8952875Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.8956481Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.8957457Z 
2025-02-27T19:42:08.8957807Z     [7m131[0m     eventManager.initialize(store);
2025-02-27T19:42:08.8958357Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:42:08.8958641Z 
2025-02-27T19:42:08.8958978Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.8960259Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.8960866Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.8961640Z         'tutorial' is declared here.
2025-02-27T19:42:08.8972508Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m165[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.8974124Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.8977864Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.8978911Z 
2025-02-27T19:42:08.8979256Z     [7m165[0m     eventManager.initialize(store);
2025-02-27T19:42:08.8979749Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:42:08.8980078Z 
2025-02-27T19:42:08.8980407Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.8981583Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.8982190Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.8982970Z         'tutorial' is declared here.
2025-02-27T19:42:08.8993873Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m185[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.8995321Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.8999260Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.9000230Z 
2025-02-27T19:42:08.9000571Z     [7m185[0m     eventManager.initialize(store);
2025-02-27T19:42:08.9001103Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:42:08.9001357Z 
2025-02-27T19:42:08.9001685Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.9003007Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.9003607Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.9004289Z         'tutorial' is declared here.
2025-02-27T19:42:08.9015321Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m226[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.9017157Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.9020629Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.9021790Z 
2025-02-27T19:42:08.9022136Z     [7m226[0m     eventManager.initialize(store);
2025-02-27T19:42:08.9022592Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:42:08.9022910Z 
2025-02-27T19:42:08.9023245Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.9024332Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.9024933Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.9025735Z         'tutorial' is declared here.
2025-02-27T19:42:08.9036785Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m258[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.9038388Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.9042015Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.9043040Z 
2025-02-27T19:42:08.9043383Z     [7m258[0m     eventManager.initialize(store);
2025-02-27T19:42:08.9043857Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:42:08.9044158Z 
2025-02-27T19:42:08.9044499Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.9045697Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.9046439Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.9047220Z         'tutorial' is declared here.
2025-02-27T19:42:08.9058155Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m284[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.9059617Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.9063428Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.9064451Z 
2025-02-27T19:42:08.9064786Z     [7m284[0m     eventManager.initialize(store);
2025-02-27T19:42:08.9065353Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:42:08.9065638Z 
2025-02-27T19:42:08.9066109Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.9067302Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.9067903Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.9068551Z         'tutorial' is declared here.
2025-02-27T19:42:08.9069959Z 
2025-02-27T19:42:08.9070247Z FAIL src/systems/__tests__/gameLoop.test.ts
2025-02-27T19:42:08.9070776Z   ● Test suite failed to run
2025-02-27T19:42:08.9071027Z 
2025-02-27T19:42:08.9081453Z     [96msrc/systems/__tests__/gameLoop.test.ts[0m:[93m87[0m:[93m25[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; game: GameState; structures: StructuresState; events: EventsState; tasks: TasksState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:42:08.9083068Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:42:08.9086893Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; game: GameState; structures: StructuresState; events: EventsState; tasks: TasksState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:42:08.9087938Z 
2025-02-27T19:42:08.9088257Z     [7m87[0m     gameLoop.initialize(store);
2025-02-27T19:42:08.9088724Z     [7m  [0m [91m                        ~~~~~[0m
2025-02-27T19:42:08.9089027Z 
2025-02-27T19:42:08.9089354Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.9090464Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.9091073Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.9091850Z         'tutorial' is declared here.
2025-02-27T19:42:08.9092120Z 
2025-02-27T19:42:08.9093887Z FAIL src/gameCore.integration.test.tsx
2025-02-27T19:42:08.9095801Z   ● Game Core Systems Integration › Building purchase consumes resources correctly
2025-02-27T19:42:08.9096549Z 
2025-02-27T19:42:08.9097307Z     TypeError: Cannot read properties of undefined (reading 'communityGarden')
2025-02-27T19:42:08.9097791Z 
2025-02-27T19:42:08.9098033Z     [0m [90m 165 |[39m     
2025-02-27T19:42:08.9100469Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.9103291Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.9104418Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.9104922Z      [90m 168 |[39m     
2025-02-27T19:42:08.9107499Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:42:08.9109976Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:42:08.9110414Z 
2025-02-27T19:42:08.9111380Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:42:08.9113084Z       at BuildingManager.purchaseBuilding (src/systems/buildingManager.ts:194:58)
2025-02-27T19:42:08.9114367Z       at Object.<anonymous> (src/gameCore.integration.test.tsx:171:36)
2025-02-27T19:42:08.9114786Z 
2025-02-27T19:42:08.9116586Z   ● Game Core Systems Integration › Building level affects production calculation
2025-02-27T19:42:08.9117047Z 
2025-02-27T19:42:08.9117858Z     TypeError: Cannot read properties of undefined (reading 'communityGarden')
2025-02-27T19:42:08.9118340Z 
2025-02-27T19:42:08.9118566Z     [0m [90m 274 |[39m     
2025-02-27T19:42:08.9121111Z      [90m 275 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.9123991Z     [31m[1m>[22m[39m[90m 276 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.9125019Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.9125540Z      [90m 277 |[39m     
2025-02-27T19:42:08.9127121Z      [90m 278 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.9128198Z      [90m 279 |[39m       [36mreturn[39m {}[33m;[39m[0m
2025-02-27T19:42:08.9128532Z 
2025-02-27T19:42:08.9130197Z       at BuildingManager.calculateUpgradeCost (src/systems/buildingManager.ts:276:38)
2025-02-27T19:42:08.9131359Z       at Object.<anonymous> (src/gameCore.integration.test.tsx:209:41)
2025-02-27T19:42:08.9131792Z 
2025-02-27T19:42:08.9132253Z FAIL src/state/selectors.test.ts
2025-02-27T19:42:08.9132749Z   ● Test suite failed to run
2025-02-27T19:42:08.9133189Z 
2025-02-27T19:42:08.9147727Z     [96msrc/state/selectors.test.ts[0m:[93m94[0m:[93m32[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ resources: { 'collective-power': Resource; solidarity: Resource; 'community-trust': Resource; }; structures: { 'union-office': Structure; 'community-center': Structure; 'alternative-media': Structure; }; game: { ...; }; tasks: { ...; }; events: { ...; }; progression: { ...; }; }' to type 'RootState' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
2025-02-27T19:42:08.9154157Z       Property 'tutorial' is missing in type '{ resources: { 'collective-power': Resource; solidarity: Resource; 'community-trust': Resource; }; structures: { 'union-office': Structure; 'community-center': Structure; 'alternative-media': Structure; }; game: { ...; }; tasks: { ...; }; events: { ...; }; progression: { ...; }; }' but required in type 'RootState'.
2025-02-27T19:42:08.9155757Z 
2025-02-27T19:42:08.9156302Z     [7m 94[0m   const mockState: RootState = {
2025-02-27T19:42:08.9156912Z     [7m   [0m [91m                               ~[0m
2025-02-27T19:42:08.9157425Z     [7m 95[0m     resources: {
2025-02-27T19:42:08.9157908Z     [7m   [0m [91m~~~~~~~~~~~~~~~~[0m
2025-02-27T19:42:08.9158326Z     [7m...[0m 
2025-02-27T19:42:08.9158857Z     [7m163[0m     }
2025-02-27T19:42:08.9159154Z     [7m   [0m [91m~~~~~[0m
2025-02-27T19:42:08.9159419Z     [7m164[0m   } as RootState;
2025-02-27T19:42:08.9161206Z     [7m   [0m [91m~~~~~~~~~~~~~~~~[0m
2025-02-27T19:42:08.9161496Z 
2025-02-27T19:42:08.9162196Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:42:08.9163631Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:42:08.9164244Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:42:08.9164966Z         'tutorial' is declared here.
2025-02-27T19:42:08.9165236Z 
2025-02-27T19:42:08.9166159Z FAIL src/workers.integration.test.tsx
2025-02-27T19:42:08.9168381Z   ● Worker System Integration Test › WorkerManager can assign and manage workers
2025-02-27T19:42:08.9168820Z 
2025-02-27T19:42:08.9169486Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:42:08.9169939Z 
2025-02-27T19:42:08.9170169Z     [0m [90m 190 |[39m     
2025-02-27T19:42:08.9172636Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:42:08.9175446Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:42:08.9176713Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:42:08.9177231Z      [90m 193 |[39m     
2025-02-27T19:42:08.9178677Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:42:08.9180224Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:42:08.9180603Z 
2025-02-27T19:42:08.9182046Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:42:08.9183138Z       at Object.<anonymous> (src/workers.integration.test.tsx:105:19)
2025-02-27T19:42:08.9183558Z 
2025-02-27T19:42:08.9184417Z FAIL src/systems/__tests__/oppressionSystem.test.ts
2025-02-27T19:42:08.9186697Z   ● Oppression System › oppression resource should generate at the specified rate
2025-02-27T19:42:08.9187165Z 
2025-02-27T19:42:08.9187689Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:42:08.9188120Z 
2025-02-27T19:42:08.9188349Z     [0m [90m 178 |[39m     
2025-02-27T19:42:08.9191021Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:42:08.9197829Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:42:08.9199568Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:42:08.9200103Z      [90m 181 |[39m     
2025-02-27T19:42:08.9200517Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:42:08.9201779Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:42:08.9202224Z 
2025-02-27T19:42:08.9203323Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:42:08.9205132Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:67:21)
2025-02-27T19:42:08.9205633Z 
2025-02-27T19:42:08.9206892Z   ● Oppression System › oppression should continue to generate in multiple ticks
2025-02-27T19:42:08.9207367Z 
2025-02-27T19:42:08.9208097Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:42:08.9208526Z 
2025-02-27T19:42:08.9208765Z     [0m [90m 178 |[39m     
2025-02-27T19:42:08.9211585Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:42:08.9218273Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:42:08.9219944Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:42:08.9220470Z      [90m 181 |[39m     
2025-02-27T19:42:08.9220963Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:42:08.9222621Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:42:08.9223060Z 
2025-02-27T19:42:08.9224006Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:42:08.9225795Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:85:23)
2025-02-27T19:42:08.9226454Z 
2025-02-27T19:42:08.9228157Z   ● Oppression System › oppression should generate even if its perSecond property is modified
2025-02-27T19:42:08.9228628Z 
2025-02-27T19:42:08.9228986Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:42:08.9229426Z 
2025-02-27T19:42:08.9229670Z     [0m [90m 178 |[39m     
2025-02-27T19:42:08.9232421Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:42:08.9239289Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:42:08.9240740Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:42:08.9241246Z      [90m 181 |[39m     
2025-02-27T19:42:08.9241772Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:42:08.9243384Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:42:08.9243820Z 
2025-02-27T19:42:08.9244761Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:42:08.9246736Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:107:21)
2025-02-27T19:42:08.9247238Z 
2025-02-27T19:42:08.9248445Z   ● Oppression System › oppression generation should scale with time delta correctly
2025-02-27T19:42:08.9248906Z 
2025-02-27T19:42:08.9249581Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:42:08.9250000Z 
2025-02-27T19:42:08.9250225Z     [0m [90m 178 |[39m     
2025-02-27T19:42:08.9253005Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:42:08.9259776Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:42:08.9261254Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:42:08.9261761Z      [90m 181 |[39m     
2025-02-27T19:42:08.9262287Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:42:08.9264069Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:42:08.9264509Z 
2025-02-27T19:42:08.9265367Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:42:08.9267339Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:127:23)
2025-02-27T19:42:08.9267833Z 
2025-02-27T19:42:08.9268062Z FAIL src/components/App.test.tsx
2025-02-27T19:42:08.9268554Z   ● Test suite failed to run
2025-02-27T19:42:08.9268798Z 
2025-02-27T19:42:08.9272867Z     [96msrc/managers/TutorialManager.ts[0m:[93m3[0m:[93m10[0m - [91merror[0m[90m TS2305: [0mModule '"../state/store"' has no exported member 'AppState'.
2025-02-27T19:42:08.9273694Z 
2025-02-27T19:42:08.9274040Z     [7m3[0m import { AppState } from '../state/store';
2025-02-27T19:42:08.9274734Z     [7m [0m [91m         ~~~~~~~~[0m
2025-02-27T19:42:08.9280465Z     [96msrc/managers/TutorialManager.ts[0m:[93m79[0m:[93m24[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:42:08.9281421Z 
2025-02-27T19:42:08.9281679Z     [7m79[0m       const tutorial = tutorialContent[currentStep];
2025-02-27T19:42:08.9282410Z     [7m  [0m [91m                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:42:08.9288280Z     [96msrc/managers/TutorialManager.ts[0m:[93m99[0m:[93m24[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:42:08.9289350Z 
2025-02-27T19:42:08.9289586Z     [7m99[0m       const tutorial = tutorialContent[currentStep];
2025-02-27T19:42:08.9290268Z     [7m  [0m [91m                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:42:08.9296549Z     [96msrc/managers/TutorialManager.ts[0m:[93m155[0m:[93m14[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:42:08.9297427Z 
2025-02-27T19:42:08.9297792Z     [7m155[0m       return tutorialContent[currentStep];
2025-02-27T19:42:08.9298436Z     [7m   [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:42:08.9298633Z 
2025-02-27T19:42:08.9298641Z 
2025-02-27T19:42:08.9301377Z Test Suites: 13 failed, 45 passed, 58 total
2025-02-27T19:42:08.9302043Z Tests:       60 failed, 4 skipped, 299 passed, 363 total
2025-02-27T19:42:08.9302370Z Snapshots:   0 total
2025-02-27T19:42:08.9302580Z Time:        30.8 s
2025-02-27T19:42:08.9302785Z Ran all test suites.
2025-02-27T19:42:08.9494221Z ##[error]Process completed with exit code 1.
