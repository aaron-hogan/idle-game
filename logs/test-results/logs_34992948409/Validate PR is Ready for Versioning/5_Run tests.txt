2025-02-27T19:34:24.8015644Z ##[group]Run npm test
2025-02-27T19:34:24.8016067Z [36;1mnpm test[0m
2025-02-27T19:34:24.8065864Z shell: /usr/bin/bash -e {0}
2025-02-27T19:34:24.8066154Z ##[endgroup]
2025-02-27T19:34:25.0606836Z 
2025-02-27T19:34:25.0607499Z > idle-game@0.5.0-4 test
2025-02-27T19:34:25.0608016Z > jest
2025-02-27T19:34:25.0608230Z 
2025-02-27T19:34:35.1096131Z FAIL src/systems/__tests__/workerManager.test.ts (8.838 s)
2025-02-27T19:34:35.1102283Z   ● WorkerManager › Worker counting › should get total available workers based on game stage
2025-02-27T19:34:35.1216052Z 
2025-02-27T19:34:35.1217102Z     TypeError: Cannot read properties of undefined (reading 'gameStage')
2025-02-27T19:34:35.1217966Z 
2025-02-27T19:34:35.1218898Z     [0m [90m 142 |[39m     [90m// Available workers are determined by current game stage[39m
2025-02-27T19:34:35.1220132Z      [90m 143 |[39m     [90m// 5 base workers + 3 per game stage[39m
2025-02-27T19:34:35.1221758Z     [31m[1m>[22m[39m[90m 144 |[39m     [36mreturn[39m [35m5[39m [33m+[39m (state[33m.[39mgame[33m.[39mgameStage [33m*[39m [35m3[39m)[33m;[39m
2025-02-27T19:34:35.1223273Z      [90m     |[39m                            [31m[1m^[22m[39m
2025-02-27T19:34:35.1254839Z      [90m 145 |[39m   }
2025-02-27T19:34:35.1285911Z      [90m 146 |[39m   
2025-02-27T19:34:35.1309840Z      [90m 147 |[39m   [90m/**[39m[0m
2025-02-27T19:34:35.1310526Z 
2025-02-27T19:34:35.1311320Z       at WorkerManager.getTotalAvailableWorkers (src/systems/workerManager.ts:144:28)
2025-02-27T19:34:35.1312630Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:89:28)
2025-02-27T19:34:35.1313361Z 
2025-02-27T19:34:35.1314092Z   ● WorkerManager › Worker counting › should get total assigned workers
2025-02-27T19:34:35.1314788Z 
2025-02-27T19:34:35.1315469Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:35.1316328Z         at Function.values (<anonymous>)
2025-02-27T19:34:35.1316898Z 
2025-02-27T19:34:35.1317815Z     [0m [90m 153 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:35.1318830Z      [90m 154 |[39m     
2025-02-27T19:34:35.1320105Z     [31m[1m>[22m[39m[90m 155 |[39m     [36mreturn[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mreduce(
2025-02-27T19:34:35.1321321Z      [90m     |[39m                   [31m[1m^[22m[39m
2025-02-27T19:34:35.1322499Z      [90m 156 |[39m       (total[33m:[39m number[33m,[39m structure[33m:[39m unknown) [33m=>[39m {
2025-02-27T19:34:35.1324444Z      [90m 157 |[39m         [36mif[39m (structure [33m&&[39m [36mtypeof[39m structure [33m===[39m [32m'object'[39m [33m&&[39m [32m'workers'[39m [36min[39m structure [33m&&[39m 
2025-02-27T19:34:35.1326411Z      [90m 158 |[39m             [36mtypeof[39m structure[33m.[39mworkers [33m===[39m [32m'number'[39m) {[0m
2025-02-27T19:34:35.1327206Z 
2025-02-27T19:34:35.1331382Z       at WorkerManager.getTotalAssignedWorkers (src/systems/workerManager.ts:155:19)
2025-02-27T19:34:35.1332866Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:102:28)
2025-02-27T19:34:35.1333817Z 
2025-02-27T19:34:35.1336160Z   ● WorkerManager › Worker counting › should get remaining workers correctly
2025-02-27T19:34:35.1337220Z 
2025-02-27T19:34:35.1340122Z     TypeError: Cannot read properties of undefined (reading 'gameStage')
2025-02-27T19:34:35.1340635Z 
2025-02-27T19:34:35.1341289Z     [0m [90m 142 |[39m     [90m// Available workers are determined by current game stage[39m
2025-02-27T19:34:35.1342294Z      [90m 143 |[39m     [90m// 5 base workers + 3 per game stage[39m
2025-02-27T19:34:35.1343624Z     [31m[1m>[22m[39m[90m 144 |[39m     [36mreturn[39m [35m5[39m [33m+[39m (state[33m.[39mgame[33m.[39mgameStage [33m*[39m [35m3[39m)[33m;[39m
2025-02-27T19:34:35.1344737Z      [90m     |[39m                            [31m[1m^[22m[39m
2025-02-27T19:34:35.1345502Z      [90m 145 |[39m   }
2025-02-27T19:34:35.1346387Z      [90m 146 |[39m   
2025-02-27T19:34:35.1346891Z      [90m 147 |[39m   [90m/**[39m[0m
2025-02-27T19:34:35.1347180Z 
2025-02-27T19:34:35.1347685Z       at WorkerManager.getTotalAvailableWorkers (src/systems/workerManager.ts:144:28)
2025-02-27T19:34:35.1348695Z       at WorkerManager.getRemainingWorkers (src/systems/workerManager.ts:172:17)
2025-02-27T19:34:35.1349620Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:118:28)
2025-02-27T19:34:35.1350388Z 
2025-02-27T19:34:35.1350947Z   ● WorkerManager › Worker assignment › should assign workers to buildings
2025-02-27T19:34:35.1351441Z 
2025-02-27T19:34:35.1351832Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:35.1352306Z 
2025-02-27T19:34:35.1352575Z     [0m [90m 190 |[39m     
2025-02-27T19:34:35.1353420Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.1354653Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:35.1355833Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:35.1356384Z      [90m 193 |[39m     
2025-02-27T19:34:35.1356965Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:35.1357722Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:35.1358107Z 
2025-02-27T19:34:35.1358605Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:35.1359560Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:137:36)
2025-02-27T19:34:35.1360021Z 
2025-02-27T19:34:35.1360619Z   ● WorkerManager › Worker assignment › should limit assignment to available workers
2025-02-27T19:34:35.1361147Z 
2025-02-27T19:34:35.1361521Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:35.1361996Z 
2025-02-27T19:34:35.1362247Z     [0m [90m 190 |[39m     
2025-02-27T19:34:35.1363091Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.1364345Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:35.1365559Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:35.1366134Z      [90m 193 |[39m     
2025-02-27T19:34:35.1366710Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:35.1367448Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:35.1367830Z 
2025-02-27T19:34:35.1368325Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:35.1369251Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:148:21)
2025-02-27T19:34:35.1369741Z 
2025-02-27T19:34:35.1370287Z   ● WorkerManager › Worker assignment › should limit assignment to maxWorkers
2025-02-27T19:34:35.1370780Z 
2025-02-27T19:34:35.1371183Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:35.1371646Z 
2025-02-27T19:34:35.1371904Z     [0m [90m 190 |[39m     
2025-02-27T19:34:35.1372726Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.1374040Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:35.1375009Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:35.1375748Z      [90m 193 |[39m     
2025-02-27T19:34:35.1376338Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:35.1377098Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:35.1377480Z 
2025-02-27T19:34:35.1378271Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:35.1379241Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:159:21)
2025-02-27T19:34:35.1379751Z 
2025-02-27T19:34:35.1380326Z   ● WorkerManager › Worker assignment › should handle nonexistent building
2025-02-27T19:34:35.1380808Z 
2025-02-27T19:34:35.1381221Z     TypeError: Cannot read properties of undefined (reading 'nonexistent')
2025-02-27T19:34:35.1381983Z 
2025-02-27T19:34:35.1382271Z     [0m [90m 190 |[39m     
2025-02-27T19:34:35.1383119Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.1384535Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:35.1385777Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:35.1386348Z      [90m 193 |[39m     
2025-02-27T19:34:35.1386966Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:35.1387761Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:35.1388152Z 
2025-02-27T19:34:35.1388682Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:35.1389680Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:169:36)
2025-02-27T19:34:35.1390191Z 
2025-02-27T19:34:35.1390740Z   ● WorkerManager › Changing worker count › should add workers by delta
2025-02-27T19:34:35.1391213Z 
2025-02-27T19:34:35.1391630Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:35.1392108Z 
2025-02-27T19:34:35.1392377Z     [0m [90m 234 |[39m     
2025-02-27T19:34:35.1393246Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.1394547Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:35.1395822Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:35.1396394Z      [90m 237 |[39m     
2025-02-27T19:34:35.1396995Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:35.1397781Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:35.1398203Z 
2025-02-27T19:34:35.1398647Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:34:35.1399572Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:189:21)
2025-02-27T19:34:35.1400062Z 
2025-02-27T19:34:35.1400599Z   ● WorkerManager › Changing worker count › should remove workers by delta
2025-02-27T19:34:35.1401089Z 
2025-02-27T19:34:35.1401491Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:35.1401971Z 
2025-02-27T19:34:35.1402250Z     [0m [90m 234 |[39m     
2025-02-27T19:34:35.1403108Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.1404395Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:35.1405651Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:35.1406265Z      [90m 237 |[39m     
2025-02-27T19:34:35.1406885Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:35.1407751Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:35.1408147Z 
2025-02-27T19:34:35.1408609Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:34:35.1409540Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:210:21)
2025-02-27T19:34:35.1410041Z 
2025-02-27T19:34:35.1410682Z   ● WorkerManager › Changing worker count › should limit addition by available workers
2025-02-27T19:34:35.1411523Z 
2025-02-27T19:34:35.1411928Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:35.1412416Z 
2025-02-27T19:34:35.1412684Z     [0m [90m 234 |[39m     
2025-02-27T19:34:35.1413549Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.1415340Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:35.1416336Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:35.1416889Z      [90m 237 |[39m     
2025-02-27T19:34:35.1417484Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:35.1418234Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:35.1418618Z 
2025-02-27T19:34:35.1419057Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:34:35.1419973Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:231:21)
2025-02-27T19:34:35.1420458Z 
2025-02-27T19:34:35.1421062Z   ● WorkerManager › Worker efficiency › should calculate worker efficiency correctly
2025-02-27T19:34:35.1421559Z 
2025-02-27T19:34:35.1421956Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:35.1422429Z 
2025-02-27T19:34:35.1422815Z     [0m [90m 287 |[39m     
2025-02-27T19:34:35.1423707Z      [90m 288 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:35.1424951Z     [31m[1m>[22m[39m[90m 289 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:35.1426154Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:35.1426714Z      [90m 290 |[39m     
2025-02-27T19:34:35.1427692Z      [90m 291 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m building[33m.[39mworkers [33m===[39m [35m0[39m) {
2025-02-27T19:34:35.1428685Z      [90m 292 |[39m       [36mreturn[39m [35m0[39m[33m;[39m[0m
2025-02-27T19:34:35.1429068Z 
2025-02-27T19:34:35.1429589Z       at WorkerManager.calculateWorkerEfficiency (src/systems/workerManager.ts:289:38)
2025-02-27T19:34:35.1430592Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:246:28)
2025-02-27T19:34:35.1431098Z 
2025-02-27T19:34:35.1431775Z   ● WorkerManager › Worker efficiency › should handle nonexistent building for efficiency
2025-02-27T19:34:35.1432343Z 
2025-02-27T19:34:35.1432747Z     TypeError: Cannot read properties of undefined (reading 'nonexistent')
2025-02-27T19:34:35.1433197Z 
2025-02-27T19:34:35.1433463Z     [0m [90m 287 |[39m     
2025-02-27T19:34:35.1434375Z      [90m 288 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:35.1435892Z     [31m[1m>[22m[39m[90m 289 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:35.1436886Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:35.1437432Z      [90m 290 |[39m     
2025-02-27T19:34:35.1438364Z      [90m 291 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m building[33m.[39mworkers [33m===[39m [35m0[39m) {
2025-02-27T19:34:35.1439308Z      [90m 292 |[39m       [36mreturn[39m [35m0[39m[33m;[39m[0m
2025-02-27T19:34:35.1439670Z 
2025-02-27T19:34:35.1440180Z       at WorkerManager.calculateWorkerEfficiency (src/systems/workerManager.ts:289:38)
2025-02-27T19:34:35.1441151Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:283:28)
2025-02-27T19:34:35.1441620Z 
2025-02-27T19:34:35.1442224Z   ● WorkerManager › Auto-assignment › should auto-assign with balanced strategy
2025-02-27T19:34:35.1442716Z 
2025-02-27T19:34:35.1443254Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:35.1443814Z         at Function.values (<anonymous>)
2025-02-27T19:34:35.1444105Z 
2025-02-27T19:34:35.1444350Z     [0m [90m 318 |[39m     
2025-02-27T19:34:35.1445389Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:35.1447257Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:34:35.1449047Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:34:35.1449864Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:34:35.1450794Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:34:35.1451549Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:34:35.1451880Z 
2025-02-27T19:34:35.1452257Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:34:35.1453024Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:290:21)
2025-02-27T19:34:35.1453439Z 
2025-02-27T19:34:35.1453921Z   ● WorkerManager › Auto-assignment › should auto-assign with focused strategy
2025-02-27T19:34:35.1454386Z 
2025-02-27T19:34:35.1454664Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:35.1455412Z         at Function.values (<anonymous>)
2025-02-27T19:34:35.1455713Z 
2025-02-27T19:34:35.1455954Z     [0m [90m 318 |[39m     
2025-02-27T19:34:35.1456808Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:35.1458664Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:34:35.1460019Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:34:35.1460764Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:34:35.1461655Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:34:35.1462495Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:34:35.1462867Z 
2025-02-27T19:34:35.1463289Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:34:35.1464237Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:310:21)
2025-02-27T19:34:35.1464715Z 
2025-02-27T19:34:35.1465446Z   ● WorkerManager › Auto-assignment › should auto-assign with efficiency strategy
2025-02-27T19:34:35.1465966Z 
2025-02-27T19:34:35.1466301Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:35.1466867Z         at Function.values (<anonymous>)
2025-02-27T19:34:35.1467173Z 
2025-02-27T19:34:35.1467402Z     [0m [90m 318 |[39m     
2025-02-27T19:34:35.1468255Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:35.1470123Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:34:35.1471684Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:34:35.1472500Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:34:35.1473432Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:34:35.1474314Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:34:35.1474930Z 
2025-02-27T19:34:35.1475553Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:34:35.1476463Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:331:21)
2025-02-27T19:34:35.1476952Z 
2025-02-27T19:34:35.5562681Z FAIL src/systems/resourceManager.test.ts (9.242 s)
2025-02-27T19:34:35.5564507Z   ● ResourceManager › initializeResources › dispatches addResource action for each initial resource
2025-02-27T19:34:35.5565382Z 
2025-02-27T19:34:35.5565722Z     TypeError: this.actions.addResource is not a function
2025-02-27T19:34:35.5566136Z 
2025-02-27T19:34:35.5568792Z     [0m [90m 153 |[39m     [33mObject[39m[33m.[39mvalues([33mINITIAL_RESOURCES[39m)[33m.[39mforEach(resource [33m=>[39m {
2025-02-27T19:34:35.5588162Z      [90m 154 |[39m       [36mif[39m (validateObject(resource[33m,[39m [[32m'id'[39m[33m,[39m [32m'name'[39m[33m,[39m [32m'amount'[39m[33m,[39m [32m'perSecond'[39m[33m,[39m [32m'unlocked'[39m][33m,[39m [32m'initializeResources'[39m)) {
2025-02-27T19:34:35.5592257Z     [31m[1m>[22m[39m[90m 155 |[39m         [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddResource(resource))[33m;[39m
2025-02-27T19:34:35.5595784Z      [90m     |[39m                                    [31m[1m^[22m[39m
2025-02-27T19:34:35.5598693Z      [90m 156 |[39m       }
2025-02-27T19:34:35.5601524Z      [90m 157 |[39m     })[33m;[39m
2025-02-27T19:34:35.5604308Z      [90m 158 |[39m   }[0m
2025-02-27T19:34:35.5606984Z 
2025-02-27T19:34:35.5609476Z       at src/systems/resourceManager.ts:155:36
2025-02-27T19:34:35.5612273Z           at Array.forEach (<anonymous>)
2025-02-27T19:34:35.5614886Z       at ResourceManager.initializeResources (src/systems/resourceManager.ts:153:38)
2025-02-27T19:34:35.5685921Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:54:23)
2025-02-27T19:34:35.5686448Z 
2025-02-27T19:34:35.5687341Z   ● ResourceManager › updateResources › updates resource amounts based on perSecond rates and elapsed time
2025-02-27T19:34:35.5688033Z 
2025-02-27T19:34:35.5688407Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:35.5688854Z 
2025-02-27T19:34:35.5689145Z     [0m [90m 178 |[39m     
2025-02-27T19:34:35.5690089Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:35.5692403Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:35.5694017Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:35.5694570Z      [90m 181 |[39m     
2025-02-27T19:34:35.5695307Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:35.5696272Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:35.5696746Z 
2025-02-27T19:34:35.5697211Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:35.5698097Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:105:23)
2025-02-27T19:34:35.5698564Z 
2025-02-27T19:34:35.5699532Z   ● ResourceManager › calculateResourceGeneration › calculates and updates resource generation rates based on structures
2025-02-27T19:34:35.5700334Z 
2025-02-27T19:34:35.5700646Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:35.5701240Z         at Function.values (<anonymous>)
2025-02-27T19:34:35.5701547Z 
2025-02-27T19:34:35.5701797Z     [0m [90m 251 |[39m     
2025-02-27T19:34:35.5702471Z      [90m 252 |[39m     [90m// Add production from all structures[39m
2025-02-27T19:34:35.5703786Z     [31m[1m>[22m[39m[90m 253 |[39m     [33mObject[39m[33m.[39mvalues(structures)[33m.[39mforEach((structure[33m:[39m unknown) [33m=>[39m {
2025-02-27T19:34:35.5705538Z      [90m     |[39m            [31m[1m^[22m[39m
2025-02-27T19:34:35.5706540Z      [90m 254 |[39m       [90m// Skip structures that aren't built or don't have workers assigned[39m
2025-02-27T19:34:35.5707891Z      [90m 255 |[39m       [36mif[39m ([33m![39mstructure [33m||[39m [36mtypeof[39m structure [33m!==[39m [32m'object'[39m [33m||[39m
2025-02-27T19:34:35.5709718Z      [90m 256 |[39m           [33m![39m([32m'unlocked'[39m [36min[39m structure) [33m||[39m [33m![39m([32m'level'[39m [36min[39m structure) [33m||[39m[0m
2025-02-27T19:34:35.5710406Z 
2025-02-27T19:34:35.5710991Z       at ResourceManager.calculateResourceGeneration (src/systems/resourceManager.ts:253:12)
2025-02-27T19:34:35.5711988Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:197:23)
2025-02-27T19:34:35.5712455Z 
2025-02-27T19:34:35.5713170Z   ● ResourceManager › canAfford › returns true when all resources are available and sufficient
2025-02-27T19:34:35.5713785Z 
2025-02-27T19:34:35.5714229Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:35.5714798Z 
2025-02-27T19:34:35.5715916Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:35.5717324Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:35.5718521Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:35.5719492Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:35.5720876Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:35.5722092Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.5722753Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:35.5723035Z 
2025-02-27T19:34:35.5723455Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:35.5724280Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:256:38)
2025-02-27T19:34:35.5724728Z 
2025-02-27T19:34:35.5725506Z   ● ResourceManager › canAfford › returns false when any resource is insufficient
2025-02-27T19:34:35.5726044Z 
2025-02-27T19:34:35.5726477Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:35.5726993Z 
2025-02-27T19:34:35.5727899Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:35.5729244Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:35.5730475Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:35.5731427Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:35.5732812Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:35.5734072Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.5734727Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:35.5735011Z 
2025-02-27T19:34:35.5735638Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:35.5736512Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:297:38)
2025-02-27T19:34:35.5736972Z 
2025-02-27T19:34:35.5737605Z   ● ResourceManager › canAfford › returns false when any resource is not unlocked
2025-02-27T19:34:35.5738441Z 
2025-02-27T19:34:35.5738891Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:35.5739391Z 
2025-02-27T19:34:35.5740335Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:35.5741692Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:35.5743260Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:35.5744235Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:35.5745833Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:35.5747064Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.5747693Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:35.5747945Z 
2025-02-27T19:34:35.5748345Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:35.5749148Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:338:38)
2025-02-27T19:34:35.5749580Z 
2025-02-27T19:34:35.5750095Z   ● ResourceManager › canAfford › returns false when any resource is missing
2025-02-27T19:34:35.5750586Z 
2025-02-27T19:34:35.5751017Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:35.5751527Z 
2025-02-27T19:34:35.5752488Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:35.5753827Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:35.5755013Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:35.5756124Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:35.5757419Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:35.5758525Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.5759110Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:35.5759366Z 
2025-02-27T19:34:35.5759748Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:35.5760568Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:369:38)
2025-02-27T19:34:35.5761004Z 
2025-02-27T19:34:35.5761791Z   ● ResourceManager › applyResourceCost › dispatches addResourceAmount with negative values for each cost
2025-02-27T19:34:35.5762452Z 
2025-02-27T19:34:35.5762877Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:35.5763350Z 
2025-02-27T19:34:35.5764207Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:35.5765754Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:35.5766884Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:35.5767796Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:35.5769130Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:35.5770280Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.5770900Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:35.5771587Z 
2025-02-27T19:34:35.5772013Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:35.5772975Z       at ResourceManager.applyResourceCost (src/systems/resourceManager.ts:363:15)
2025-02-27T19:34:35.5773906Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:415:38)
2025-02-27T19:34:35.5774379Z 
2025-02-27T19:34:35.5775001Z   ● ResourceManager › unlockResource › unlocks a locked resource and returns true
2025-02-27T19:34:35.5776009Z 
2025-02-27T19:34:35.5776463Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:34:35.5776978Z 
2025-02-27T19:34:35.5777627Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:34:35.5778767Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.5780086Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:35.5781123Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:35.5781682Z      [90m 386 |[39m     
2025-02-27T19:34:35.5782525Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:34:35.5783642Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:34:35.5784178Z 
2025-02-27T19:34:35.5784635Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:34:35.5785678Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:462:38)
2025-02-27T19:34:35.5786109Z 
2025-02-27T19:34:35.5786650Z   ● ResourceManager › unlockResource › returns false for already unlocked resources
2025-02-27T19:34:35.5787138Z 
2025-02-27T19:34:35.5787530Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:34:35.5788016Z 
2025-02-27T19:34:35.5788636Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:34:35.5789736Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.5791019Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:35.5792005Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:35.5792541Z      [90m 386 |[39m     
2025-02-27T19:34:35.5793375Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:34:35.5794488Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:34:35.5794977Z 
2025-02-27T19:34:35.5795617Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:34:35.5796469Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:499:38)
2025-02-27T19:34:35.5796911Z 
2025-02-27T19:34:35.5797462Z   ● ResourceManager › unlockResource › returns false for non-existent resources
2025-02-27T19:34:35.5797953Z 
2025-02-27T19:34:35.5798340Z     TypeError: Cannot read properties of undefined (reading 'non-existent')
2025-02-27T19:34:35.5798805Z 
2025-02-27T19:34:35.5799370Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:34:35.5800451Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.5801678Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:35.5802645Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:35.5803162Z      [90m 386 |[39m     
2025-02-27T19:34:35.5803973Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:34:35.5805611Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:34:35.5806152Z 
2025-02-27T19:34:35.5806594Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:34:35.5807463Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:527:38)
2025-02-27T19:34:35.5808113Z 
2025-02-27T19:34:35.5808922Z   ● ResourceManager › addResourceAmount and setResourceAmount › addResourceAmount adds to existing resource
2025-02-27T19:34:35.5809600Z 
2025-02-27T19:34:35.5810027Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:34:35.5810502Z 
2025-02-27T19:34:35.5811334Z     [0m [90m 407 |[39m   addResourceAmount(resourceId[33m:[39m string[33m,[39m amount[33m:[39m number)[33m:[39m boolean {
2025-02-27T19:34:35.5812587Z      [90m 408 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.5813814Z     [31m[1m>[22m[39m[90m 409 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:35.5814775Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:35.5815463Z      [90m 410 |[39m     
2025-02-27T19:34:35.5816146Z      [90m 411 |[39m     [90m// Can't add to a resource that doesn't exist[39m
2025-02-27T19:34:35.5816924Z      [90m 412 |[39m     [36mif[39m ([33m![39mresource) {[0m
2025-02-27T19:34:35.5817268Z 
2025-02-27T19:34:35.5817732Z       at ResourceManager.addResourceAmount (src/systems/resourceManager.ts:409:37)
2025-02-27T19:34:35.5818617Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:560:38)
2025-02-27T19:34:35.5819062Z 
2025-02-27T19:34:35.5819915Z   ● ResourceManager › addResourceAmount and setResourceAmount › setResourceAmount sets absolute value for resource
2025-02-27T19:34:35.5820650Z 
2025-02-27T19:34:35.5821064Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:34:35.5821550Z 
2025-02-27T19:34:35.5822363Z     [0m [90m 431 |[39m   setResourceAmount(resourceId[33m:[39m string[33m,[39m amount[33m:[39m number)[33m:[39m boolean {
2025-02-27T19:34:35.5823604Z      [90m 432 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:35.5824828Z     [31m[1m>[22m[39m[90m 433 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:35.5825962Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:35.5826500Z      [90m 434 |[39m     
2025-02-27T19:34:35.5827146Z      [90m 435 |[39m     [90m// Can't set a resource that doesn't exist[39m
2025-02-27T19:34:35.5827911Z      [90m 436 |[39m     [36mif[39m ([33m![39mresource) {[0m
2025-02-27T19:34:35.5828268Z 
2025-02-27T19:34:35.5828727Z       at ResourceManager.setResourceAmount (src/systems/resourceManager.ts:433:37)
2025-02-27T19:34:35.5829626Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:598:38)
2025-02-27T19:34:35.5830072Z 
2025-02-27T19:34:35.5830599Z FAIL src/managers/progression/ProgressionManager.test.ts (9.285 s)
2025-02-27T19:34:35.7205876Z   ● Console
2025-02-27T19:34:35.7206173Z 
2025-02-27T19:34:35.7206324Z     console.error
2025-02-27T19:34:35.7207219Z       Error checking requirements: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:34:35.7208752Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:34:35.7210610Z           at ProgressionManager.checkRequirements (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:100:12)
2025-02-27T19:34:35.7212284Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:51:22)
2025-02-27T19:34:35.7214138Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:35.7215050Z           at new Promise (<anonymous>)
2025-02-27T19:34:35.7216209Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:35.7217754Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:35.7218809Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:35.7219865Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:35.7221166Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:35.7222620Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7224066Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7225498Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:35.7227165Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:35.7229101Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:35.7230612Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:35.7231832Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:35.7233103Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:35.7233774Z 
2025-02-27T19:34:35.7234293Z     [0m [90m 115 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:35.7234966Z      [90m 116 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:35.7236278Z     [31m[1m>[22m[39m[90m 117 |[39m       console[33m.[39merror([32m'Error checking requirements:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:35.7237235Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:35.7237962Z      [90m 118 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7238560Z      [90m 119 |[39m     }
2025-02-27T19:34:35.7239014Z      [90m 120 |[39m   }[0m
2025-02-27T19:34:35.7239265Z 
2025-02-27T19:34:35.7239870Z       at ProgressionManager.checkRequirements (src/managers/progression/ProgressionManager.ts:117:15)
2025-02-27T19:34:35.7241039Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:51:22)
2025-02-27T19:34:35.7241603Z 
2025-02-27T19:34:35.7241737Z     console.error
2025-02-27T19:34:35.7242501Z       Error checking requirements: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:34:35.7244012Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:34:35.7246001Z           at ProgressionManager.checkRequirements (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:100:12)
2025-02-27T19:34:35.7247694Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:77:22)
2025-02-27T19:34:35.7249228Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:35.7250161Z           at new Promise (<anonymous>)
2025-02-27T19:34:35.7251410Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:35.7252843Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:35.7253937Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:35.7255052Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:35.7256912Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:35.7258395Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7259802Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7261085Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:35.7262791Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:35.7264765Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:35.7266536Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:35.7267852Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:35.7269102Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:35.7269809Z 
2025-02-27T19:34:35.7270313Z     [0m [90m 115 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:35.7271052Z      [90m 116 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:35.7272271Z     [31m[1m>[22m[39m[90m 117 |[39m       console[33m.[39merror([32m'Error checking requirements:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:35.7273322Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:35.7274077Z      [90m 118 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7274704Z      [90m 119 |[39m     }
2025-02-27T19:34:35.7275377Z      [90m 120 |[39m   }[0m
2025-02-27T19:34:35.7275641Z 
2025-02-27T19:34:35.7276288Z       at ProgressionManager.checkRequirements (src/managers/progression/ProgressionManager.ts:117:15)
2025-02-27T19:34:35.7277495Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:77:22)
2025-02-27T19:34:35.7278103Z 
2025-02-27T19:34:35.7278254Z     console.error
2025-02-27T19:34:35.7279097Z       Error checking requirements: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:34:35.7280688Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:34:35.7282544Z           at ProgressionManager.checkRequirements (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:100:12)
2025-02-27T19:34:35.7284186Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:83:22)
2025-02-27T19:34:35.7285905Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:35.7286843Z           at new Promise (<anonymous>)
2025-02-27T19:34:35.7287823Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:35.7289177Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:35.7290581Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:35.7291678Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:35.7293034Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:35.7294748Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7296360Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7297641Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:35.7299297Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:35.7301305Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:35.7302850Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:35.7304155Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:35.7305654Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:35.7306366Z 
2025-02-27T19:34:35.7306879Z     [0m [90m 115 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:35.7307620Z      [90m 116 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:35.7308801Z     [31m[1m>[22m[39m[90m 117 |[39m       console[33m.[39merror([32m'Error checking requirements:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:35.7309807Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:35.7310572Z      [90m 118 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7311328Z      [90m 119 |[39m     }
2025-02-27T19:34:35.7311821Z      [90m 120 |[39m   }[0m
2025-02-27T19:34:35.7312170Z 
2025-02-27T19:34:35.7313045Z       at ProgressionManager.checkRequirements (src/managers/progression/ProgressionManager.ts:117:15)
2025-02-27T19:34:35.7314526Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:83:22)
2025-02-27T19:34:35.7315475Z 
2025-02-27T19:34:35.7315745Z     console.error
2025-02-27T19:34:35.7316839Z       Error completing milestone milestone1: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:34:35.7318693Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:34:35.7320695Z           at ProgressionManager.completeMilestone (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:348:12)
2025-02-27T19:34:35.7322696Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:145:22)
2025-02-27T19:34:35.7324451Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:35.7325867Z           at new Promise (<anonymous>)
2025-02-27T19:34:35.7327323Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:35.7328869Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:35.7330091Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:35.7460860Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:35.7462646Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:35.7464117Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7465806Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7467372Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:35.7469041Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:35.7471073Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:35.7472614Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:35.7473965Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:35.7475501Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:35.7476224Z 
2025-02-27T19:34:35.7476765Z     [0m [90m 379 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:35.7477546Z      [90m 380 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:35.7478887Z     [31m[1m>[22m[39m[90m 381 |[39m       console[33m.[39merror([32m`Error completing milestone ${milestoneId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:35.7480058Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:35.7480820Z      [90m 382 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7481448Z      [90m 383 |[39m     }
2025-02-27T19:34:35.7481921Z      [90m 384 |[39m   }[0m
2025-02-27T19:34:35.7482192Z 
2025-02-27T19:34:35.7482855Z       at ProgressionManager.completeMilestone (src/managers/progression/ProgressionManager.ts:381:15)
2025-02-27T19:34:35.7484092Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:145:22)
2025-02-27T19:34:35.7484690Z 
2025-02-27T19:34:35.7484846Z     console.error
2025-02-27T19:34:35.7485950Z       Error completing milestone milestone1: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:34:35.7487623Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:34:35.7489519Z           at ProgressionManager.completeMilestone (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:348:12)
2025-02-27T19:34:35.7491282Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:165:22)
2025-02-27T19:34:35.7492809Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:35.7493746Z           at new Promise (<anonymous>)
2025-02-27T19:34:35.7494740Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:35.7496272Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:35.7497414Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:35.7498501Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:35.7499865Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:35.7501323Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7503022Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7504277Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:35.7506225Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:35.7508512Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:35.7510101Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:35.7511441Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:35.7512777Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:35.7513516Z 
2025-02-27T19:34:35.7514028Z     [0m [90m 379 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:35.7514777Z      [90m 380 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:35.7516410Z     [31m[1m>[22m[39m[90m 381 |[39m       console[33m.[39merror([32m`Error completing milestone ${milestoneId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:35.7517583Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:35.7518343Z      [90m 382 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7518950Z      [90m 383 |[39m     }
2025-02-27T19:34:35.7519416Z      [90m 384 |[39m   }[0m
2025-02-27T19:34:35.7519683Z 
2025-02-27T19:34:35.7520323Z       at ProgressionManager.completeMilestone (src/managers/progression/ProgressionManager.ts:381:15)
2025-02-27T19:34:35.7521563Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:165:22)
2025-02-27T19:34:35.7522174Z 
2025-02-27T19:34:35.7522317Z     console.error
2025-02-27T19:34:35.7523237Z       Error unlocking achievement achievement1: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:34:35.7524903Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:34:35.7527058Z           at ProgressionManager.unlockAchievement (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:518:12)
2025-02-27T19:34:35.7528819Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:186:22)
2025-02-27T19:34:35.7530350Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:35.7531280Z           at new Promise (<anonymous>)
2025-02-27T19:34:35.7532291Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:35.7533658Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:35.7534799Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:35.7536093Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:35.7537478Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:35.7538990Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7540448Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7541732Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:35.7543673Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:35.7595971Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:35.7597868Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:35.7599220Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:35.7600570Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:35.7601316Z 
2025-02-27T19:34:35.7601835Z     [0m [90m 534 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:35.7602627Z      [90m 535 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:35.7603964Z     [31m[1m>[22m[39m[90m 536 |[39m       console[33m.[39merror([32m`Error unlocking achievement ${achievementId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:35.7605340Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:35.7606147Z      [90m 537 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7606775Z      [90m 538 |[39m     }
2025-02-27T19:34:35.7607260Z      [90m 539 |[39m   }[0m
2025-02-27T19:34:35.7607531Z 
2025-02-27T19:34:35.7608194Z       at ProgressionManager.unlockAchievement (src/managers/progression/ProgressionManager.ts:536:15)
2025-02-27T19:34:35.7609427Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:186:22)
2025-02-27T19:34:35.7610024Z 
2025-02-27T19:34:35.7610187Z     console.error
2025-02-27T19:34:35.7611118Z       Error unlocking achievement achievement1: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:34:35.7612814Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:34:35.7614677Z           at ProgressionManager.unlockAchievement (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:518:12)
2025-02-27T19:34:35.7616621Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:206:22)
2025-02-27T19:34:35.7618192Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:35.7619147Z           at new Promise (<anonymous>)
2025-02-27T19:34:35.7620109Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:35.7621443Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:35.7622521Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:35.7623610Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:35.7624927Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:35.7686629Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7688077Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7689317Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:35.7691049Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:35.7693321Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:35.7694798Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:35.7696316Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:35.7713790Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:35.7714552Z 
2025-02-27T19:34:35.7715064Z     [0m [90m 534 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:35.7716042Z      [90m 535 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:35.7717357Z     [31m[1m>[22m[39m[90m 536 |[39m       console[33m.[39merror([32m`Error unlocking achievement ${achievementId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:35.7718566Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:35.7719313Z      [90m 537 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7719903Z      [90m 538 |[39m     }
2025-02-27T19:34:35.7720380Z      [90m 539 |[39m   }[0m
2025-02-27T19:34:35.7720632Z 
2025-02-27T19:34:35.7721263Z       at ProgressionManager.unlockAchievement (src/managers/progression/ProgressionManager.ts:536:15)
2025-02-27T19:34:35.7722465Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:206:22)
2025-02-27T19:34:35.7723034Z 
2025-02-27T19:34:35.7723183Z     console.error
2025-02-27T19:34:35.7724134Z       Error checking if feature feature1 should be unlocked: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:34:35.7726554Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:34:35.7728503Z           at ProgressionManager.shouldFeatureBeUnlocked (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:682:12)
2025-02-27T19:34:35.7730264Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:290:22)
2025-02-27T19:34:35.7731781Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:35.7732779Z           at new Promise (<anonymous>)
2025-02-27T19:34:35.7733753Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:35.7735313Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:35.7736404Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:35.7737515Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:35.7738867Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:35.7740340Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7741840Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7743121Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:35.7744860Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:35.7747094Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:35.7748956Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:35.7750321Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:35.7751661Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:35.7752725Z 
2025-02-27T19:34:35.7753230Z     [0m [90m 693 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7753929Z      [90m 694 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:35.7755520Z     [31m[1m>[22m[39m[90m 695 |[39m       console[33m.[39merror([32m`Error checking if feature ${featureId} should be unlocked:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:35.7756723Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:35.7757470Z      [90m 696 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7758105Z      [90m 697 |[39m     }
2025-02-27T19:34:35.7758544Z      [90m 698 |[39m   }[0m
2025-02-27T19:34:35.7758814Z 
2025-02-27T19:34:35.7759529Z       at ProgressionManager.shouldFeatureBeUnlocked (src/managers/progression/ProgressionManager.ts:695:15)
2025-02-27T19:34:35.7760799Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:290:22)
2025-02-27T19:34:35.7761420Z 
2025-02-27T19:34:35.7761563Z     console.error
2025-02-27T19:34:35.7762531Z       Error checking if feature feature1 should be unlocked: Error: ProgressionManager not properly initialized with Redux store
2025-02-27T19:34:35.7764262Z           at ProgressionManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:89:13)
2025-02-27T19:34:35.7766400Z           at ProgressionManager.shouldFeatureBeUnlocked (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:682:12)
2025-02-27T19:34:35.7768223Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.test.ts:306:22)
2025-02-27T19:34:35.7769815Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:35.7770799Z           at new Promise (<anonymous>)
2025-02-27T19:34:35.7771802Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:35.7773202Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:35.7774346Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:35.7775651Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:35.7777037Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:35.7778573Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7780065Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:35.7781375Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:35.7783091Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:35.7785079Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:35.7786854Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:35.7788194Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:35.7789722Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:35.7790448Z 
2025-02-27T19:34:35.7790954Z     [0m [90m 693 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7791742Z      [90m 694 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:35.7793452Z     [31m[1m>[22m[39m[90m 695 |[39m       console[33m.[39merror([32m`Error checking if feature ${featureId} should be unlocked:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:35.7794671Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:35.7795684Z      [90m 696 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:35.7796429Z      [90m 697 |[39m     }
2025-02-27T19:34:35.7796843Z      [90m 698 |[39m   }[0m
2025-02-27T19:34:35.7797106Z 
2025-02-27T19:34:35.7797821Z       at ProgressionManager.shouldFeatureBeUnlocked (src/managers/progression/ProgressionManager.ts:695:15)
2025-02-27T19:34:35.7799097Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:306:22)
2025-02-27T19:34:35.7799696Z 
2025-02-27T19:34:35.7800432Z   ● ProgressionManager › checkRequirements › should return true when all requirements are met
2025-02-27T19:34:35.7801088Z 
2025-02-27T19:34:35.7801407Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:35.7801819Z 
2025-02-27T19:34:35.7801960Z     Expected: true
2025-02-27T19:34:35.7802292Z     Received: false
2025-02-27T19:34:35.7802498Z 
2025-02-27T19:34:35.7802796Z     [0m [90m 49 |[39m       ][33m;[39m
2025-02-27T19:34:35.7803298Z      [90m 50 |[39m
2025-02-27T19:34:35.7804463Z     [31m[1m>[22m[39m[90m 51 |[39m       expect(manager[33m.[39mcheckRequirements(requirements))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:35.7805894Z      [90m    |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:34:35.7806960Z      [90m 52 |[39m       expect(mockEvaluate)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)[33m;[39m
2025-02-27T19:34:35.7807864Z      [90m 53 |[39m     })[33m;[39m
2025-02-27T19:34:35.7808426Z      [90m 54 |[39m[0m
2025-02-27T19:34:35.7808670Z 
2025-02-27T19:34:35.7809186Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:51:55)
2025-02-27T19:34:35.7809783Z 
2025-02-27T19:34:35.7810514Z   ● ProgressionManager › checkRequirements › should return false if any requirement is not met
2025-02-27T19:34:35.7811139Z 
2025-02-27T19:34:35.7811445Z     expect(jest.fn()).toHaveBeenCalledTimes(expected)
2025-02-27T19:34:35.7811837Z 
2025-02-27T19:34:35.7812032Z     Expected number of calls: 2
2025-02-27T19:34:35.7812482Z     Received number of calls: 0
2025-02-27T19:34:35.7812743Z 
2025-02-27T19:34:35.7812970Z     [0m [90m 76 |[39m
2025-02-27T19:34:35.7814004Z      [90m 77 |[39m       expect(manager[33m.[39mcheckRequirements(requirements))[33m.[39mtoBe([36mfalse[39m)[33m;[39m
2025-02-27T19:34:35.7845802Z     [31m[1m>[22m[39m[90m 78 |[39m       expect(mockEvaluate)[33m.[39mtoHaveBeenCalledTimes([35m2[39m)[33m;[39m
2025-02-27T19:34:35.7846909Z      [90m    |[39m                            [31m[1m^[22m[39m
2025-02-27T19:34:35.7847526Z      [90m 79 |[39m     })[33m;[39m
2025-02-27T19:34:35.7847994Z      [90m 80 |[39m
2025-02-27T19:34:35.7848903Z      [90m 81 |[39m     it([32m'should handle empty requirements array'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:34:35.7849476Z 
2025-02-27T19:34:35.7849996Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:78:28)
2025-02-27T19:34:35.7850560Z 
2025-02-27T19:34:35.7851218Z   ● ProgressionManager › evaluateRequirement › should correctly evaluate gameStage requirement
2025-02-27T19:34:35.7851857Z 
2025-02-27T19:34:35.7852177Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:35.7852932Z 
2025-02-27T19:34:35.7853081Z     Expected: true
2025-02-27T19:34:35.7853427Z     Received: false
2025-02-27T19:34:35.7853635Z 
2025-02-27T19:34:35.7853875Z     [0m [90m 116 |[39m
2025-02-27T19:34:35.7854598Z      [90m 117 |[39m       [90m// Use the private method for testing[39m
2025-02-27T19:34:35.7856316Z     [31m[1m>[22m[39m[90m 118 |[39m       expect((manager [36mas[39m any)[33m.[39mevaluateRequirement(requirement))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:35.7857935Z      [90m     |[39m                                                                 [31m[1m^[22m[39m
2025-02-27T19:34:35.7858572Z      [90m 119 |[39m     })[33m;[39m
2025-02-27T19:34:35.7859003Z      [90m 120 |[39m
2025-02-27T19:34:35.7859956Z      [90m 121 |[39m     it([32m'should handle unknown requirement types'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:34:35.7860574Z 
2025-02-27T19:34:35.7861108Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:118:65)
2025-02-27T19:34:35.7861741Z 
2025-02-27T19:34:35.7862577Z   ● ProgressionManager › completeMilestone › should complete a milestone when requirements are met
2025-02-27T19:34:35.7863260Z 
2025-02-27T19:34:35.7863572Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:35.7863962Z 
2025-02-27T19:34:35.7864114Z     Expected: true
2025-02-27T19:34:35.7864424Z     Received: false
2025-02-27T19:34:35.7864650Z 
2025-02-27T19:34:35.7864877Z     [0m [90m 143 |[39m
2025-02-27T19:34:35.7865698Z      [90m 144 |[39m       [90m// Complete the milestone[39m
2025-02-27T19:34:35.7867031Z     [31m[1m>[22m[39m[90m 145 |[39m       expect(manager[33m.[39mcompleteMilestone([32m'milestone1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:35.7868267Z      [90m     |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:34:35.7869211Z      [90m 146 |[39m       expect(completeMilestone)[33m.[39mtoHaveBeenCalledWith({
2025-02-27T19:34:35.7870150Z      [90m 147 |[39m         id[33m:[39m [32m'milestone1'[39m[33m,[39m
2025-02-27T19:34:35.7870935Z      [90m 148 |[39m         completedAt[33m:[39m [35m1000[39m[0m
2025-02-27T19:34:35.7871318Z 
2025-02-27T19:34:35.7871796Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:145:55)
2025-02-27T19:34:35.7872410Z 
2025-02-27T19:34:35.7873223Z   ● ProgressionManager › completeMilestone › should not complete a milestone that is already completed
2025-02-27T19:34:35.7873907Z 
2025-02-27T19:34:35.7874208Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:35.7874603Z 
2025-02-27T19:34:35.7874748Z     Expected: true
2025-02-27T19:34:35.7886132Z     Received: false
2025-02-27T19:34:35.7886429Z 
2025-02-27T19:34:35.7886966Z     [0m [90m 163 |[39m       [90m// Attempt to complete the milestone[39m
2025-02-27T19:34:35.7888096Z      [90m 164 |[39m       [90m// The implementation now returns true regardless of completion status[39m
2025-02-27T19:34:35.7889743Z     [31m[1m>[22m[39m[90m 165 |[39m       expect(manager[33m.[39mcompleteMilestone([32m'milestone1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:35.7891028Z      [90m     |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:34:35.7892270Z      [90m 166 |[39m       [90m// The implementation now calls completeMilestone even for already completed milestones[39m
2025-02-27T19:34:35.7893623Z      [90m 167 |[39m       expect(completeMilestone)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:34:35.7894470Z      [90m 168 |[39m     })[33m;[39m[0m
2025-02-27T19:34:35.7894777Z 
2025-02-27T19:34:35.7895497Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:165:55)
2025-02-27T19:34:35.7896092Z 
2025-02-27T19:34:35.7896916Z   ● ProgressionManager › unlockAchievement › should unlock an achievement when requirements are met
2025-02-27T19:34:35.7897574Z 
2025-02-27T19:34:35.7898189Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:35.7898582Z 
2025-02-27T19:34:35.7898722Z     Expected: true
2025-02-27T19:34:35.7899074Z     Received: false
2025-02-27T19:34:35.7899295Z 
2025-02-27T19:34:35.7899541Z     [0m [90m 184 |[39m
2025-02-27T19:34:35.7900183Z      [90m 185 |[39m       [90m// Unlock the achievement[39m
2025-02-27T19:34:35.7901541Z     [31m[1m>[22m[39m[90m 186 |[39m       expect(manager[33m.[39munlockAchievement([32m'achievement1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:35.7903168Z      [90m     |[39m                                                         [31m[1m^[22m[39m
2025-02-27T19:34:35.7904107Z      [90m 187 |[39m       expect(unlockAchievement)[33m.[39mtoHaveBeenCalledWith({
2025-02-27T19:34:35.7905313Z      [90m 188 |[39m         id[33m:[39m [32m'achievement1'[39m[33m,[39m
2025-02-27T19:34:35.7906206Z      [90m 189 |[39m         unlockedAt[33m:[39m [35m1000[39m[0m
2025-02-27T19:34:35.7906620Z 
2025-02-27T19:34:35.7907222Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:186:57)
2025-02-27T19:34:35.7907832Z 
2025-02-27T19:34:35.7908694Z   ● ProgressionManager › unlockAchievement › should not unlock an achievement that is already unlocked
2025-02-27T19:34:35.7909388Z 
2025-02-27T19:34:35.7909704Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:35.7910080Z 
2025-02-27T19:34:35.7910227Z     Expected: true
2025-02-27T19:34:35.7910563Z     Received: false
2025-02-27T19:34:35.7910784Z 
2025-02-27T19:34:35.7911291Z     [0m [90m 204 |[39m       [90m// Attempt to unlock the achievement[39m
2025-02-27T19:34:35.7912408Z      [90m 205 |[39m       [90m// The implementation now returns true regardless of unlock status[39m
2025-02-27T19:34:35.7913977Z     [31m[1m>[22m[39m[90m 206 |[39m       expect(manager[33m.[39munlockAchievement([32m'achievement1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:35.7915472Z      [90m     |[39m                                                         [31m[1m^[22m[39m
2025-02-27T19:34:35.7916756Z      [90m 207 |[39m       [90m// The implementation now calls unlockAchievement even for already unlocked achievements[39m
2025-02-27T19:34:35.7918097Z      [90m 208 |[39m       expect(unlockAchievement)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:34:35.7918912Z      [90m 209 |[39m     })[33m;[39m[0m
2025-02-27T19:34:35.7919221Z 
2025-02-27T19:34:35.7919713Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:206:57)
2025-02-27T19:34:35.7920310Z 
2025-02-27T19:34:35.7921189Z   ● ProgressionManager › shouldFeatureBeUnlocked › should return true if a completed milestone unlocks the feature
2025-02-27T19:34:35.7921947Z 
2025-02-27T19:34:35.7922257Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:35.7922653Z 
2025-02-27T19:34:35.7922798Z     Expected: true
2025-02-27T19:34:35.7923139Z     Received: false
2025-02-27T19:34:35.7923361Z 
2025-02-27T19:34:35.7923658Z     [0m [90m 288 |[39m       
2025-02-27T19:34:35.7924386Z      [90m 289 |[39m       [90m// Check if feature should be unlocked[39m
2025-02-27T19:34:35.7926049Z     [31m[1m>[22m[39m[90m 290 |[39m       expect(manager[33m.[39mshouldFeatureBeUnlocked([32m'feature1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:35.7927394Z      [90m     |[39m                                                           [31m[1m^[22m[39m
2025-02-27T19:34:35.7928075Z      [90m 291 |[39m     })[33m;[39m
2025-02-27T19:34:35.7928561Z      [90m 292 |[39m
2025-02-27T19:34:35.7929659Z      [90m 293 |[39m     it([32m'should return false if no completed milestone unlocks the feature'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:34:35.7930376Z 
2025-02-27T19:34:35.7930903Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:290:59)
2025-02-27T19:34:35.7931473Z 
2025-02-27T19:34:36.7106947Z FAIL src/systems/__tests__/buildingManager.test.ts
2025-02-27T19:34:36.7108893Z   ● BuildingManager › initialization › should initialize a building
2025-02-27T19:34:36.7109583Z 
2025-02-27T19:34:36.7110057Z     TypeError: this.actions.addStructure is not a function
2025-02-27T19:34:36.7110602Z 
2025-02-27T19:34:36.7111002Z     [0m [90m 139 |[39m     }
2025-02-27T19:34:36.7111590Z      [90m 140 |[39m     
2025-02-27T19:34:36.7113102Z     [31m[1m>[22m[39m[90m 141 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddStructure(building))[33m;[39m
2025-02-27T19:34:36.7114321Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:34:36.7114993Z      [90m 142 |[39m   }
2025-02-27T19:34:36.7115791Z      [90m 143 |[39m   
2025-02-27T19:34:36.7116438Z      [90m 144 |[39m   [90m/**[39m[0m
2025-02-27T19:34:36.7116878Z 
2025-02-27T19:34:36.7117449Z       at BuildingManager.initializeBuilding (src/systems/buildingManager.ts:141:32)
2025-02-27T19:34:36.7118529Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:73:23)
2025-02-27T19:34:36.7119197Z 
2025-02-27T19:34:36.7119883Z   ● BuildingManager › initialization › should initialize multiple buildings
2025-02-27T19:34:36.7120521Z 
2025-02-27T19:34:36.7120920Z     TypeError: this.actions.addStructure is not a function
2025-02-27T19:34:36.7121415Z 
2025-02-27T19:34:36.7121752Z     [0m [90m 139 |[39m     }
2025-02-27T19:34:36.7122294Z      [90m 140 |[39m     
2025-02-27T19:34:36.7123523Z     [31m[1m>[22m[39m[90m 141 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddStructure(building))[33m;[39m
2025-02-27T19:34:36.7124710Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:34:36.7125668Z      [90m 142 |[39m   }
2025-02-27T19:34:36.7126194Z      [90m 143 |[39m   
2025-02-27T19:34:36.7126898Z      [90m 144 |[39m   [90m/**[39m[0m
2025-02-27T19:34:36.7127341Z 
2025-02-27T19:34:36.7127936Z       at BuildingManager.initializeBuilding (src/systems/buildingManager.ts:141:32)
2025-02-27T19:34:36.7128802Z       at src/systems/buildingManager.ts:153:40
2025-02-27T19:34:36.7129418Z           at Array.forEach (<anonymous>)
2025-02-27T19:34:36.7130348Z       at BuildingManager.initializeBuildings (src/systems/buildingManager.ts:153:15)
2025-02-27T19:34:36.7131449Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:108:23)
2025-02-27T19:34:36.7132053Z 
2025-02-27T19:34:36.7132867Z   ● BuildingManager › purchase validation › should correctly validate if player can afford a building
2025-02-27T19:34:36.7133589Z 
2025-02-27T19:34:36.7134075Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:34:36.7134665Z 
2025-02-27T19:34:36.7134989Z     [0m [90m 165 |[39m     
2025-02-27T19:34:36.7136163Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:36.7137542Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:36.7138649Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:36.7139290Z      [90m 168 |[39m     
2025-02-27T19:34:36.7140179Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:34:36.7141415Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:34:36.7142279Z 
2025-02-27T19:34:36.7143002Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:34:36.7145025Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:160:39)
2025-02-27T19:34:36.7146165Z 
2025-02-27T19:34:36.7147868Z   ● BuildingManager › purchase validation › should return false for non-existent buildings
2025-02-27T19:34:36.7148871Z 
2025-02-27T19:34:36.7150324Z     TypeError: Cannot read properties of undefined (reading 'non_existent')
2025-02-27T19:34:36.7151211Z 
2025-02-27T19:34:36.7152215Z     [0m [90m 165 |[39m     
2025-02-27T19:34:36.7153420Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:36.7166877Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:36.7168475Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:36.7169648Z      [90m 168 |[39m     
2025-02-27T19:34:36.7170810Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:34:36.7172591Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:34:36.7173389Z 
2025-02-27T19:34:36.7174448Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:34:36.7175916Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:193:38)
2025-02-27T19:34:36.7177021Z 
2025-02-27T19:34:36.7177873Z   ● BuildingManager › purchase validation › should return false for locked buildings
2025-02-27T19:34:36.7178965Z 
2025-02-27T19:34:36.7179591Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:34:36.7180649Z 
2025-02-27T19:34:36.7181130Z     [0m [90m 165 |[39m     
2025-02-27T19:34:36.7182509Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:36.7183992Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:36.7185801Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:36.7186628Z      [90m 168 |[39m     
2025-02-27T19:34:36.7188118Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:34:36.7189705Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:34:36.7191027Z 
2025-02-27T19:34:36.7191845Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:34:36.7193643Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:226:38)
2025-02-27T19:34:36.7194638Z 
2025-02-27T19:34:36.7196109Z   ● BuildingManager › purchasing › should purchase a building and deduct resources
2025-02-27T19:34:36.7197302Z 
2025-02-27T19:34:36.7197797Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:34:36.7198311Z 
2025-02-27T19:34:36.7198603Z     [0m [90m 197 |[39m     
2025-02-27T19:34:36.7199444Z      [90m 198 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:36.7200661Z     [31m[1m>[22m[39m[90m 199 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:36.7201632Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:36.7202143Z      [90m 200 |[39m     
2025-02-27T19:34:36.7202687Z      [90m 201 |[39m     [90m// Deduct resources[39m
2025-02-27T19:34:36.7203975Z      [90m 202 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mdeductResources(building[33m.[39mcost))[33m;[39m[0m
2025-02-27T19:34:36.7204769Z 
2025-02-27T19:34:36.7205401Z       at BuildingManager.purchaseBuilding (src/systems/buildingManager.ts:199:38)
2025-02-27T19:34:36.7206359Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:273:38)
2025-02-27T19:34:36.7206865Z 
2025-02-27T19:34:36.7207677Z   ● BuildingManager › production calculation › should correctly calculate production based on level and workers
2025-02-27T19:34:36.7208389Z 
2025-02-27T19:34:36.7209069Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:34:36.7209552Z 
2025-02-27T19:34:36.7209803Z     [0m [90m 222 |[39m     
2025-02-27T19:34:36.7210628Z      [90m 223 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:36.7211847Z     [31m[1m>[22m[39m[90m 224 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:36.7212993Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:36.7213538Z      [90m 225 |[39m     
2025-02-27T19:34:36.7214104Z      [90m 226 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:36.7214771Z      [90m 227 |[39m       [36mreturn[39m[33m;[39m[0m
2025-02-27T19:34:36.7215267Z 
2025-02-27T19:34:36.7215724Z       at BuildingManager.recalculateProduction (src/systems/buildingManager.ts:224:38)
2025-02-27T19:34:36.7216599Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:329:23)
2025-02-27T19:34:36.7217054Z 
2025-02-27T19:34:37.0117822Z PASS src/state/tasksSlice.test.ts
2025-02-27T19:34:37.6006482Z FAIL src/systems/__tests__/saveManager.test.ts
2025-02-27T19:34:37.6057252Z   ● Console
2025-02-27T19:34:37.6061454Z 
2025-02-27T19:34:37.6064705Z     console.error
2025-02-27T19:34:37.6069216Z       [ERROR in SaveManager.loadGame]: this.actions.resetGame is not a function undefined
2025-02-27T19:34:37.6073284Z 
2025-02-27T19:34:37.6078103Z     [0m [90m 135 |[39m       console[33m.[39merror([32m`[CRITICAL${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:34:37.6083862Z      [90m 136 |[39m     } [36melse[39m [36mif[39m (severity [33m===[39m [33mErrorSeverity[39m[33m.[39m[33mERROR[39m) {
2025-02-27T19:34:37.6088027Z     [31m[1m>[22m[39m[90m 137 |[39m       console[33m.[39merror([32m`[ERROR${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:34:37.6090515Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:37.6096741Z      [90m 138 |[39m     }
2025-02-27T19:34:37.6099494Z      [90m 139 |[39m     
2025-02-27T19:34:37.6102411Z      [90m 140 |[39m     [90m// Skip logging INFO and WARNING to console[39m[0m
2025-02-27T19:34:37.6109459Z 
2025-02-27T19:34:37.6109855Z       at ErrorLogger.logError (src/utils/errorUtils.ts:137:15)
2025-02-27T19:34:37.6110599Z       at SaveManager.loadGame (src/systems/saveManager.ts:205:19)
2025-02-27T19:34:37.6111391Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:177:34)
2025-02-27T19:34:37.6111855Z 
2025-02-27T19:34:37.6111992Z     console.error
2025-02-27T19:34:37.6113889Z       [ERROR in SaveManager.deleteSaveAndReset]: this.actions.resetGame is not a function undefined
2025-02-27T19:34:37.6115757Z 
2025-02-27T19:34:37.6117555Z     [0m [90m 135 |[39m       console[33m.[39merror([32m`[CRITICAL${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:34:37.6119670Z      [90m 136 |[39m     } [36melse[39m [36mif[39m (severity [33m===[39m [33mErrorSeverity[39m[33m.[39m[33mERROR[39m) {
2025-02-27T19:34:37.6122767Z     [31m[1m>[22m[39m[90m 137 |[39m       console[33m.[39merror([32m`[ERROR${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:34:37.6126104Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:37.6127928Z      [90m 138 |[39m     }
2025-02-27T19:34:37.6128706Z      [90m 139 |[39m     
2025-02-27T19:34:37.6129969Z      [90m 140 |[39m     [90m// Skip logging INFO and WARNING to console[39m[0m
2025-02-27T19:34:37.6131841Z 
2025-02-27T19:34:37.6141706Z       at ErrorLogger.logError (src/utils/errorUtils.ts:137:15)
2025-02-27T19:34:37.6142772Z       at SaveManager.deleteSaveAndReset (src/systems/saveManager.ts:237:19)
2025-02-27T19:34:37.6144279Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:264:34)
2025-02-27T19:34:37.6145554Z 
2025-02-27T19:34:37.6148067Z   ● SaveManager › loadGame › should dispatch actions to restore game state
2025-02-27T19:34:37.6148849Z 
2025-02-27T19:34:37.6149910Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:37.6150521Z 
2025-02-27T19:34:37.6151184Z     Expected: true
2025-02-27T19:34:37.6151710Z     Received: false
2025-02-27T19:34:37.6152700Z 
2025-02-27T19:34:37.6153458Z     [0m [90m 178 |[39m       
2025-02-27T19:34:37.6154440Z      [90m 179 |[39m       [90m// Assert[39m
2025-02-27T19:34:37.6155729Z     [31m[1m>[22m[39m[90m 180 |[39m       expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:37.6156883Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:34:37.6157480Z      [90m 181 |[39m       
2025-02-27T19:34:37.6158185Z      [90m 182 |[39m       [90m// Verify reset actions were dispatched[39m
2025-02-27T19:34:37.6159379Z      [90m 183 |[39m       expect(mockDispatch)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[0m
2025-02-27T19:34:37.6160103Z 
2025-02-27T19:34:37.6160560Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:180:22)
2025-02-27T19:34:37.6161050Z 
2025-02-27T19:34:37.6161630Z   ● SaveManager › resetGame › should dispatch reset actions for all state slices
2025-02-27T19:34:37.6162166Z 
2025-02-27T19:34:37.6162458Z     TypeError: this.actions.resetGame is not a function
2025-02-27T19:34:37.6162837Z 
2025-02-27T19:34:37.6163396Z     [0m [90m 217 |[39m     [36mthis[39m[33m.[39mensureInitialized()[33m;[39m
2025-02-27T19:34:37.6164013Z      [90m 218 |[39m     
2025-02-27T19:34:37.6165077Z     [31m[1m>[22m[39m[90m 219 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetGame())[33m;[39m
2025-02-27T19:34:37.6166353Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:34:37.6167534Z      [90m 220 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetResources())[33m;[39m
2025-02-27T19:34:37.6168933Z      [90m 221 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetStructures())[33m;[39m
2025-02-27T19:34:37.6169774Z      [90m 222 |[39m   }[0m
2025-02-27T19:34:37.6170040Z 
2025-02-27T19:34:37.6170398Z       at SaveManager.resetGame (src/systems/saveManager.ts:219:32)
2025-02-27T19:34:37.6171271Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:243:19)
2025-02-27T19:34:37.6171751Z 
2025-02-27T19:34:37.6172356Z   ● SaveManager › deleteSaveAndReset › should delete the save and reset the game
2025-02-27T19:34:37.6172858Z 
2025-02-27T19:34:37.6173140Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:37.6173508Z 
2025-02-27T19:34:37.6173646Z     Expected: true
2025-02-27T19:34:37.6173975Z     Received: false
2025-02-27T19:34:37.6174199Z 
2025-02-27T19:34:37.6174477Z     [0m [90m 265 |[39m       
2025-02-27T19:34:37.6175035Z      [90m 266 |[39m       [90m// Assert[39m
2025-02-27T19:34:37.6176123Z     [31m[1m>[22m[39m[90m 267 |[39m       expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:37.6176962Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:34:37.6177950Z      [90m 268 |[39m       expect(saveUtils[33m.[39mdeleteSave)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:34:37.6179217Z      [90m 269 |[39m       expect(mockDispatch)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({
2025-02-27T19:34:37.6180471Z      [90m 270 |[39m         type[33m:[39m expect[33m.[39mstringContaining([32m'game/resetGame'[39m)[0m
2025-02-27T19:34:37.6181016Z 
2025-02-27T19:34:37.6181432Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:267:22)
2025-02-27T19:34:37.6181922Z 
2025-02-27T19:34:38.2966224Z PASS src/utils/resourceUtils.test.ts
2025-02-27T19:34:38.3233203Z PASS src/core/GameLoop.test.ts
2025-02-27T19:34:38.3306015Z   ● Console
2025-02-27T19:34:38.3308915Z 
2025-02-27T19:34:38.3309410Z     console.log
2025-02-27T19:34:38.3310335Z       GameLoop: Registered handler, total: 1
2025-02-27T19:34:38.3310934Z 
2025-02-27T19:34:38.3311355Z       at GameLoop.registerHandler (src/core/GameLoop.ts:290:17)
2025-02-27T19:34:38.3312262Z 
2025-02-27T19:34:38.3312415Z     console.log
2025-02-27T19:34:38.3312833Z       GameLoop: Started with tick rate 1Hz
2025-02-27T19:34:38.3313134Z 
2025-02-27T19:34:38.3313423Z       at GameLoop.start (src/core/GameLoop.ts:119:15)
2025-02-27T19:34:38.3313795Z 
2025-02-27T19:34:38.3313931Z     console.log
2025-02-27T19:34:38.3314493Z       Warning not called, but this is acceptable in the mock environment
2025-02-27T19:34:38.3314966Z 
2025-02-27T19:34:38.3315491Z       at Object.<anonymous> (src/core/GameLoop.test.ts:309:15)
2025-02-27T19:34:38.3315898Z 
2025-02-27T19:34:38.3316036Z     console.log
2025-02-27T19:34:38.3316506Z       GameLoop: Stopped after 2 ticks and 1 frames
2025-02-27T19:34:38.3316861Z 
2025-02-27T19:34:38.3317115Z       at GameLoop.stop (src/core/GameLoop.ts:137:15)
2025-02-27T19:34:38.3317463Z 
2025-02-27T19:34:38.3317597Z     console.log
2025-02-27T19:34:38.3318025Z       GameLoop: Unregistered handler, remaining: 0
2025-02-27T19:34:38.3318374Z 
2025-02-27T19:34:38.3318720Z       at GameLoop.unregisterHandler (src/core/GameLoop.ts:307:17)
2025-02-27T19:34:38.3319169Z 
2025-02-27T19:34:39.0006804Z FAIL src/integration/tasks.integration.test.ts
2025-02-27T19:34:39.1078092Z   ● Console
2025-02-27T19:34:39.1083992Z 
2025-02-27T19:34:39.1084480Z     console.log
2025-02-27T19:34:39.1090851Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:39.1091762Z 
2025-02-27T19:34:39.1092554Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:39.1093472Z 
2025-02-27T19:34:39.1093921Z     console.error
2025-02-27T19:34:39.1094980Z       Error starting task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1096690Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1098188Z           at TaskManager.startTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:263:12)
2025-02-27T19:34:39.1099665Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:151:32)
2025-02-27T19:34:39.1101253Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1102356Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1103502Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1105007Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1106504Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1107776Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1109306Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1111098Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1112695Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1114765Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1117516Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1119814Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1176575Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1178630Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1180330Z 
2025-02-27T19:34:39.1181234Z     [0m [90m 311 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1182036Z      [90m 312 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1183182Z     [31m[1m>[22m[39m[90m 313 |[39m       console[33m.[39merror([32m`Error starting task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1184145Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1184967Z      [90m 314 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1185843Z      [90m 315 |[39m     }
2025-02-27T19:34:39.1186279Z      [90m 316 |[39m   }[0m
2025-02-27T19:34:39.1186526Z 
2025-02-27T19:34:39.1186886Z       at TaskManager.startTask (src/managers/TaskManager.ts:313:15)
2025-02-27T19:34:39.1187812Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:151:32)
2025-02-27T19:34:39.1188306Z 
2025-02-27T19:34:39.1188450Z     console.error
2025-02-27T19:34:39.1189164Z       Error starting task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1190400Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1191679Z           at TaskManager.startTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:263:12)
2025-02-27T19:34:39.1192985Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:168:32)
2025-02-27T19:34:39.1194360Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1195422Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1196352Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1197612Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1198684Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1199721Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1200985Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1202392Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1203595Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1205383Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1267385Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1268923Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1270188Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1271460Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1272154Z 
2025-02-27T19:34:39.1272933Z     [0m [90m 311 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1273617Z      [90m 312 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1274741Z     [31m[1m>[22m[39m[90m 313 |[39m       console[33m.[39merror([32m`Error starting task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1275887Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1276973Z      [90m 314 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1277606Z      [90m 315 |[39m     }
2025-02-27T19:34:39.1278038Z      [90m 316 |[39m   }[0m
2025-02-27T19:34:39.1278301Z 
2025-02-27T19:34:39.1278658Z       at TaskManager.startTask (src/managers/TaskManager.ts:313:15)
2025-02-27T19:34:39.1279453Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:168:32)
2025-02-27T19:34:39.1279899Z 
2025-02-27T19:34:39.1280041Z     console.error
2025-02-27T19:34:39.1280754Z       Error starting task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1281983Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1283272Z           at TaskManager.startTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:263:12)
2025-02-27T19:34:39.1284531Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:178:32)
2025-02-27T19:34:39.1286020Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1286934Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1287903Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1289232Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1290225Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1291333Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1292514Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1293624Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1294623Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1296418Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1298110Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1299567Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1300762Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1302054Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1302784Z 
2025-02-27T19:34:39.1303292Z     [0m [90m 311 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1304013Z      [90m 312 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1305406Z     [31m[1m>[22m[39m[90m 313 |[39m       console[33m.[39merror([32m`Error starting task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1306381Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1307261Z      [90m 314 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1308264Z      [90m 315 |[39m     }
2025-02-27T19:34:39.1308714Z      [90m 316 |[39m   }[0m
2025-02-27T19:34:39.1308970Z 
2025-02-27T19:34:39.1309320Z       at TaskManager.startTask (src/managers/TaskManager.ts:313:15)
2025-02-27T19:34:39.1310187Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:178:32)
2025-02-27T19:34:39.1310967Z 
2025-02-27T19:34:39.1311120Z     console.error
2025-02-27T19:34:39.1311900Z       Error unlocking task locked-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1313229Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1314582Z           at TaskManager.unlockTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:417:12)
2025-02-27T19:34:39.1316121Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:188:32)
2025-02-27T19:34:39.1317495Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1318388Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1319317Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1320582Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1321631Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1322631Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1323878Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1325404Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1326621Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1328227Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1330111Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1331606Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1332839Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1334078Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1334751Z 
2025-02-27T19:34:39.1335398Z     [0m [90m 439 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1336085Z      [90m 440 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1337272Z     [31m[1m>[22m[39m[90m 441 |[39m       console[33m.[39merror([32m`Error unlocking task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1338229Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1339056Z      [90m 442 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1339682Z      [90m 443 |[39m     }
2025-02-27T19:34:39.1340095Z      [90m 444 |[39m   }[0m
2025-02-27T19:34:39.1340330Z 
2025-02-27T19:34:39.1340696Z       at TaskManager.unlockTask (src/managers/TaskManager.ts:441:15)
2025-02-27T19:34:39.1341509Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:188:32)
2025-02-27T19:34:39.1342001Z 
2025-02-27T19:34:39.1342128Z     console.error
2025-02-27T19:34:39.1342864Z       Error unlocking task locked-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1344380Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1345878Z           at TaskManager.unlockTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:417:12)
2025-02-27T19:34:39.1347185Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:203:32)
2025-02-27T19:34:39.1348895Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1349858Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1350825Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1352188Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1353333Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1354432Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1355980Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1357474Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1358751Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1360426Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1362306Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1363871Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1365363Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1366694Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1367421Z 
2025-02-27T19:34:39.1367913Z     [0m [90m 439 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1368668Z      [90m 440 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1369899Z     [31m[1m>[22m[39m[90m 441 |[39m       console[33m.[39merror([32m`Error unlocking task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1370944Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1371807Z      [90m 442 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1372478Z      [90m 443 |[39m     }
2025-02-27T19:34:39.1372879Z      [90m 444 |[39m   }[0m
2025-02-27T19:34:39.1373134Z 
2025-02-27T19:34:39.1373530Z       at TaskManager.unlockTask (src/managers/TaskManager.ts:441:15)
2025-02-27T19:34:39.1374371Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:203:32)
2025-02-27T19:34:39.1374882Z 
2025-02-27T19:34:39.1375025Z     console.error
2025-02-27T19:34:39.1375939Z       Error completing task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1377182Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1378488Z           at TaskManager.completeTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:325:12)
2025-02-27T19:34:39.1379816Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:214:32)
2025-02-27T19:34:39.1381410Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1382315Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1383246Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1384532Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1385972Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1387006Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1388307Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1389711Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1390947Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1392561Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1394414Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1396068Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1397308Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1398558Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1399243Z 
2025-02-27T19:34:39.1399715Z     [0m [90m 372 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1400392Z      [90m 373 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1401526Z     [31m[1m>[22m[39m[90m 374 |[39m       console[33m.[39merror([32m`Error completing task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1402490Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1403315Z      [90m 375 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1403943Z      [90m 376 |[39m     }
2025-02-27T19:34:39.1404346Z      [90m 377 |[39m   }[0m
2025-02-27T19:34:39.1404575Z 
2025-02-27T19:34:39.1404949Z       at TaskManager.completeTask (src/managers/TaskManager.ts:374:15)
2025-02-27T19:34:39.1406013Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:214:32)
2025-02-27T19:34:39.1406504Z 
2025-02-27T19:34:39.1406643Z     console.error
2025-02-27T19:34:39.1407372Z       Error completing task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1408608Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1409890Z           at TaskManager.completeTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:325:12)
2025-02-27T19:34:39.1411247Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:229:32)
2025-02-27T19:34:39.1412607Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1413505Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1414365Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1415870Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1417181Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1418192Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1419460Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1421109Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1422357Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1424028Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1426152Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1427663Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1428958Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1430222Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1430920Z 
2025-02-27T19:34:39.1431399Z     [0m [90m 372 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1432075Z      [90m 373 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1433248Z     [31m[1m>[22m[39m[90m 374 |[39m       console[33m.[39merror([32m`Error completing task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1434268Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1435320Z      [90m 375 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1435993Z      [90m 376 |[39m     }
2025-02-27T19:34:39.1436405Z      [90m 377 |[39m   }[0m
2025-02-27T19:34:39.1436691Z 
2025-02-27T19:34:39.1437082Z       at TaskManager.completeTask (src/managers/TaskManager.ts:374:15)
2025-02-27T19:34:39.1437930Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:229:32)
2025-02-27T19:34:39.1438407Z 
2025-02-27T19:34:39.1438535Z     console.error
2025-02-27T19:34:39.1439252Z       Error canceling task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1440498Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1441787Z           at TaskManager.cancelTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:386:12)
2025-02-27T19:34:39.1443082Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:240:32)
2025-02-27T19:34:39.1444460Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1445540Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1446456Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1447745Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1448824Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1449849Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1451133Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1452543Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1454000Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1455763Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1457708Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1459395Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1460640Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1461902Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1462588Z 
2025-02-27T19:34:39.1463040Z     [0m [90m 403 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1463728Z      [90m 404 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1464848Z     [31m[1m>[22m[39m[90m 405 |[39m       console[33m.[39merror([32m`Error canceling task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1465958Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1466803Z      [90m 406 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1467443Z      [90m 407 |[39m     }
2025-02-27T19:34:39.1467855Z      [90m 408 |[39m   }[0m
2025-02-27T19:34:39.1468092Z 
2025-02-27T19:34:39.1468460Z       at TaskManager.cancelTask (src/managers/TaskManager.ts:405:15)
2025-02-27T19:34:39.1469285Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:240:32)
2025-02-27T19:34:39.1469762Z 
2025-02-27T19:34:39.1469896Z     console.error
2025-02-27T19:34:39.1470638Z       Error checking task requirements: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1471898Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1473329Z           at TaskManager.checkAllTaskRequirements (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:452:12)
2025-02-27T19:34:39.1474772Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:271:34)
2025-02-27T19:34:39.1476355Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1477271Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1478192Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1479483Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1480556Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1481581Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1482865Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1484276Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1485677Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1487326Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1489225Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1490965Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1492204Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1493468Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1494405Z 
2025-02-27T19:34:39.1494842Z     [0m [90m 465 |[39m       [36mreturn[39m unlocked[33m;[39m
2025-02-27T19:34:39.1495738Z      [90m 466 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1496957Z     [31m[1m>[22m[39m[90m 467 |[39m       console[33m.[39merror([32m'Error checking task requirements:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1498006Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1498841Z      [90m 468 |[39m       [36mreturn[39m [35m0[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1499511Z      [90m 469 |[39m     }
2025-02-27T19:34:39.1499915Z      [90m 470 |[39m   }[0m
2025-02-27T19:34:39.1500155Z 
2025-02-27T19:34:39.1500621Z       at TaskManager.checkAllTaskRequirements (src/managers/TaskManager.ts:467:15)
2025-02-27T19:34:39.1501576Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:271:34)
2025-02-27T19:34:39.1502086Z 
2025-02-27T19:34:39.1502243Z     console.error
2025-02-27T19:34:39.1502976Z       Error starting task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1504215Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1505788Z           at TaskManager.startTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:263:12)
2025-02-27T19:34:39.1523573Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:306:17)
2025-02-27T19:34:39.1525065Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1526189Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1527108Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1528414Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1529495Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1530514Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1531762Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1533166Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1534385Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1536186Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1538148Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1539617Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1540862Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1542100Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1543012Z 
2025-02-27T19:34:39.1543492Z     [0m [90m 311 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1544174Z      [90m 312 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1545436Z     [31m[1m>[22m[39m[90m 313 |[39m       console[33m.[39merror([32m`Error starting task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1546367Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1547446Z      [90m 314 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1548070Z      [90m 315 |[39m     }
2025-02-27T19:34:39.1548473Z      [90m 316 |[39m   }[0m
2025-02-27T19:34:39.1548706Z 
2025-02-27T19:34:39.1549060Z       at TaskManager.startTask (src/managers/TaskManager.ts:313:15)
2025-02-27T19:34:39.1549858Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:306:17)
2025-02-27T19:34:39.1550354Z 
2025-02-27T19:34:39.1550496Z     console.error
2025-02-27T19:34:39.1551234Z       Error completing task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1552488Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1553790Z           at TaskManager.completeTask (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:325:12)
2025-02-27T19:34:39.1555269Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:313:17)
2025-02-27T19:34:39.1556646Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1557552Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1558475Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1559751Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1560828Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1561868Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1563165Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1564537Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1565869Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1567454Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1569293Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1570821Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1572105Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1573398Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1574131Z 
2025-02-27T19:34:39.1574629Z     [0m [90m 372 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.1575589Z      [90m 373 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1576809Z     [31m[1m>[22m[39m[90m 374 |[39m       console[33m.[39merror([32m`Error completing task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1577843Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1578694Z      [90m 375 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1579696Z      [90m 376 |[39m     }
2025-02-27T19:34:39.1580161Z      [90m 377 |[39m   }[0m
2025-02-27T19:34:39.1580418Z 
2025-02-27T19:34:39.1580820Z       at TaskManager.completeTask (src/managers/TaskManager.ts:374:15)
2025-02-27T19:34:39.1581705Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:313:17)
2025-02-27T19:34:39.1582459Z 
2025-02-27T19:34:39.1582620Z     console.error
2025-02-27T19:34:39.1583435Z       Error getting progress for task test-task: Error: TaskManager not properly initialized with Redux store
2025-02-27T19:34:39.1584787Z           at TaskManager.ensureInitialized (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:91:13)
2025-02-27T19:34:39.1586358Z           at TaskManager.getTaskProgress (/home/runner/work/idle-game/idle-game/src/managers/TaskManager.ts:500:12)
2025-02-27T19:34:39.1587763Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/integration/tasks.integration.test.ts:334:34)
2025-02-27T19:34:39.1589183Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.1590142Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.1591048Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.1592370Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.1593470Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.1594545Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.1596084Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.1597572Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.1598848Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.1600475Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.1602476Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.1603946Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.1605442Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.1606793Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.1607541Z 
2025-02-27T19:34:39.1607914Z     [0m [90m 519 |[39m       }[33m;[39m
2025-02-27T19:34:39.1608563Z      [90m 520 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:39.1609870Z     [31m[1m>[22m[39m[90m 521 |[39m       console[33m.[39merror([32m`Error getting progress for task ${taskId}:`[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.1610979Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.1611814Z      [90m 522 |[39m       [36mreturn[39m [36mnull[39m[33m;[39m [90m// Fail safe[39m
2025-02-27T19:34:39.1612509Z      [90m 523 |[39m     }
2025-02-27T19:34:39.1612963Z      [90m 524 |[39m   }[0m
2025-02-27T19:34:39.1613225Z 
2025-02-27T19:34:39.1613649Z       at TaskManager.getTaskProgress (src/managers/TaskManager.ts:521:15)
2025-02-27T19:34:39.1614548Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:334:34)
2025-02-27T19:34:39.1615043Z 
2025-02-27T19:34:39.1615813Z   ● Task System Integration › should start a task when requirements are met
2025-02-27T19:34:39.1616551Z 
2025-02-27T19:34:39.1616801Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:39.1617196Z 
2025-02-27T19:34:39.1617352Z     Expected: true
2025-02-27T19:34:39.1617689Z     Received: false
2025-02-27T19:34:39.1617898Z 
2025-02-27T19:34:39.1618745Z     [0m [90m 151 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mstartTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:39.1619884Z      [90m 152 |[39m     
2025-02-27T19:34:39.1620629Z     [31m[1m>[22m[39m[90m 153 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:39.1621428Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:34:39.1622300Z      [90m 154 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:39.1623202Z      [90m 155 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:39.1624118Z      [90m 156 |[39m         type[33m:[39m [32m'tasks/startTask'[39m[33m,[39m[0m
2025-02-27T19:34:39.1624592Z 
2025-02-27T19:34:39.1625019Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:153:20)
2025-02-27T19:34:39.1625693Z 
2025-02-27T19:34:39.1626198Z   ● Task System Integration › should check if task requirements are met
2025-02-27T19:34:39.1626611Z 
2025-02-27T19:34:39.1626865Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:39.1627227Z 
2025-02-27T19:34:39.1627348Z     Expected: true
2025-02-27T19:34:39.1627674Z     Received: false
2025-02-27T19:34:39.1627868Z 
2025-02-27T19:34:39.1628659Z     [0m [90m 188 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39munlockTask([32m'locked-task'[39m)[33m;[39m
2025-02-27T19:34:39.1629476Z      [90m 189 |[39m     
2025-02-27T19:34:39.1630248Z     [31m[1m>[22m[39m[90m 190 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:39.1631026Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:34:39.1631864Z      [90m 191 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:39.1632678Z      [90m 192 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:39.1633480Z      [90m 193 |[39m         type[33m:[39m [32m'tasks/unlockTask'[39m[33m,[39m[0m
2025-02-27T19:34:39.1633892Z 
2025-02-27T19:34:39.1634299Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:190:20)
2025-02-27T19:34:39.1634783Z 
2025-02-27T19:34:39.1635368Z   ● Task System Integration › should complete an in-progress task
2025-02-27T19:34:39.1635781Z 
2025-02-27T19:34:39.1636064Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:39.1636435Z 
2025-02-27T19:34:39.1636608Z     Expected: true
2025-02-27T19:34:39.1637217Z     Received: false
2025-02-27T19:34:39.1637423Z 
2025-02-27T19:34:39.1638397Z     [0m [90m 214 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mcompleteTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:39.1639380Z      [90m 215 |[39m     
2025-02-27T19:34:39.1640458Z     [31m[1m>[22m[39m[90m 216 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:39.1641411Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:34:39.1642492Z      [90m 217 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:39.1643416Z      [90m 218 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:39.1644300Z      [90m 219 |[39m         type[33m:[39m [32m'tasks/completeTask'[39m[33m,[39m[0m
2025-02-27T19:34:39.1644860Z 
2025-02-27T19:34:39.1645465Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:216:20)
2025-02-27T19:34:39.1645922Z 
2025-02-27T19:34:39.1646583Z   ● Task System Integration › should cancel an in-progress task
2025-02-27T19:34:39.1647191Z 
2025-02-27T19:34:39.1647472Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:39.1648297Z 
2025-02-27T19:34:39.1648439Z     Expected: true
2025-02-27T19:34:39.1648990Z     Received: false
2025-02-27T19:34:39.1649204Z 
2025-02-27T19:34:39.1650414Z     [0m [90m 240 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mcancelTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:39.1651460Z      [90m 241 |[39m     
2025-02-27T19:34:39.1652477Z     [31m[1m>[22m[39m[90m 242 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:39.1653980Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:34:39.1655048Z      [90m 243 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:39.1656413Z      [90m 244 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:39.1657501Z      [90m 245 |[39m         type[33m:[39m [32m'tasks/cancelTask'[39m[33m,[39m[0m
2025-02-27T19:34:39.1658131Z 
2025-02-27T19:34:39.1658743Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:242:20)
2025-02-27T19:34:39.1659242Z 
2025-02-27T19:34:39.1660093Z   ● Task System Integration › should check all task requirements and unlock eligible tasks
2025-02-27T19:34:39.1660848Z 
2025-02-27T19:34:39.1661337Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:39.1661715Z 
2025-02-27T19:34:39.1662038Z     Expected: 2
2025-02-27T19:34:39.1662375Z     Received: 0
2025-02-27T19:34:39.1662571Z 
2025-02-27T19:34:39.1663702Z     [0m [90m 271 |[39m     [36mconst[39m unlocked [33m=[39m taskManager[33m.[39mcheckAllTaskRequirements()[33m;[39m
2025-02-27T19:34:39.1664660Z      [90m 272 |[39m     
2025-02-27T19:34:39.1665923Z     [31m[1m>[22m[39m[90m 273 |[39m     expect(unlocked)[33m.[39mtoBe([35m2[39m)[33m;[39m [90m// Two tasks should be unlocked[39m
2025-02-27T19:34:39.1667220Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:34:39.1668248Z      [90m 274 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:39.1669418Z      [90m 275 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:39.1670384Z      [90m 276 |[39m         type[33m:[39m [32m'tasks/unlockTask'[39m[33m,[39m[0m
2025-02-27T19:34:39.1670974Z 
2025-02-27T19:34:39.1671382Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:273:22)
2025-02-27T19:34:39.1672027Z 
2025-02-27T19:34:39.1672680Z   ● Task System Integration › should emit events when task status changes
2025-02-27T19:34:39.1673147Z 
2025-02-27T19:34:39.1673572Z     expect(jest.fn()).toHaveBeenCalledWith(...expected)
2025-02-27T19:34:39.1673938Z 
2025-02-27T19:34:39.1674232Z     Expected: "test-task"
2025-02-27T19:34:39.1674460Z 
2025-02-27T19:34:39.1674584Z     Number of calls: 0
2025-02-27T19:34:39.1674778Z 
2025-02-27T19:34:39.1675304Z     [0m [90m 314 |[39m     
2025-02-27T19:34:39.1676127Z      [90m 315 |[39m     [90m// Verify events were emitted[39m
2025-02-27T19:34:39.1677349Z     [31m[1m>[22m[39m[90m 316 |[39m     expect(startedListener)[33m.[39mtoHaveBeenCalledWith([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:39.1678466Z      [90m     |[39m                             [31m[1m^[22m[39m
2025-02-27T19:34:39.1679602Z      [90m 317 |[39m     expect(completedListener)[33m.[39mtoHaveBeenCalledWith([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:39.1680536Z      [90m 318 |[39m   })[33m;[39m
2025-02-27T19:34:39.1681058Z      [90m 319 |[39m   [0m
2025-02-27T19:34:39.1681308Z 
2025-02-27T19:34:39.1681734Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:316:29)
2025-02-27T19:34:39.1682221Z 
2025-02-27T19:34:39.1682801Z   ● Task System Integration › should provide progress information for a task
2025-02-27T19:34:39.1683319Z 
2025-02-27T19:34:39.1683523Z     expect(received).not.toBeNull()
2025-02-27T19:34:39.1683825Z 
2025-02-27T19:34:39.1683954Z     Received: null
2025-02-27T19:34:39.1684162Z 
2025-02-27T19:34:39.1685028Z     [0m [90m 334 |[39m     [36mconst[39m progress [33m=[39m taskManager[33m.[39mgetTaskProgress([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:39.1686412Z      [90m 335 |[39m     
2025-02-27T19:34:39.1687291Z     [31m[1m>[22m[39m[90m 336 |[39m     expect(progress)[33m.[39mnot[33m.[39mtoBeNull()[33m;[39m
2025-02-27T19:34:39.1688198Z      [90m     |[39m                          [31m[1m^[22m[39m
2025-02-27T19:34:39.1689743Z      [90m 337 |[39m     expect(progress[33m?[39m[33m.[39mstatus)[33m.[39mtoBe([33mTaskStatus[39m[33m.[39m[33mIN_PROGRESS[39m)[33m;[39m
2025-02-27T19:34:39.1691191Z      [90m 338 |[39m     expect(progress[33m?[39m[33m.[39mprogress)[33m.[39mtoBe([35m50[39m)[33m;[39m
2025-02-27T19:34:39.1692598Z      [90m 339 |[39m     expect(progress[33m?[39m[33m.[39mtimeRemaining)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m
2025-02-27T19:34:39.1693274Z 
2025-02-27T19:34:39.1693698Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:336:26)
2025-02-27T19:34:39.1694199Z 
2025-02-27T19:34:39.3397550Z FAIL src/systems/__tests__/eventManager.test.ts
2025-02-27T19:34:39.3398554Z   ● Test suite failed to run
2025-02-27T19:34:39.3431775Z 
2025-02-27T19:34:39.3434789Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m65[0m:[93m42[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3437649Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3439418Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3440726Z 
2025-02-27T19:34:39.3441281Z     [7m65[0m     expect(() => eventManager.initialize(store)).not.toThrow();
2025-02-27T19:34:39.3442145Z     [7m  [0m [91m                                         ~~~~~[0m
2025-02-27T19:34:39.3442502Z 
2025-02-27T19:34:39.3442892Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3443715Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3444434Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3444937Z         'tutorial' is declared here.
2025-02-27T19:34:39.3448284Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m72[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3450878Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3452773Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3454117Z 
2025-02-27T19:34:39.3454541Z     [7m72[0m     eventManager.initialize(store);
2025-02-27T19:34:39.3455475Z     [7m  [0m [91m                            ~~~~~[0m
2025-02-27T19:34:39.3455810Z 
2025-02-27T19:34:39.3456198Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3456960Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3457618Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3458094Z         'tutorial' is declared here.
2025-02-27T19:34:39.3461369Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m85[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3464299Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3466762Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3468100Z 
2025-02-27T19:34:39.3468532Z     [7m85[0m     eventManager.initialize(store);
2025-02-27T19:34:39.3469198Z     [7m  [0m [91m                            ~~~~~[0m
2025-02-27T19:34:39.3469534Z 
2025-02-27T19:34:39.3469912Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3470720Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3471419Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3471882Z         'tutorial' is declared here.
2025-02-27T19:34:39.3475081Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m113[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3538191Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3540086Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3541403Z 
2025-02-27T19:34:39.3541859Z     [7m113[0m     eventManager.initialize(store);
2025-02-27T19:34:39.3542505Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:39.3542823Z 
2025-02-27T19:34:39.3543164Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3543883Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3544505Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3544959Z         'tutorial' is declared here.
2025-02-27T19:34:39.3547919Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m131[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3550355Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3552084Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3553333Z 
2025-02-27T19:34:39.3553722Z     [7m131[0m     eventManager.initialize(store);
2025-02-27T19:34:39.3554349Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:39.3554646Z 
2025-02-27T19:34:39.3554983Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3555975Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3556613Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3557066Z         'tutorial' is declared here.
2025-02-27T19:34:39.3560206Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m165[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3563131Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3564989Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3596889Z 
2025-02-27T19:34:39.3597312Z     [7m165[0m     eventManager.initialize(store);
2025-02-27T19:34:39.3597983Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:39.3598310Z 
2025-02-27T19:34:39.3598655Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3599407Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3600053Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3600502Z         'tutorial' is declared here.
2025-02-27T19:34:39.3603639Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m185[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3606316Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3608166Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3667490Z 
2025-02-27T19:34:39.3667929Z     [7m185[0m     eventManager.initialize(store);
2025-02-27T19:34:39.3668630Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:39.3668961Z 
2025-02-27T19:34:39.3669310Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3670060Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3670717Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3671179Z         'tutorial' is declared here.
2025-02-27T19:34:39.3674318Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m226[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3677080Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3678952Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3680256Z 
2025-02-27T19:34:39.3680633Z     [7m226[0m     eventManager.initialize(store);
2025-02-27T19:34:39.3681279Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:39.3681603Z 
2025-02-27T19:34:39.3681942Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3682667Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3683315Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3683781Z         'tutorial' is declared here.
2025-02-27T19:34:39.3704425Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m258[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3707479Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3709342Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3710893Z 
2025-02-27T19:34:39.3711293Z     [7m258[0m     eventManager.initialize(store);
2025-02-27T19:34:39.3711953Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:39.3712275Z 
2025-02-27T19:34:39.3712617Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3713347Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3713967Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3714419Z         'tutorial' is declared here.
2025-02-27T19:34:39.3717753Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m284[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:39.3720324Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:39.3722190Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:39.3723502Z 
2025-02-27T19:34:39.3723842Z     [7m284[0m     eventManager.initialize(store);
2025-02-27T19:34:39.3724490Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:39.3724802Z 
2025-02-27T19:34:39.3742864Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:39.3743721Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:39.3744366Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:39.3744821Z         'tutorial' is declared here.
2025-02-27T19:34:39.3745292Z 
2025-02-27T19:34:39.4136553Z PASS src/utils/__tests__/saveUtils.test.ts
2025-02-27T19:34:39.4280191Z   ● Console
2025-02-27T19:34:39.4307803Z 
2025-02-27T19:34:39.4308056Z     console.error
2025-02-27T19:34:39.4308597Z       Failed to save game: Error: Storage quota exceeded
2025-02-27T19:34:39.4309637Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:123:15)
2025-02-27T19:34:39.4310961Z           at /home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:397:39
2025-02-27T19:34:39.4312215Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:404:13)
2025-02-27T19:34:39.4313762Z           at Object.mockConstructor [as setItem] (/home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:108:19)
2025-02-27T19:34:39.4315081Z           at saveGame (/home/runner/work/idle-game/idle-game/src/utils/saveUtils.ts:56:18)
2025-02-27T19:34:39.4316531Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:127:30)
2025-02-27T19:34:39.4317960Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.4318946Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.4319945Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.4321330Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.4322968Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.4324106Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.4325673Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.4327486Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.4328978Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.4330303Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.4332055Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.4334095Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.4335882Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.4337252Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.4338610Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.4339341Z 
2025-02-27T19:34:39.4339898Z     [0m [90m 58 |[39m     [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.4340650Z      [90m 59 |[39m   } [36mcatch[39m (error) {
2025-02-27T19:34:39.4341817Z     [31m[1m>[22m[39m[90m 60 |[39m     console[33m.[39merror([32m'Failed to save game:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.4342840Z      [90m    |[39m             [31m[1m^[22m[39m
2025-02-27T19:34:39.4343611Z      [90m 61 |[39m     [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:39.4344220Z      [90m 62 |[39m   }
2025-02-27T19:34:39.4344674Z      [90m 63 |[39m }[0m
2025-02-27T19:34:39.4344929Z 
2025-02-27T19:34:39.4345383Z       at saveGame (src/utils/saveUtils.ts:60:13)
2025-02-27T19:34:39.4346111Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:127:30)
2025-02-27T19:34:39.4346607Z 
2025-02-27T19:34:39.4346756Z     console.error
2025-02-27T19:34:39.4347384Z       Failed to load game: SyntaxError: Unexpected token i in JSON at position 0
2025-02-27T19:34:39.4348091Z           at JSON.parse (<anonymous>)
2025-02-27T19:34:39.4348848Z           at loadGame (/home/runner/work/idle-game/idle-game/src/utils/saveUtils.ts:79:37)
2025-02-27T19:34:39.4349990Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:164:30)
2025-02-27T19:34:39.4351341Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.4352321Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.4353303Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.4354622Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.4355961Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.4357111Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.4358440Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.4359926Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.4361705Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.4363087Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.4364799Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.4367294Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.4368803Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.4370112Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.4371427Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.4372164Z 
2025-02-27T19:34:39.4372632Z     [0m [90m 93 |[39m     [36mreturn[39m saveData[33m;[39m
2025-02-27T19:34:39.4373396Z      [90m 94 |[39m   } [36mcatch[39m (error) {
2025-02-27T19:34:39.4374532Z     [31m[1m>[22m[39m[90m 95 |[39m     console[33m.[39merror([32m'Failed to load game:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.4375739Z      [90m    |[39m             [31m[1m^[22m[39m
2025-02-27T19:34:39.4376497Z      [90m 96 |[39m     [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:34:39.4377087Z      [90m 97 |[39m   }
2025-02-27T19:34:39.4377529Z      [90m 98 |[39m }[0m
2025-02-27T19:34:39.4377779Z 
2025-02-27T19:34:39.4378034Z       at loadGame (src/utils/saveUtils.ts:95:13)
2025-02-27T19:34:39.4378701Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:164:30)
2025-02-27T19:34:39.4379173Z 
2025-02-27T19:34:39.4379334Z     console.error
2025-02-27T19:34:39.4379808Z       Failed to delete save: Error: Storage error
2025-02-27T19:34:39.4380802Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:214:15)
2025-02-27T19:34:39.4382025Z           at /home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:397:39
2025-02-27T19:34:39.4383233Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:404:13)
2025-02-27T19:34:39.4384720Z           at Object.mockConstructor [as removeItem] (/home/runner/work/idle-game/idle-game/node_modules/jest-mock/build/index.js:103:19)
2025-02-27T19:34:39.4386246Z           at deleteSave (/home/runner/work/idle-game/idle-game/src/utils/saveUtils.ts:105:18)
2025-02-27T19:34:39.4387445Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:218:32)
2025-02-27T19:34:39.4388840Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.4389815Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.4390777Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.4392100Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.4393212Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.4394246Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.4395702Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.4397099Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.4398510Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.4400002Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.4408243Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.4410384Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.4411878Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.4413122Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.4414364Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.4415063Z 
2025-02-27T19:34:39.4415727Z     [0m [90m 108 |[39m     [36mreturn[39m [36mtrue[39m[33m;[39m
2025-02-27T19:34:39.4416416Z      [90m 109 |[39m   } [36mcatch[39m (error) {
2025-02-27T19:34:39.4417483Z     [31m[1m>[22m[39m[90m 110 |[39m     console[33m.[39merror([32m'Failed to delete save:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.4418396Z      [90m     |[39m             [31m[1m^[22m[39m
2025-02-27T19:34:39.4419099Z      [90m 111 |[39m     [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:39.4419634Z      [90m 112 |[39m   }
2025-02-27T19:34:39.4420029Z      [90m 113 |[39m }[0m
2025-02-27T19:34:39.4420254Z 
2025-02-27T19:34:39.4420497Z       at deleteSave (src/utils/saveUtils.ts:110:13)
2025-02-27T19:34:39.4421189Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:218:32)
2025-02-27T19:34:39.4421637Z 
2025-02-27T19:34:39.4421766Z     console.error
2025-02-27T19:34:39.4422137Z       No backup found at index 0
2025-02-27T19:34:39.4422405Z 
2025-02-27T19:34:39.4422637Z     [0m [90m 165 |[39m     
2025-02-27T19:34:39.4423260Z      [90m 166 |[39m     [36mif[39m ([33m![39mserializedState) {
2025-02-27T19:34:39.4424406Z     [31m[1m>[22m[39m[90m 167 |[39m       console[33m.[39merror([32m'No backup found at index'[39m[33m,[39m backupIndex)[33m;[39m
2025-02-27T19:34:39.4425560Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.4426263Z      [90m 168 |[39m       [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:34:39.4426798Z      [90m 169 |[39m     }
2025-02-27T19:34:39.4427250Z      [90m 170 |[39m     [0m
2025-02-27T19:34:39.4427494Z 
2025-02-27T19:34:39.4427790Z       at restoreFromBackup (src/utils/saveUtils.ts:167:15)
2025-02-27T19:34:39.4428521Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:272:39)
2025-02-27T19:34:39.4428957Z 
2025-02-27T19:34:39.4429086Z     console.error
2025-02-27T19:34:39.4429405Z       Invalid backup index
2025-02-27T19:34:39.4429659Z 
2025-02-27T19:34:39.4429940Z     [0m [90m 157 |[39m   [36mtry[39m {
2025-02-27T19:34:39.4430837Z      [90m 158 |[39m     [36mif[39m (backupIndex [33m>=[39m [33mBACKUP_SAVE_KEYS[39m[33m.[39mlength) {
2025-02-27T19:34:39.4431967Z     [31m[1m>[22m[39m[90m 159 |[39m       console[33m.[39merror([32m'Invalid backup index'[39m)[33m;[39m
2025-02-27T19:34:39.4432801Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.4433476Z      [90m 160 |[39m       [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:34:39.4434030Z      [90m 161 |[39m     }
2025-02-27T19:34:39.4434500Z      [90m 162 |[39m     [0m
2025-02-27T19:34:39.4434737Z 
2025-02-27T19:34:39.4435021Z       at restoreFromBackup (src/utils/saveUtils.ts:159:15)
2025-02-27T19:34:39.4435907Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:280:39)
2025-02-27T19:34:39.4436330Z 
2025-02-27T19:34:39.4436470Z     console.error
2025-02-27T19:34:39.4437075Z       Failed to import save: SyntaxError: Unexpected token o in JSON at position 1
2025-02-27T19:34:39.4437966Z           at JSON.parse (<anonymous>)
2025-02-27T19:34:39.4438672Z           at importSave (/home/runner/work/idle-game/idle-game/src/utils/saveUtils.ts:197:37)
2025-02-27T19:34:39.4439747Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/utils/__tests__/saveUtils.test.ts:324:32)
2025-02-27T19:34:39.4441346Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:39.4442239Z           at new Promise (<anonymous>)
2025-02-27T19:34:39.4443185Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:39.4444372Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:39.4494233Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:39.4495552Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:39.4496905Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:39.4498401Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.4499840Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:39.4501079Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:39.4502708Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:39.4504612Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:39.4506313Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:39.4507567Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:39.4508834Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:39.4509533Z 
2025-02-27T19:34:39.4509983Z     [0m [90m 208 |[39m     [36mreturn[39m saveData[33m;[39m
2025-02-27T19:34:39.4510677Z      [90m 209 |[39m   } [36mcatch[39m (error) {
2025-02-27T19:34:39.4511761Z     [31m[1m>[22m[39m[90m 210 |[39m     console[33m.[39merror([32m'Failed to import save:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:39.4512693Z      [90m     |[39m             [31m[1m^[22m[39m
2025-02-27T19:34:39.4513393Z      [90m 211 |[39m     [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:34:39.4513943Z      [90m 212 |[39m   }
2025-02-27T19:34:39.4514363Z      [90m 213 |[39m }[0m
2025-02-27T19:34:39.4514596Z 
2025-02-27T19:34:39.4514859Z       at importSave (src/utils/saveUtils.ts:210:13)
2025-02-27T19:34:39.4515777Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:324:32)
2025-02-27T19:34:39.4516234Z 
2025-02-27T19:34:39.4516366Z     console.error
2025-02-27T19:34:39.4516766Z       Invalid save data format
2025-02-27T19:34:39.4517031Z 
2025-02-27T19:34:39.4517426Z     [0m [90m 199 |[39m     [90m// Validate the data[39m
2025-02-27T19:34:39.4518677Z      [90m 200 |[39m     [36mif[39m ([33m![39msaveData [33m||[39m [33m![39msaveData[33m.[39mversion [33m||[39m [33m![39msaveData[33m.[39mstate) {
2025-02-27T19:34:39.4520116Z     [31m[1m>[22m[39m[90m 201 |[39m       console[33m.[39merror([32m'Invalid save data format'[39m)[33m;[39m
2025-02-27T19:34:39.4520986Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:39.4521981Z      [90m 202 |[39m       [36mreturn[39m [36mnull[39m[33m;[39m
2025-02-27T19:34:39.4522558Z      [90m 203 |[39m     }
2025-02-27T19:34:39.4523038Z      [90m 204 |[39m     [0m
2025-02-27T19:34:39.4523289Z 
2025-02-27T19:34:39.4523538Z       at importSave (src/utils/saveUtils.ts:201:15)
2025-02-27T19:34:39.4524244Z       at Object.<anonymous> (src/utils/__tests__/saveUtils.test.ts:335:32)
2025-02-27T19:34:39.4524924Z 
2025-02-27T19:34:40.1476914Z PASS src/managers/TaskManager.test.ts
2025-02-27T19:34:40.2065077Z   ● Console
2025-02-27T19:34:40.2065462Z 
2025-02-27T19:34:40.2065601Z     console.log
2025-02-27T19:34:40.2066092Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2066399Z 
2025-02-27T19:34:40.2066823Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2067316Z 
2025-02-27T19:34:40.2067446Z     console.log
2025-02-27T19:34:40.2067843Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2068181Z 
2025-02-27T19:34:40.2068610Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2069121Z 
2025-02-27T19:34:40.2069243Z     console.log
2025-02-27T19:34:40.2069630Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2069935Z 
2025-02-27T19:34:40.2070364Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2070881Z 
2025-02-27T19:34:40.2071013Z     console.error
2025-02-27T19:34:40.2071396Z       Task non-existent-task not found
2025-02-27T19:34:40.2071682Z 
2025-02-27T19:34:40.2072109Z     [0m [90m 267 |[39m       [90m// Validate task exists[39m
2025-02-27T19:34:40.2072801Z      [90m 268 |[39m       [36mif[39m ([33m![39mtask) {
2025-02-27T19:34:40.2073798Z     [31m[1m>[22m[39m[90m 269 |[39m         console[33m.[39merror([32m`Task ${taskId} not found`[39m)[33m;[39m
2025-02-27T19:34:40.2074644Z      [90m     |[39m                 [31m[1m^[22m[39m
2025-02-27T19:34:40.2075531Z      [90m 270 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:40.2076092Z      [90m 271 |[39m       }
2025-02-27T19:34:40.2076541Z      [90m 272 |[39m       [0m
2025-02-27T19:34:40.2076785Z 
2025-02-27T19:34:40.2077132Z       at TaskManager.startTask (src/managers/TaskManager.ts:269:17)
2025-02-27T19:34:40.2077884Z       at Object.<anonymous> (src/managers/TaskManager.test.ts:148:43)
2025-02-27T19:34:40.2078316Z 
2025-02-27T19:34:40.2078442Z     console.warn
2025-02-27T19:34:40.2078955Z       Task in-progress-task is not available (status: in_progress)
2025-02-27T19:34:40.2079356Z 
2025-02-27T19:34:40.2079740Z     [0m [90m 279 |[39m       [90m// Check if task is available[39m
2025-02-27T19:34:40.2080809Z      [90m 280 |[39m       [36mif[39m (task[33m.[39mstatus [33m!==[39m [33mTaskStatus[39m[33m.[39m[33mAVAILABLE[39m) {
2025-02-27T19:34:40.2082223Z     [31m[1m>[22m[39m[90m 281 |[39m         console[33m.[39mwarn([32m`Task ${taskId} is not available (status: ${task.status})`[39m)[33m;[39m
2025-02-27T19:34:40.2083184Z      [90m     |[39m                 [31m[1m^[22m[39m
2025-02-27T19:34:40.2083896Z      [90m 282 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:40.2084484Z      [90m 283 |[39m       }
2025-02-27T19:34:40.2084928Z      [90m 284 |[39m       [0m
2025-02-27T19:34:40.2085309Z 
2025-02-27T19:34:40.2085643Z       at TaskManager.startTask (src/managers/TaskManager.ts:281:17)
2025-02-27T19:34:40.2086310Z       at Object.<anonymous> (src/managers/TaskManager.test.ts:152:42)
2025-02-27T19:34:40.2086684Z 
2025-02-27T19:34:40.2086808Z     console.warn
2025-02-27T19:34:40.2087225Z       Task locked-task is not available (status: locked)
2025-02-27T19:34:40.2087578Z 
2025-02-27T19:34:40.2087973Z     [0m [90m 279 |[39m       [90m// Check if task is available[39m
2025-02-27T19:34:40.2089026Z      [90m 280 |[39m       [36mif[39m (task[33m.[39mstatus [33m!==[39m [33mTaskStatus[39m[33m.[39m[33mAVAILABLE[39m) {
2025-02-27T19:34:40.2090798Z     [31m[1m>[22m[39m[90m 281 |[39m         console[33m.[39mwarn([32m`Task ${taskId} is not available (status: ${task.status})`[39m)[33m;[39m
2025-02-27T19:34:40.2091785Z      [90m     |[39m                 [31m[1m^[22m[39m
2025-02-27T19:34:40.2092490Z      [90m 282 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:40.2093362Z      [90m 283 |[39m       }
2025-02-27T19:34:40.2093821Z      [90m 284 |[39m       [0m
2025-02-27T19:34:40.2094073Z 
2025-02-27T19:34:40.2094415Z       at TaskManager.startTask (src/managers/TaskManager.ts:281:17)
2025-02-27T19:34:40.2125556Z       at Object.<anonymous> (src/managers/TaskManager.test.ts:156:38)
2025-02-27T19:34:40.2126039Z 
2025-02-27T19:34:40.2126179Z     console.log
2025-02-27T19:34:40.2126588Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2126904Z 
2025-02-27T19:34:40.2127349Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2127875Z 
2025-02-27T19:34:40.2128007Z     console.log
2025-02-27T19:34:40.2128393Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2128707Z 
2025-02-27T19:34:40.2129139Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2129635Z 
2025-02-27T19:34:40.2129758Z     console.log
2025-02-27T19:34:40.2130224Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2130536Z 
2025-02-27T19:34:40.2130983Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2131498Z 
2025-02-27T19:34:40.2131631Z     console.log
2025-02-27T19:34:40.2132103Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2132426Z 
2025-02-27T19:34:40.2132863Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2133384Z 
2025-02-27T19:34:40.2133504Z     console.log
2025-02-27T19:34:40.2133898Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2134209Z 
2025-02-27T19:34:40.2134645Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2135322Z 
2025-02-27T19:34:40.2135460Z     console.log
2025-02-27T19:34:40.2135858Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2136163Z 
2025-02-27T19:34:40.2136587Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2137110Z 
2025-02-27T19:34:40.2137228Z     console.log
2025-02-27T19:34:40.2137613Z       TaskManager: Registered with GameLoop
2025-02-27T19:34:40.2137920Z 
2025-02-27T19:34:40.2138341Z       at TaskManager.registerWithGameLoop (src/managers/TaskManager.ts:109:15)
2025-02-27T19:34:40.2138834Z 
2025-02-27T19:34:40.2841553Z PASS src/state/middleware/taskMiddleware.test.ts
2025-02-27T19:34:40.6345986Z FAIL src/systems/__tests__/gameLoop.test.ts
2025-02-27T19:34:40.6371209Z   ● Test suite failed to run
2025-02-27T19:34:40.6371573Z 
2025-02-27T19:34:40.6374459Z     [96msrc/systems/__tests__/gameLoop.test.ts[0m:[93m87[0m:[93m25[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; game: GameState; structures: StructuresState; events: EventsState; tasks: TasksState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:40.6377255Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:40.6379149Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; game: GameState; structures: StructuresState; events: EventsState; tasks: TasksState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:40.6380468Z 
2025-02-27T19:34:40.6380845Z     [7m87[0m     gameLoop.initialize(store);
2025-02-27T19:34:40.6381463Z     [7m  [0m [91m                        ~~~~~[0m
2025-02-27T19:34:40.6381777Z 
2025-02-27T19:34:40.6382132Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:40.6383273Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:40.6383923Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:40.6384381Z         'tutorial' is declared here.
2025-02-27T19:34:40.6384657Z 
2025-02-27T19:34:41.3036415Z PASS src/core/GameTimer.test.ts
2025-02-27T19:34:41.5699160Z FAIL src/gameCore.integration.test.tsx
2025-02-27T19:34:41.5705296Z   ● Game Core Systems Integration › Building purchase consumes resources correctly
2025-02-27T19:34:41.5709414Z 
2025-02-27T19:34:41.5713443Z     TypeError: Cannot read properties of undefined (reading 'communityGarden')
2025-02-27T19:34:41.5717611Z 
2025-02-27T19:34:41.5722467Z     [0m [90m 165 |[39m     
2025-02-27T19:34:41.5724740Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:41.5728317Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:41.5730767Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:41.5747784Z      [90m 168 |[39m     
2025-02-27T19:34:41.5748695Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:34:41.5749909Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:34:41.5750490Z 
2025-02-27T19:34:41.5751002Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:34:41.5752063Z       at BuildingManager.purchaseBuilding (src/systems/buildingManager.ts:194:58)
2025-02-27T19:34:41.5753328Z       at Object.<anonymous> (src/gameCore.integration.test.tsx:171:36)
2025-02-27T19:34:41.5756347Z 
2025-02-27T19:34:41.5758191Z   ● Game Core Systems Integration › Building level affects production calculation
2025-02-27T19:34:41.5759243Z 
2025-02-27T19:34:41.5759929Z     TypeError: Cannot read properties of undefined (reading 'communityGarden')
2025-02-27T19:34:41.5760977Z 
2025-02-27T19:34:41.5761590Z     [0m [90m 274 |[39m     
2025-02-27T19:34:41.5762538Z      [90m 275 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:41.5763806Z     [31m[1m>[22m[39m[90m 276 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:41.5764839Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:41.5765620Z      [90m 277 |[39m     
2025-02-27T19:34:41.5766219Z      [90m 278 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:41.5766931Z      [90m 279 |[39m       [36mreturn[39m {}[33m;[39m[0m
2025-02-27T19:34:41.5767276Z 
2025-02-27T19:34:41.5767803Z       at BuildingManager.calculateUpgradeCost (src/systems/buildingManager.ts:276:38)
2025-02-27T19:34:41.5768737Z       at Object.<anonymous> (src/gameCore.integration.test.tsx:209:41)
2025-02-27T19:34:41.5769251Z 
2025-02-27T19:34:41.6124490Z PASS src/core/GameManager.test.ts
2025-02-27T19:34:41.6463385Z   ● Console
2025-02-27T19:34:41.6463678Z 
2025-02-27T19:34:41.6463836Z     console.log
2025-02-27T19:34:41.6464339Z       GameManager: Started time scale sync interval
2025-02-27T19:34:41.6464732Z 
2025-02-27T19:34:41.6465466Z       at GameManager.startTimeScaleSync (src/core/GameManager.ts:269:15)
2025-02-27T19:34:41.6466055Z 
2025-02-27T19:34:41.6466201Z     console.log
2025-02-27T19:34:41.6466681Z       GameManager: Started Redux time sync interval
2025-02-27T19:34:41.6467038Z 
2025-02-27T19:34:41.6467504Z       at GameManager.startReduxTimeSync (src/core/GameManager.ts:309:15)
2025-02-27T19:34:41.6467996Z 
2025-02-27T19:34:41.6468152Z     console.error
2025-02-27T19:34:41.6469037Z       Error checking all progression items: TypeError: Cannot read properties of undefined (reading 'milestoneIds')
2025-02-27T19:34:41.6470436Z           at selectMilestoneIds (/home/runner/work/idle-game/idle-game/src/redux/progressionSlice.ts:199:92)
2025-02-27T19:34:41.6472317Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:34:41.6473888Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:34:41.6475878Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:34:41.6477268Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:34:41.6478791Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:34:41.6480186Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:34:41.6481835Z           at ProgressionManager.checkAllProgressionItems (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:710:56)
2025-02-27T19:34:41.6483563Z           at GameManager.updateResourceSystem (/home/runner/work/idle-game/idle-game/src/core/GameManager.ts:471:30)
2025-02-27T19:34:41.6484829Z           at GameManager.update (/home/runner/work/idle-game/idle-game/src/core/GameManager.ts:420:12)
2025-02-27T19:34:41.6492661Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/core/GameManager.test.ts:110:5)
2025-02-27T19:34:41.6494011Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:41.6494934Z           at new Promise (<anonymous>)
2025-02-27T19:34:41.6496072Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:41.6497419Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:41.6498557Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:41.6499646Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:41.6500983Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:41.6502501Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:41.6503790Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:41.6505683Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:41.6507650Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:41.6509220Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:41.6510524Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:41.6511833Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:41.6512580Z 
2025-02-27T19:34:41.6512979Z     [0m [90m 725 |[39m       }
2025-02-27T19:34:41.6513602Z      [90m 726 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:41.6514864Z     [31m[1m>[22m[39m[90m 727 |[39m       console[33m.[39merror([32m'Error checking all progression items:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:41.6516413Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:41.6517000Z      [90m 728 |[39m     }
2025-02-27T19:34:41.6517765Z      [90m 729 |[39m     
2025-02-27T19:34:41.6518478Z      [90m 730 |[39m     [36mif[39m (itemsUpdated [33m>[39m [35m0[39m) {[0m
2025-02-27T19:34:41.6518921Z 
2025-02-27T19:34:41.6519631Z       at ProgressionManager.checkAllProgressionItems (src/managers/progression/ProgressionManager.ts:727:15)
2025-02-27T19:34:41.6520831Z       at GameManager.updateResourceSystem (src/core/GameManager.ts:471:30)
2025-02-27T19:34:41.6521905Z       at GameManager.update (src/core/GameManager.ts:420:12)
2025-02-27T19:34:41.6522648Z       at Object.<anonymous> (src/core/GameManager.test.ts:110:5)
2025-02-27T19:34:41.6523072Z 
2025-02-27T19:34:41.6523213Z     console.error
2025-02-27T19:34:41.6524070Z       Error checking all progression items: TypeError: Cannot read properties of undefined (reading 'milestoneIds')
2025-02-27T19:34:41.6525631Z           at selectMilestoneIds (/home/runner/work/idle-game/idle-game/src/redux/progressionSlice.ts:199:92)
2025-02-27T19:34:41.6527055Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:34:41.6616326Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:34:41.6617883Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:34:41.6619384Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:34:41.6620977Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:34:41.6622445Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:34:41.6624126Z           at ProgressionManager.checkAllProgressionItems (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:710:56)
2025-02-27T19:34:41.6738719Z           at GameManager.updateResourceSystem (/home/runner/work/idle-game/idle-game/src/core/GameManager.ts:471:30)
2025-02-27T19:34:41.6740145Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/core/GameManager.test.ts:133:26)
2025-02-27T19:34:41.6741529Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:41.6742546Z           at new Promise (<anonymous>)
2025-02-27T19:34:41.6743546Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:41.6744961Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:41.6746271Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:41.6747357Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:41.6748682Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:41.6750170Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:41.6751381Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:41.6753080Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:41.6755036Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:41.6756779Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:41.6758077Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:41.6759901Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:41.6760631Z 
2025-02-27T19:34:41.6761131Z     [0m [90m 725 |[39m       }
2025-02-27T19:34:41.6761757Z      [90m 726 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:41.6763310Z     [31m[1m>[22m[39m[90m 727 |[39m       console[33m.[39merror([32m'Error checking all progression items:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:41.6764444Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:41.6764996Z      [90m 728 |[39m     }
2025-02-27T19:34:41.6794367Z      [90m 729 |[39m     
2025-02-27T19:34:41.6795340Z      [90m 730 |[39m     [36mif[39m (itemsUpdated [33m>[39m [35m0[39m) {[0m
2025-02-27T19:34:41.6795770Z 
2025-02-27T19:34:41.6796420Z       at ProgressionManager.checkAllProgressionItems (src/managers/progression/ProgressionManager.ts:727:15)
2025-02-27T19:34:41.6797621Z       at GameManager.updateResourceSystem (src/core/GameManager.ts:471:30)
2025-02-27T19:34:41.6798453Z       at Object.<anonymous> (src/core/GameManager.test.ts:133:26)
2025-02-27T19:34:41.6798880Z 
2025-02-27T19:34:41.6799043Z     console.error
2025-02-27T19:34:41.6799912Z       Error checking all progression items: TypeError: Cannot read properties of undefined (reading 'milestoneIds')
2025-02-27T19:34:41.6801295Z           at selectMilestoneIds (/home/runner/work/idle-game/idle-game/src/redux/progressionSlice.ts:199:92)
2025-02-27T19:34:41.6802681Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:34:41.6804251Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:34:41.6805894Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:34:41.6807350Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:34:41.6808906Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:34:41.6810362Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:34:41.6812041Z           at ProgressionManager.checkAllProgressionItems (/home/runner/work/idle-game/idle-game/src/managers/progression/ProgressionManager.ts:710:56)
2025-02-27T19:34:41.6813673Z           at GameManager.updateResourceSystem (/home/runner/work/idle-game/idle-game/src/core/GameManager.ts:471:30)
2025-02-27T19:34:41.6814941Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/core/GameManager.test.ts:153:26)
2025-02-27T19:34:41.6816392Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:41.6817283Z           at new Promise (<anonymous>)
2025-02-27T19:34:41.6818198Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:41.6819452Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:41.6820504Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:41.6821518Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:41.6822773Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:41.6824131Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:41.6875698Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:41.6877798Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:41.6879790Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:41.6881657Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:41.6882979Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:41.6884304Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)
2025-02-27T19:34:41.6885031Z 
2025-02-27T19:34:41.6885570Z     [0m [90m 725 |[39m       }
2025-02-27T19:34:41.6886199Z      [90m 726 |[39m     } [36mcatch[39m (error) {
2025-02-27T19:34:41.6887449Z     [31m[1m>[22m[39m[90m 727 |[39m       console[33m.[39merror([32m'Error checking all progression items:'[39m[33m,[39m error)[33m;[39m
2025-02-27T19:34:41.6888510Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:41.6889052Z      [90m 728 |[39m     }
2025-02-27T19:34:41.6889480Z      [90m 729 |[39m     
2025-02-27T19:34:41.6890221Z      [90m 730 |[39m     [36mif[39m (itemsUpdated [33m>[39m [35m0[39m) {[0m
2025-02-27T19:34:41.6890669Z 
2025-02-27T19:34:41.6891401Z       at ProgressionManager.checkAllProgressionItems (src/managers/progression/ProgressionManager.ts:727:15)
2025-02-27T19:34:41.6892603Z       at GameManager.updateResourceSystem (src/core/GameManager.ts:471:30)
2025-02-27T19:34:41.6893440Z       at Object.<anonymous> (src/core/GameManager.test.ts:153:26)
2025-02-27T19:34:41.6893847Z 
2025-02-27T19:34:42.0006838Z FAIL src/state/selectors.test.ts
2025-02-27T19:34:42.0007771Z   ● Test suite failed to run
2025-02-27T19:34:42.0008051Z 
2025-02-27T19:34:42.0011675Z     [96msrc/state/selectors.test.ts[0m:[93m94[0m:[93m32[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ resources: { 'collective-power': Resource; solidarity: Resource; 'community-trust': Resource; }; structures: { 'union-office': Structure; 'community-center': Structure; 'alternative-media': Structure; }; game: { ...; }; tasks: { ...; }; events: { ...; }; progression: { ...; }; }' to type 'RootState' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
2025-02-27T19:34:42.0016738Z       Property 'tutorial' is missing in type '{ resources: { 'collective-power': Resource; solidarity: Resource; 'community-trust': Resource; }; structures: { 'union-office': Structure; 'community-center': Structure; 'alternative-media': Structure; }; game: { ...; }; tasks: { ...; }; events: { ...; }; progression: { ...; }; }' but required in type 'RootState'.
2025-02-27T19:34:42.0018621Z 
2025-02-27T19:34:42.0066168Z     [7m 94[0m   const mockState: RootState = {
2025-02-27T19:34:42.0067208Z     [7m   [0m [91m                               ~[0m
2025-02-27T19:34:42.0067784Z     [7m 95[0m     resources: {
2025-02-27T19:34:42.0068297Z     [7m   [0m [91m~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:42.0068729Z     [7m...[0m 
2025-02-27T19:34:42.0069108Z     [7m163[0m     }
2025-02-27T19:34:42.0069512Z     [7m   [0m [91m~~~~~[0m
2025-02-27T19:34:42.0069970Z     [7m164[0m   } as RootState;
2025-02-27T19:34:42.0070456Z     [7m   [0m [91m~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:42.0070728Z 
2025-02-27T19:34:42.0071117Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:42.0071837Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:42.0072449Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:42.0072890Z         'tutorial' is declared here.
2025-02-27T19:34:42.0073163Z 
2025-02-27T19:34:42.7719940Z PASS src/tests/gameSystemCoherenceTest.test.ts
2025-02-27T19:34:42.8379377Z PASS src/systems/gameLoop.test.ts
2025-02-27T19:34:42.8440674Z   ● Console
2025-02-27T19:34:42.8442458Z 
2025-02-27T19:34:42.8446213Z     console.log
2025-02-27T19:34:42.8448381Z       GameLoop: Window event listeners attached
2025-02-27T19:34:42.8448744Z 
2025-02-27T19:34:42.8449182Z       at GameLoop.setupWindowEventListeners (src/systems/gameLoop.ts:516:13)
2025-02-27T19:34:42.8450067Z 
2025-02-27T19:34:42.8450194Z     console.log
2025-02-27T19:34:42.8450696Z       gameSlice.addPlayTime: Adding 10.00s, old=0.00, new=10.00
2025-02-27T19:34:42.8451093Z 
2025-02-27T19:34:42.8451344Z       at addPlayTime (src/state/gameSlice.ts:62:17)
2025-02-27T19:34:42.8451868Z           at Array.reduce (<anonymous>)
2025-02-27T19:34:42.8452155Z 
2025-02-27T19:34:42.8689491Z FAIL src/workers.integration.test.tsx
2025-02-27T19:34:42.8709233Z   ● Worker System Integration Test › WorkerManager can assign and manage workers
2025-02-27T19:34:42.8709963Z 
2025-02-27T19:34:42.8711824Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:42.8713491Z 
2025-02-27T19:34:42.8715492Z     [0m [90m 190 |[39m     
2025-02-27T19:34:42.8717770Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:42.8720431Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:42.8722888Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:42.8765496Z      [90m 193 |[39m     
2025-02-27T19:34:42.8766365Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:42.8767203Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:42.8767604Z 
2025-02-27T19:34:42.8768101Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:42.8769033Z       at Object.<anonymous> (src/workers.integration.test.tsx:105:19)
2025-02-27T19:34:42.8769474Z 
2025-02-27T19:34:43.8370159Z FAIL src/systems/__tests__/oppressionSystem.test.ts
2025-02-27T19:34:43.8380991Z   ● Console
2025-02-27T19:34:43.8382394Z 
2025-02-27T19:34:43.8383729Z     console.log
2025-02-27T19:34:43.8385371Z       Resources before: {
2025-02-27T19:34:43.8386938Z         "collective-power": {
2025-02-27T19:34:43.8388563Z           "id": "collective-power",
2025-02-27T19:34:43.8390219Z           "name": "Collective Power",
2025-02-27T19:34:43.8391811Z           "amount": 0,
2025-02-27T19:34:43.8393282Z           "maxAmount": 1000,
2025-02-27T19:34:43.8394788Z           "perSecond": 0.1,
2025-02-27T19:34:43.8396547Z           "basePerSecond": 0.1,
2025-02-27T19:34:43.8398121Z           "description": "Test power resource",
2025-02-27T19:34:43.8399674Z           "unlocked": true,
2025-02-27T19:34:43.8401175Z           "category": "primary",
2025-02-27T19:34:43.8402738Z           "clickPower": 1
2025-02-27T19:34:43.8404239Z         },
2025-02-27T19:34:43.8405793Z         "oppression": {
2025-02-27T19:34:43.8406986Z           "id": "oppression",
2025-02-27T19:34:43.8407880Z           "name": "Corporate Oppression",
2025-02-27T19:34:43.8408382Z           "amount": 0,
2025-02-27T19:34:43.8408749Z           "maxAmount": 1000,
2025-02-27T19:34:43.8409144Z           "perSecond": 0.05,
2025-02-27T19:34:43.8409611Z           "basePerSecond": 0.05,
2025-02-27T19:34:43.8410136Z           "description": "Test oppression resource",
2025-02-27T19:34:43.8410625Z           "unlocked": true,
2025-02-27T19:34:43.8411051Z           "category": "threat"
2025-02-27T19:34:43.8411431Z         }
2025-02-27T19:34:43.8411726Z       }
2025-02-27T19:34:43.8411893Z 
2025-02-27T19:34:43.8412353Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:63:13)
2025-02-27T19:34:43.8412869Z 
2025-02-27T19:34:43.8418853Z   ● Oppression System › oppression resource should generate at the specified rate
2025-02-27T19:34:43.8420244Z 
2025-02-27T19:34:43.8420848Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:43.8421474Z 
2025-02-27T19:34:43.8421996Z     [0m [90m 178 |[39m     
2025-02-27T19:34:43.8423120Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:43.8425798Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:43.8427942Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:43.8429695Z      [90m 181 |[39m     
2025-02-27T19:34:43.8430394Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:43.8432364Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:43.8433991Z 
2025-02-27T19:34:43.8435716Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:43.8438098Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:67:21)
2025-02-27T19:34:43.8439429Z 
2025-02-27T19:34:43.8440046Z   ● Oppression System › oppression should continue to generate in multiple ticks
2025-02-27T19:34:43.8440572Z 
2025-02-27T19:34:43.8440931Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:43.8441373Z 
2025-02-27T19:34:43.8441605Z     [0m [90m 178 |[39m     
2025-02-27T19:34:43.8442501Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:43.8444815Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:43.8446721Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:43.8447248Z      [90m 181 |[39m     
2025-02-27T19:34:43.8447773Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:43.8448603Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:43.8449080Z 
2025-02-27T19:34:43.8449525Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:43.8450459Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:85:23)
2025-02-27T19:34:43.8450952Z 
2025-02-27T19:34:43.8451597Z   ● Oppression System › oppression should generate even if its perSecond property is modified
2025-02-27T19:34:43.8452173Z 
2025-02-27T19:34:43.8452518Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:43.8452943Z 
2025-02-27T19:34:43.8453208Z     [0m [90m 178 |[39m     
2025-02-27T19:34:43.8454110Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:43.8456510Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:43.8458192Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:43.8458710Z      [90m 181 |[39m     
2025-02-27T19:34:43.8459236Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:43.8460073Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:43.8460550Z 
2025-02-27T19:34:43.8460996Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:43.8461938Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:107:21)
2025-02-27T19:34:43.8462692Z 
2025-02-27T19:34:43.8463301Z   ● Oppression System › oppression generation should scale with time delta correctly
2025-02-27T19:34:43.8463821Z 
2025-02-27T19:34:43.8464176Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:43.8464606Z 
2025-02-27T19:34:43.8464847Z     [0m [90m 178 |[39m     
2025-02-27T19:34:43.8466183Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:43.8468500Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:43.8470158Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:43.8470700Z      [90m 181 |[39m     
2025-02-27T19:34:43.8471234Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:43.8472071Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:43.8472532Z 
2025-02-27T19:34:43.8472986Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:43.8473915Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:127:23)
2025-02-27T19:34:43.8474425Z 
2025-02-27T19:34:44.2197174Z PASS src/components/progression/__tests__/ProgressionTracker.test.tsx
2025-02-27T19:34:44.4993455Z PASS src/components/buildings/__tests__/BuildingItem.test.tsx
2025-02-27T19:34:44.5508875Z PASS src/systems/__tests__/gameEndConditions.test.ts
2025-02-27T19:34:44.7846398Z PASS src/utils/__tests__/timeUtils.test.ts
2025-02-27T19:34:45.0916159Z PASS src/state/structuresSlice.test.ts
2025-02-27T19:34:45.8410855Z PASS src/components/ResourceList.test.tsx
2025-02-27T19:34:46.5773722Z PASS src/components/buildings/__tests__/BuildingList.test.tsx
2025-02-27T19:34:47.7436573Z PASS src/components/progression/__tests__/MilestoneProgressStrip.test.tsx
2025-02-27T19:34:48.0005412Z PASS src/components/__tests__/GameTimer.test.tsx
2025-02-27T19:34:48.6542329Z PASS src/components/ResourceDisplay.test.tsx
2025-02-27T19:34:49.1051898Z FAIL src/components/App.test.tsx
2025-02-27T19:34:49.1053015Z   ● Test suite failed to run
2025-02-27T19:34:49.1053598Z 
2025-02-27T19:34:49.1054882Z     [96msrc/managers/TutorialManager.ts[0m:[93m3[0m:[93m10[0m - [91merror[0m[90m TS2305: [0mModule '"../state/store"' has no exported member 'AppState'.
2025-02-27T19:34:49.1056029Z 
2025-02-27T19:34:49.1056579Z     [7m3[0m import { AppState } from '../state/store';
2025-02-27T19:34:49.1057600Z     [7m [0m [91m         ~~~~~~~~[0m
2025-02-27T19:34:49.1059397Z     [96msrc/managers/TutorialManager.ts[0m:[93m79[0m:[93m24[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:34:49.1060585Z 
2025-02-27T19:34:49.1060965Z     [7m79[0m       const tutorial = tutorialContent[currentStep];
2025-02-27T19:34:49.1061664Z     [7m  [0m [91m                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:49.1063468Z     [96msrc/managers/TutorialManager.ts[0m:[93m99[0m:[93m24[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:34:49.1064626Z 
2025-02-27T19:34:49.1064994Z     [7m99[0m       const tutorial = tutorialContent[currentStep];
2025-02-27T19:34:49.1065915Z     [7m  [0m [91m                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:49.1067636Z     [96msrc/managers/TutorialManager.ts[0m:[93m155[0m:[93m14[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:34:49.1069197Z 
2025-02-27T19:34:49.1069554Z     [7m155[0m       return tutorialContent[currentStep];
2025-02-27T19:34:49.1070191Z     [7m   [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:49.1070494Z 
2025-02-27T19:34:49.2386934Z PASS src/components/__tests__/OfflineProgressModal.test.tsx
2025-02-27T19:34:49.2443569Z   ● Console
2025-02-27T19:34:49.2443814Z 
2025-02-27T19:34:49.2443948Z     console.error
2025-02-27T19:34:49.2444601Z       An update to OfflineProgressModal inside a test was not wrapped in act(...).
2025-02-27T19:34:49.2445490Z       
2025-02-27T19:34:49.2446118Z       When testing, code that causes React state updates should be wrapped into act(...):
2025-02-27T19:34:49.2446727Z       
2025-02-27T19:34:49.2446990Z       act(() => {
2025-02-27T19:34:49.2447350Z         /* fire events that update state */
2025-02-27T19:34:49.2447743Z       });
2025-02-27T19:34:49.2448089Z       /* assert on the output */
2025-02-27T19:34:49.2448434Z       
2025-02-27T19:34:49.2449337Z       This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
2025-02-27T19:34:49.2450092Z 
2025-02-27T19:34:49.2450647Z     [0m [90m 37 |[39m       [90m// Reset closing state after the animation completes[39m
2025-02-27T19:34:49.2451410Z      [90m 38 |[39m       setTimeout(() [33m=>[39m {
2025-02-27T19:34:49.2452174Z     [31m[1m>[22m[39m[90m 39 |[39m         setIsClosing([36mfalse[39m)[33m;[39m
2025-02-27T19:34:49.2452847Z      [90m    |[39m         [31m[1m^[22m[39m
2025-02-27T19:34:49.2453457Z      [90m 40 |[39m       }[33m,[39m [35m100[39m)[33m;[39m
2025-02-27T19:34:49.2454243Z      [90m 41 |[39m     }[33m,[39m [35m300[39m)[33m;[39m [90m// Animation duration[39m
2025-02-27T19:34:49.2454873Z      [90m 42 |[39m   }[33m;[39m[0m
2025-02-27T19:34:49.2455295Z 
2025-02-27T19:34:49.2455711Z       at node_modules/react-dom/cjs/react-dom-client.development.js:15751:19
2025-02-27T19:34:49.2456666Z       at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:34:49.2457904Z       at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:15750:9)
2025-02-27T19:34:49.2459167Z       at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:14311:11)
2025-02-27T19:34:49.2460366Z       at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:7208:13)
2025-02-27T19:34:49.2461424Z       at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:7161:7)
2025-02-27T19:34:49.2462406Z       at src/components/OfflineProgressModal.tsx:39:9
2025-02-27T19:34:49.2463477Z       at callTimer (node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:744:24)
2025-02-27T19:34:49.2464638Z       at doTickInner (node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1312:29)
2025-02-27T19:34:49.2465898Z       at doTick (node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1393:20)
2025-02-27T19:34:49.2471968Z       at Object.tick (node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1401:20)
2025-02-27T19:34:49.2473718Z       at FakeTimers.advanceTimersByTime (node_modules/@jest/fake-timers/build/modernFakeTimers.js:94:19)
2025-02-27T19:34:49.2475778Z       at Object.<anonymous> (src/components/__tests__/OfflineProgressModal.test.tsx:83:10)
2025-02-27T19:34:49.2476622Z 
2025-02-27T19:34:49.7700642Z PASS src/components/ui/__tests__/Dropdown.test.tsx
2025-02-27T19:34:49.7704908Z   ● Console
2025-02-27T19:34:49.7708624Z 
2025-02-27T19:34:49.7712078Z     console.log
2025-02-27T19:34:49.7715917Z       Dropdown styles: {
2025-02-27T19:34:49.7720095Z         backgroundColor: 'rgb(25, 25, 25)',
2025-02-27T19:34:49.7724498Z         border: '1px solid #333',
2025-02-27T19:34:49.7728690Z         padding: '8px'
2025-02-27T19:34:49.7732472Z       }
2025-02-27T19:34:49.7737226Z 
2025-02-27T19:34:49.7741742Z       at Object.<anonymous> (src/components/ui/__tests__/Dropdown.test.tsx:70:15)
2025-02-27T19:34:49.7746322Z 
2025-02-27T19:34:50.4766941Z PASS src/components/tutorial/__tests__/TutorialModal.test.tsx
2025-02-27T19:34:50.6368953Z PASS src/components/ui/__tests__/Modal.test.tsx
2025-02-27T19:34:50.9423911Z PASS src/components/resources/__tests__/PassiveUpgradePanel.test.tsx
2025-02-27T19:34:51.1691211Z PASS src/state/resourcesSlice.test.ts
2025-02-27T19:34:51.7584458Z PASS src/components/resources/__tests__/ResourceDisplay.test.tsx
2025-02-27T19:34:52.0189995Z PASS src/components/GameTimer.test.tsx
2025-02-27T19:34:52.2630956Z PASS src/components/ui/__tests__/Icon.test.tsx
2025-02-27T19:34:52.3808898Z PASS src/state/gameSlice.test.ts
2025-02-27T19:34:52.3825605Z   ● Console
2025-02-27T19:34:52.3826354Z 
2025-02-27T19:34:52.3826989Z     console.log
2025-02-27T19:34:52.3827758Z       gameSlice.addPlayTime: Adding 50.00s, old=100.00, new=150.00
2025-02-27T19:34:52.3828221Z 
2025-02-27T19:34:52.3828468Z       at addPlayTime (src/state/gameSlice.ts:62:17)
2025-02-27T19:34:52.3828991Z           at Array.reduce (<anonymous>)
2025-02-27T19:34:52.3829277Z 
2025-02-27T19:34:52.3829396Z     console.log
2025-02-27T19:34:52.3829925Z       gameSlice.setTotalPlayTime: Setting time from 0.00s to 500.00s
2025-02-27T19:34:52.3830350Z 
2025-02-27T19:34:52.3830624Z       at setTotalPlayTime (src/state/gameSlice.ts:70:15)
2025-02-27T19:34:52.3831161Z           at Array.reduce (<anonymous>)
2025-02-27T19:34:52.3831437Z 
2025-02-27T19:34:52.8553449Z PASS src/components/ui/__tests__/Button.test.tsx
2025-02-27T19:34:53.0476408Z PASS src/components/workers/__tests__/WorkerOverview.test.tsx
2025-02-27T19:34:53.2149322Z PASS src/components/ui/__tests__/Card.test.tsx
2025-02-27T19:34:53.4827881Z PASS src/index.integration.test.tsx
2025-02-27T19:34:53.6296445Z PASS src/utils/testHelpers.test.ts
2025-02-27T19:34:53.9742858Z PASS src/state/actions/__tests__/workerActions.test.ts
2025-02-27T19:34:54.0467881Z PASS src/structure.test.ts
2025-02-27T19:34:54.2947294Z PASS src/components/layout/__tests__/Layout.test.tsx
2025-02-27T19:34:54.3100573Z   ● Console
2025-02-27T19:34:54.3104802Z 
2025-02-27T19:34:54.3109754Z     console.error
2025-02-27T19:34:54.3110732Z       TypeError: Cannot read properties of undefined (reading 'activeEvents')
2025-02-27T19:34:54.3112051Z           at /home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:17:40
2025-02-27T19:34:54.3113652Z           at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)
2025-02-27T19:34:54.3115647Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)
2025-02-27T19:34:54.3117327Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:34:54.3118535Z           at /home/runner/work/idle-game/idle-game/src/state/hooks.ts:21:18
2025-02-27T19:34:54.3120013Z           at recomputationWrapper (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:392:63)
2025-02-27T19:34:54.3121678Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:34:54.3123279Z           at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:412:39)
2025-02-27T19:34:54.3124890Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)
2025-02-27T19:34:54.3126725Z           at memoized (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/hooks/useSelector.ts:171:28)
2025-02-27T19:34:54.3128714Z           at memoizedSelector (/home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:46:30)
2025-02-27T19:34:54.3130949Z           at /home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:70:22
2025-02-27T19:34:54.3133557Z           at mountSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:6214:24)
2025-02-27T19:34:54.3135655Z           at Object.useSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:22810:16)
2025-02-27T19:34:54.3138268Z           at Object.<anonymous>.process.env.NODE_ENV.exports.useSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:1507:34)
2025-02-27T19:34:54.3141080Z           at Object.<anonymous>.process.env.NODE_ENV.exports.useSyncExternalStoreWithSelector (/home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:81:19)
2025-02-27T19:34:54.3143672Z           at useSelector2 (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/hooks/useSelector.ts:243:27)
2025-02-27T19:34:54.3145257Z           at useMemoSelector (/home/runner/work/idle-game/idle-game/src/state/hooks.ts:27:21)
2025-02-27T19:34:54.3146595Z           at EventPanel (/home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:28:39)
2025-02-27T19:34:54.3148410Z           at Object.react-stack-bottom-frame (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:22428:20)
2025-02-27T19:34:54.3150334Z           at renderWithHooks (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:5757:22)
2025-02-27T19:34:54.3152263Z           at updateFunctionComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:8018:19)
2025-02-27T19:34:54.3155715Z           at updateSimpleMemoComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:7869:14)
2025-02-27T19:34:54.3157400Z           at updateMemoComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:7802:13)
2025-02-27T19:34:54.3162587Z           at beginWork (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:10103:18)
2025-02-27T19:34:54.3164124Z           at runWithFiberInDEV (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:34:54.3166795Z           at performUnitOfWork (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:15052:22)
2025-02-27T19:34:54.3168370Z           at workLoopSync (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14870:41)
2025-02-27T19:34:54.3169908Z           at renderRootSync (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14850:11)
2025-02-27T19:34:54.3171507Z           at performWorkOnRoot (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14384:44)
2025-02-27T19:34:54.3173294Z           at performWorkOnRootViaSchedulerTask (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:15931:7)
2025-02-27T19:34:54.3174897Z           at flushActQueue (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:862:34)
2025-02-27T19:34:54.3176646Z           at Object.<anonymous>.process.env.NODE_ENV.exports.act (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:1151:10)
2025-02-27T19:34:54.3178128Z           at /home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/act-compat.js:47:25
2025-02-27T19:34:54.3179422Z           at renderRoot (/home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/pure.js:188:26)
2025-02-27T19:34:54.3180714Z           at render (/home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/pure.js:287:10)
2025-02-27T19:34:54.3182308Z           at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/components/layout/__tests__/Layout.test.tsx:44:11)
2025-02-27T19:34:54.3183689Z           at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)
2025-02-27T19:34:54.3184584Z           at new Promise (<anonymous>)
2025-02-27T19:34:54.3185884Z           at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)
2025-02-27T19:34:54.3187160Z           at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)
2025-02-27T19:34:54.3188230Z           at processTicksAndRejections (node:internal/process/task_queues:96:5)
2025-02-27T19:34:54.3189271Z           at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)
2025-02-27T19:34:54.3190543Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)
2025-02-27T19:34:54.3191985Z           at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)
2025-02-27T19:34:54.3193221Z           at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)
2025-02-27T19:34:54.3194932Z           at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
2025-02-27T19:34:54.3197040Z           at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
2025-02-27T19:34:54.3198554Z           at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)
2025-02-27T19:34:54.3199832Z           at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)
2025-02-27T19:34:54.3201115Z           at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12) {
2025-02-27T19:34:54.3202295Z         [stack]: "TypeError: Cannot read properties of undefined (reading 'activeEvents')\n" +
2025-02-27T19:34:54.3203371Z           '    at /home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:17:40\n' +
2025-02-27T19:34:54.3204727Z           '    at collectInputSelectorResults (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/utils.ts:122:47)\n' +
2025-02-27T19:34:54.3206499Z           '    at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:405:36)\n' +
2025-02-27T19:34:54.3207970Z           '    at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)\n' +
2025-02-27T19:34:54.3209048Z           '    at /home/runner/work/idle-game/idle-game/src/state/hooks.ts:21:18\n' +
2025-02-27T19:34:54.3210344Z           '    at recomputationWrapper (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:392:63)\n' +
2025-02-27T19:34:54.3211818Z           '    at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)\n' +
2025-02-27T19:34:54.3213280Z           '    at dependenciesChecker (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/createSelectorCreator.ts:412:39)\n' +
2025-02-27T19:34:54.3214776Z           '    at memoized (/home/runner/work/idle-game/idle-game/node_modules/reselect/src/weakMapMemoize.ts:228:21)\n' +
2025-02-27T19:34:54.3216320Z           '    at memoized (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/hooks/useSelector.ts:171:28)\n' +
2025-02-27T19:34:54.3218137Z           '    at memoizedSelector (/home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:46:30)\n' +
2025-02-27T19:34:54.3220175Z           '    at /home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:70:22\n' +
2025-02-27T19:34:54.3222250Z           '    at mountSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:6214:24)\n' +
2025-02-27T19:34:54.3224070Z           '    at Object.useSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:22810:16)\n' +
2025-02-27T19:34:54.3226536Z           '    at Object.<anonymous>.process.env.NODE_ENV.exports.useSyncExternalStore (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:1507:34)\n' +
2025-02-27T19:34:54.3229159Z           '    at Object.<anonymous>.process.env.NODE_ENV.exports.useSyncExternalStoreWithSelector (/home/runner/work/idle-game/idle-game/node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.development.js:81:19)\n' +
2025-02-27T19:34:54.3231364Z           '    at useSelector2 (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/hooks/useSelector.ts:243:27)\n' +
2025-02-27T19:34:54.3232629Z           '    at useMemoSelector (/home/runner/work/idle-game/idle-game/src/state/hooks.ts:27:21)\n' +
2025-02-27T19:34:54.3233815Z           '    at EventPanel (/home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:28:39)\n' +
2025-02-27T19:34:54.3235625Z           '    at Object.react-stack-bottom-frame (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:22428:20)\n' +
2025-02-27T19:34:54.3237397Z           '    at renderWithHooks (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:5757:22)\n' +
2025-02-27T19:34:54.3239145Z           '    at updateFunctionComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:8018:19)\n' +
2025-02-27T19:34:54.3240967Z           '    at updateSimpleMemoComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:7869:14)\n' +
2025-02-27T19:34:54.3242773Z           '    at updateMemoComponent (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:7802:13)\n' +
2025-02-27T19:34:54.3244428Z           '    at beginWork (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:10103:18)\n' +
2025-02-27T19:34:54.3246285Z           '    at runWithFiberInDEV (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:543:16)\n' +
2025-02-27T19:34:54.3247995Z           '    at performUnitOfWork (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:15052:22)\n' +
2025-02-27T19:34:54.3249705Z           '    at workLoopSync (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14870:41)\n' +
2025-02-27T19:34:54.3251364Z           '    at renderRootSync (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14850:11)\n' +
2025-02-27T19:34:54.3253046Z           '    at performWorkOnRoot (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:14384:44)\n' +
2025-02-27T19:34:54.3254917Z           '    at performWorkOnRootViaSchedulerTask (/home/runner/work/idle-game/idle-game/node_modules/react-dom/cjs/react-dom-client.development.js:15931:7)\n' +
2025-02-27T19:34:54.3256800Z           '    at flushActQueue (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:862:34)\n' +
2025-02-27T19:34:54.3258449Z           '    at Object.<anonymous>.process.env.NODE_ENV.exports.act (/home/runner/work/idle-game/idle-game/node_modules/react/cjs/react.development.js:1151:10)\n' +
2025-02-27T19:34:54.3260015Z           '    at /home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/act-compat.js:47:25\n' +
2025-02-27T19:34:54.3261773Z           '    at renderRoot (/home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/pure.js:188:26)\n' +
2025-02-27T19:34:54.3263199Z           '    at render (/home/runner/work/idle-game/idle-game/node_modules/@testing-library/react/dist/pure.js:287:10)\n' +
2025-02-27T19:34:54.3264655Z           '    at Object.<anonymous> (/home/runner/work/idle-game/idle-game/src/components/layout/__tests__/Layout.test.tsx:44:11)\n' +
2025-02-27T19:34:54.3266570Z           '    at Promise.then.completed (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:298:28)\n' +
2025-02-27T19:34:54.3267519Z           '    at new Promise (<anonymous>)\n' +
2025-02-27T19:34:54.3268520Z           '    at callAsyncCircusFn (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/utils.js:231:10)\n' +
2025-02-27T19:34:54.3269887Z           '    at _callCircusTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:316:40)\n' +
2025-02-27T19:34:54.3271033Z           '    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n' +
2025-02-27T19:34:54.3272124Z           '    at _runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:252:3)\n' +
2025-02-27T19:34:54.3273437Z           '    at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:126:9)\n' +
2025-02-27T19:34:54.3274891Z           '    at _runTestsForDescribeBlock (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:121:9)\n' +
2025-02-27T19:34:54.3276379Z           '    at run (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/run.js:71:3)\n' +
2025-02-27T19:34:54.3278066Z           '    at runAndTransformResultsToJestFormat (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n' +
2025-02-27T19:34:54.3280035Z           '    at jestAdapter (/home/runner/work/idle-game/idle-game/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n' +
2025-02-27T19:34:54.3281606Z           '    at runTestInternal (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:367:16)\n' +
2025-02-27T19:34:54.3282922Z           '    at runTest (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/runTest.js:444:34)\n' +
2025-02-27T19:34:54.3284236Z           '    at Object.worker (/home/runner/work/idle-game/idle-game/node_modules/jest-runner/build/testWorker.js:106:12)',
2025-02-27T19:34:54.3285507Z         [message]: "Cannot read properties of undefined (reading 'activeEvents')"
2025-02-27T19:34:54.3286101Z       }
2025-02-27T19:34:54.3286376Z       
2025-02-27T19:34:54.3286835Z       The above error occurred in the <EventPanel> component.
2025-02-27T19:34:54.3287320Z       
2025-02-27T19:34:54.3288097Z       React will try to recreate this component tree from scratch using the error boundary you provided, ErrorBoundary.
2025-02-27T19:34:54.3288779Z 
2025-02-27T19:34:54.3289449Z     [0m [90m 42 |[39m describe([32m'Layout Component'[39m[33m,[39m () [33m=>[39m {
2025-02-27T19:34:54.3290595Z      [90m 43 |[39m   test([32m'renders all layout components correctly'[39m[33m,[39m () [33m=>[39m {
2025-02-27T19:34:54.3291437Z     [31m[1m>[22m[39m[90m 44 |[39m     render(
2025-02-27T19:34:54.3292038Z      [90m    |[39m           [31m[1m^[22m[39m
2025-02-27T19:34:54.3292854Z      [90m 45 |[39m       [33m<[39m[33mProvider[39m store[33m=[39m{store}[33m>[39m
2025-02-27T19:34:54.3294534Z      [90m 46 |[39m         [33m<[39m[33mLayout[39m sidebarContent[33m=[39m{[33m<[39m[33mdiv[39m[33m>[39m[33mSidebar[39m [33mContent[39m[33m<[39m[33m/[39m[33mdiv[39m[33m>[39m}[33m>[39m
2025-02-27T19:34:54.3296434Z      [90m 47 |[39m           [33m<[39m[33mdiv[39m[33m>[39m[33mMain[39m [33mContent[39m[33m<[39m[33m/[39m[33mdiv[39m[33m>[39m[0m
2025-02-27T19:34:54.3297317Z 
2025-02-27T19:34:54.3297892Z       at defaultOnCaughtError (node_modules/react-dom/cjs/react-dom-client.development.js:7445:21)
2025-02-27T19:34:54.3299010Z       at logCaughtError (node_modules/react-dom/cjs/react-dom-client.development.js:7484:9)
2025-02-27T19:34:54.3300111Z       at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:34:54.3301524Z       at ErrorBoundary.inst.componentDidCatch.update.callback (node_modules/react-dom/cjs/react-dom-client.development.js:7531:11)
2025-02-27T19:34:54.3303149Z       at callCallback (node_modules/react-dom/cjs/react-dom-client.development.js:10680:16)
2025-02-27T19:34:54.3304213Z       at commitCallbacks (node_modules/react-dom/cjs/react-dom-client.development.js:10700:11)
2025-02-27T19:34:54.3305475Z       at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:34:54.3306613Z       at commitClassCallbacks (node_modules/react-dom/cjs/react-dom-client.development.js:10919:11)
2025-02-27T19:34:54.3307829Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11490:25)
2025-02-27T19:34:54.3309130Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3310435Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11529:11)
2025-02-27T19:34:54.3311754Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3313067Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11413:11)
2025-02-27T19:34:54.3314357Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3315848Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11585:11)
2025-02-27T19:34:54.3317182Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3318494Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11413:11)
2025-02-27T19:34:54.3319811Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3321145Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11495:11)
2025-02-27T19:34:54.3322357Z       at commitLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12406:7)
2025-02-27T19:34:54.3323452Z       at commitRootImpl (node_modules/react-dom/cjs/react-dom-client.development.js:15352:11)
2025-02-27T19:34:54.3324514Z       at commitRoot (node_modules/react-dom/cjs/react-dom-client.development.js:15251:11)
2025-02-27T19:34:54.3325790Z       at performWorkOnRoot (node_modules/react-dom/cjs/react-dom-client.development.js:14445:15)
2025-02-27T19:34:54.3327031Z       at performWorkOnRootViaSchedulerTask (node_modules/react-dom/cjs/react-dom-client.development.js:15931:7)
2025-02-27T19:34:54.3328156Z       at flushActQueue (node_modules/react/cjs/react.development.js:862:34)
2025-02-27T19:34:54.3329213Z       at Object.<anonymous>.process.env.NODE_ENV.exports.act (node_modules/react/cjs/react.development.js:1151:10)
2025-02-27T19:34:54.3330238Z       at node_modules/@testing-library/react/dist/act-compat.js:47:25
2025-02-27T19:34:54.3331051Z       at renderRoot (node_modules/@testing-library/react/dist/pure.js:188:26)
2025-02-27T19:34:54.3331849Z       at render (node_modules/@testing-library/react/dist/pure.js:287:10)
2025-02-27T19:34:54.3332681Z       at Object.<anonymous> (src/components/layout/__tests__/Layout.test.tsx:44:11)
2025-02-27T19:34:54.3333201Z 
2025-02-27T19:34:54.3333340Z     console.error
2025-02-27T19:34:54.3334060Z       [ERROR in UnknownComponent]: Cannot read properties of undefined (reading 'activeEvents') {
2025-02-27T19:34:54.3334851Z         component: 'UnknownComponent',
2025-02-27T19:34:54.3335789Z         componentStack: '\n' +
2025-02-27T19:34:54.3336692Z           '    at EventPanel (/home/runner/work/idle-game/idle-game/src/components/events/EventPanel.tsx:16:37)\n' +
2025-02-27T19:34:54.3338023Z           '    at ErrorBoundary (/home/runner/work/idle-game/idle-game/src/components/error/ErrorBoundary.tsx:36:5)\n' +
2025-02-27T19:34:54.3338942Z           '    at div (<anonymous>)\n' +
2025-02-27T19:34:54.3340066Z           '    at Layout (/home/runner/work/idle-game/idle-game/src/components/layout/Layout.tsx:16:42)\n' +
2025-02-27T19:34:54.3341352Z           '    at Provider (/home/runner/work/idle-game/idle-game/node_modules/react-redux/src/components/Provider.tsx:60:11)'
2025-02-27T19:34:54.3342172Z       }
2025-02-27T19:34:54.3342334Z 
2025-02-27T19:34:54.3343415Z     [0m [90m 135 |[39m       console[33m.[39merror([32m`[CRITICAL${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:34:54.3344967Z      [90m 136 |[39m     } [36melse[39m [36mif[39m (severity [33m===[39m [33mErrorSeverity[39m[33m.[39m[33mERROR[39m) {
2025-02-27T19:34:54.3346954Z     [31m[1m>[22m[39m[90m 137 |[39m       console[33m.[39merror([32m`[ERROR${context ? ' in ' + context : ''}]: ${errorMsg}`[39m[33m,[39m metadata [33m||[39m data)[33m;[39m
2025-02-27T19:34:54.3348082Z      [90m     |[39m               [31m[1m^[22m[39m
2025-02-27T19:34:54.3348623Z      [90m 138 |[39m     }
2025-02-27T19:34:54.3349035Z      [90m 139 |[39m     
2025-02-27T19:34:54.3349724Z      [90m 140 |[39m     [90m// Skip logging INFO and WARNING to console[39m[0m
2025-02-27T19:34:54.3350148Z 
2025-02-27T19:34:54.3350477Z       at ErrorLogger.logError (src/utils/errorUtils.ts:137:15)
2025-02-27T19:34:54.3351354Z       at ErrorBoundary.componentDidCatch (src/components/error/ErrorBoundary.tsx:58:31)
2025-02-27T19:34:54.3352553Z       at Object.react-stack-bottom-frame (node_modules/react-dom/cjs/react-dom-client.development.js:22481:20)
2025-02-27T19:34:54.3354089Z       at ErrorBoundary.inst.componentDidCatch.update.callback (node_modules/react-dom/cjs/react-dom-client.development.js:7542:11)
2025-02-27T19:34:54.3355625Z       at callCallback (node_modules/react-dom/cjs/react-dom-client.development.js:10680:16)
2025-02-27T19:34:54.3356697Z       at commitCallbacks (node_modules/react-dom/cjs/react-dom-client.development.js:10700:11)
2025-02-27T19:34:54.3357808Z       at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:543:16)
2025-02-27T19:34:54.3358967Z       at commitClassCallbacks (node_modules/react-dom/cjs/react-dom-client.development.js:10919:11)
2025-02-27T19:34:54.3360187Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11490:25)
2025-02-27T19:34:54.3361503Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3362803Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11529:11)
2025-02-27T19:34:54.3364141Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3365629Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11413:11)
2025-02-27T19:34:54.3366938Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3368265Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11585:11)
2025-02-27T19:34:54.3369596Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3370906Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11413:11)
2025-02-27T19:34:54.3372194Z       at recursivelyTraverseLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12412:11)
2025-02-27T19:34:54.3373798Z       at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:11495:11)
2025-02-27T19:34:54.3375009Z       at commitLayoutEffects (node_modules/react-dom/cjs/react-dom-client.development.js:12406:7)
2025-02-27T19:34:54.3376410Z       at commitRootImpl (node_modules/react-dom/cjs/react-dom-client.development.js:15352:11)
2025-02-27T19:34:54.3377689Z       at commitRoot (node_modules/react-dom/cjs/react-dom-client.development.js:15251:11)
2025-02-27T19:34:54.3378790Z       at performWorkOnRoot (node_modules/react-dom/cjs/react-dom-client.development.js:14445:15)
2025-02-27T19:34:54.3380087Z       at performWorkOnRootViaSchedulerTask (node_modules/react-dom/cjs/react-dom-client.development.js:15931:7)
2025-02-27T19:34:54.3381179Z       at flushActQueue (node_modules/react/cjs/react.development.js:862:34)
2025-02-27T19:34:54.3382262Z       at Object.<anonymous>.process.env.NODE_ENV.exports.act (node_modules/react/cjs/react.development.js:1151:10)
2025-02-27T19:34:54.3383275Z       at node_modules/@testing-library/react/dist/act-compat.js:47:25
2025-02-27T19:34:54.3384096Z       at renderRoot (node_modules/@testing-library/react/dist/pure.js:188:26)
2025-02-27T19:34:54.3384919Z       at render (node_modules/@testing-library/react/dist/pure.js:287:10)
2025-02-27T19:34:54.3385960Z       at Object.<anonymous> (src/components/layout/__tests__/Layout.test.tsx:44:11)
2025-02-27T19:34:54.3386474Z 
2025-02-27T19:34:54.3912610Z PASS src/config.test.ts
2025-02-27T19:34:54.4369254Z PASS src/managers/GameLoopManager.test.ts
2025-02-27T19:34:54.4380486Z   ● Console
2025-02-27T19:34:54.4380975Z 
2025-02-27T19:34:54.4381265Z     console.log
2025-02-27T19:34:54.4381847Z       GameLoopManager: Registered tick handler, total handlers: 1
2025-02-27T19:34:54.4382334Z 
2025-02-27T19:34:54.4382888Z       at GameLoopManager.registerTickHandler (src/managers/GameLoopManager.ts:39:17)
2025-02-27T19:34:54.4383605Z 
2025-02-27T19:34:54.7224991Z PASS src/index.test.ts
2025-02-27T19:34:54.8265956Z PASS src/styles/index.test.ts
2025-02-27T19:34:54.9795384Z PASS src/test-semantic-release.test.ts
2025-02-27T19:34:55.4978369Z PASS src/hello-world.test.ts
2025-02-27T19:34:55.5180421Z PASS src/utils/EventEmitter.test.ts
2025-02-27T19:34:55.6784802Z 
2025-02-27T19:34:55.6786409Z Summary of all failing tests
2025-02-27T19:34:55.6790514Z FAIL src/systems/__tests__/workerManager.test.ts (8.838 s)
2025-02-27T19:34:55.6794631Z   ● WorkerManager › Worker counting › should get total available workers based on game stage
2025-02-27T19:34:55.6795416Z 
2025-02-27T19:34:55.6797449Z     TypeError: Cannot read properties of undefined (reading 'gameStage')
2025-02-27T19:34:55.6797947Z 
2025-02-27T19:34:55.6800999Z     [0m [90m 142 |[39m     [90m// Available workers are determined by current game stage[39m
2025-02-27T19:34:55.6803717Z      [90m 143 |[39m     [90m// 5 base workers + 3 per game stage[39m
2025-02-27T19:34:55.6809474Z     [31m[1m>[22m[39m[90m 144 |[39m     [36mreturn[39m [35m5[39m [33m+[39m (state[33m.[39mgame[33m.[39mgameStage [33m*[39m [35m3[39m)[33m;[39m
2025-02-27T19:34:55.6811437Z      [90m     |[39m                            [31m[1m^[22m[39m
2025-02-27T19:34:55.6812272Z      [90m 145 |[39m   }
2025-02-27T19:34:55.6813290Z      [90m 146 |[39m   
2025-02-27T19:34:55.6815639Z      [90m 147 |[39m   [90m/**[39m[0m
2025-02-27T19:34:55.6815984Z 
2025-02-27T19:34:55.6818833Z       at WorkerManager.getTotalAvailableWorkers (src/systems/workerManager.ts:144:28)
2025-02-27T19:34:55.6821722Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:89:28)
2025-02-27T19:34:55.6822226Z 
2025-02-27T19:34:55.6824512Z   ● WorkerManager › Worker counting › should get total assigned workers
2025-02-27T19:34:55.6825014Z 
2025-02-27T19:34:55.6826520Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:55.6828606Z         at Function.values (<anonymous>)
2025-02-27T19:34:55.6828908Z 
2025-02-27T19:34:55.6835269Z     [0m [90m 153 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:55.6835962Z      [90m 154 |[39m     
2025-02-27T19:34:55.6843152Z     [31m[1m>[22m[39m[90m 155 |[39m     [36mreturn[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mreduce(
2025-02-27T19:34:55.6845721Z      [90m     |[39m                   [31m[1m^[22m[39m
2025-02-27T19:34:55.6851158Z      [90m 156 |[39m       (total[33m:[39m number[33m,[39m structure[33m:[39m unknown) [33m=>[39m {
2025-02-27T19:34:55.6861040Z      [90m 157 |[39m         [36mif[39m (structure [33m&&[39m [36mtypeof[39m structure [33m===[39m [32m'object'[39m [33m&&[39m [32m'workers'[39m [36min[39m structure [33m&&[39m 
2025-02-27T19:34:55.6866369Z      [90m 158 |[39m             [36mtypeof[39m structure[33m.[39mworkers [33m===[39m [32m'number'[39m) {[0m
2025-02-27T19:34:55.6866869Z 
2025-02-27T19:34:55.6870075Z       at WorkerManager.getTotalAssignedWorkers (src/systems/workerManager.ts:155:19)
2025-02-27T19:34:55.6874021Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:102:28)
2025-02-27T19:34:55.6874486Z 
2025-02-27T19:34:55.6878077Z   ● WorkerManager › Worker counting › should get remaining workers correctly
2025-02-27T19:34:55.6878545Z 
2025-02-27T19:34:55.6881357Z     TypeError: Cannot read properties of undefined (reading 'gameStage')
2025-02-27T19:34:55.6881809Z 
2025-02-27T19:34:55.6886717Z     [0m [90m 142 |[39m     [90m// Available workers are determined by current game stage[39m
2025-02-27T19:34:55.6890077Z      [90m 143 |[39m     [90m// 5 base workers + 3 per game stage[39m
2025-02-27T19:34:55.6905059Z     [31m[1m>[22m[39m[90m 144 |[39m     [36mreturn[39m [35m5[39m [33m+[39m (state[33m.[39mgame[33m.[39mgameStage [33m*[39m [35m3[39m)[33m;[39m
2025-02-27T19:34:55.6908672Z      [90m     |[39m                            [31m[1m^[22m[39m
2025-02-27T19:34:55.6909308Z      [90m 145 |[39m   }
2025-02-27T19:34:55.6909753Z      [90m 146 |[39m   
2025-02-27T19:34:55.6911015Z      [90m 147 |[39m   [90m/**[39m[0m
2025-02-27T19:34:55.6911337Z 
2025-02-27T19:34:55.6914736Z       at WorkerManager.getTotalAvailableWorkers (src/systems/workerManager.ts:144:28)
2025-02-27T19:34:55.6921069Z       at WorkerManager.getRemainingWorkers (src/systems/workerManager.ts:172:17)
2025-02-27T19:34:55.6932316Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:118:28)
2025-02-27T19:34:55.6932826Z 
2025-02-27T19:34:55.6933382Z   ● WorkerManager › Worker assignment › should assign workers to buildings
2025-02-27T19:34:55.6933837Z 
2025-02-27T19:34:55.6940861Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:55.6941374Z 
2025-02-27T19:34:55.6941661Z     [0m [90m 190 |[39m     
2025-02-27T19:34:55.6945920Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.6950984Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.6956064Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.6956620Z      [90m 193 |[39m     
2025-02-27T19:34:55.6962510Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.6963310Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:55.6963699Z 
2025-02-27T19:34:55.6969345Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:55.6973109Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:137:36)
2025-02-27T19:34:55.6973842Z 
2025-02-27T19:34:55.6986620Z   ● WorkerManager › Worker assignment › should limit assignment to available workers
2025-02-27T19:34:55.6987372Z 
2025-02-27T19:34:55.6987972Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:55.6989294Z 
2025-02-27T19:34:55.6989815Z     [0m [90m 190 |[39m     
2025-02-27T19:34:55.6990733Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.6991994Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.6993278Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.6993827Z      [90m 193 |[39m     
2025-02-27T19:34:55.6994413Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.6998526Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:55.6999906Z 
2025-02-27T19:34:55.7000418Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:55.7001393Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:148:21)
2025-02-27T19:34:55.7001887Z 
2025-02-27T19:34:55.7002467Z   ● WorkerManager › Worker assignment › should limit assignment to maxWorkers
2025-02-27T19:34:55.7002957Z 
2025-02-27T19:34:55.7004843Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:55.7005491Z 
2025-02-27T19:34:55.7005800Z     [0m [90m 190 |[39m     
2025-02-27T19:34:55.7006343Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7008353Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7009773Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7010298Z      [90m 193 |[39m     
2025-02-27T19:34:55.7013021Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.7015224Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:55.7015654Z 
2025-02-27T19:34:55.7017024Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:55.7018261Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:159:21)
2025-02-27T19:34:55.7018765Z 
2025-02-27T19:34:55.7019757Z   ● WorkerManager › Worker assignment › should handle nonexistent building
2025-02-27T19:34:55.7020109Z 
2025-02-27T19:34:55.7021233Z     TypeError: Cannot read properties of undefined (reading 'nonexistent')
2025-02-27T19:34:55.7021694Z 
2025-02-27T19:34:55.7021938Z     [0m [90m 190 |[39m     
2025-02-27T19:34:55.7025245Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7044246Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7045546Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7046080Z      [90m 193 |[39m     
2025-02-27T19:34:55.7047743Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.7049271Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:55.7049640Z 
2025-02-27T19:34:55.7051222Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:55.7052794Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:169:36)
2025-02-27T19:34:55.7053279Z 
2025-02-27T19:34:55.7054428Z   ● WorkerManager › Changing worker count › should add workers by delta
2025-02-27T19:34:55.7054878Z 
2025-02-27T19:34:55.7056063Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:55.7056610Z 
2025-02-27T19:34:55.7056850Z     [0m [90m 234 |[39m     
2025-02-27T19:34:55.7059340Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7062295Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7063550Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7064187Z      [90m 237 |[39m     
2025-02-27T19:34:55.7065833Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.7067250Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:55.7067833Z 
2025-02-27T19:34:55.7069209Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:34:55.7070719Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:189:21)
2025-02-27T19:34:55.7071235Z 
2025-02-27T19:34:55.7072372Z   ● WorkerManager › Changing worker count › should remove workers by delta
2025-02-27T19:34:55.7072829Z 
2025-02-27T19:34:55.7073891Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:55.7074342Z 
2025-02-27T19:34:55.7074568Z     [0m [90m 234 |[39m     
2025-02-27T19:34:55.7077530Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7080388Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7081601Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7082133Z      [90m 237 |[39m     
2025-02-27T19:34:55.7083516Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.7085566Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:55.7085945Z 
2025-02-27T19:34:55.7086994Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:34:55.7088928Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:210:21)
2025-02-27T19:34:55.7089398Z 
2025-02-27T19:34:55.7091043Z   ● WorkerManager › Changing worker count › should limit addition by available workers
2025-02-27T19:34:55.7091572Z 
2025-02-27T19:34:55.7092131Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:55.7092569Z 
2025-02-27T19:34:55.7092799Z     [0m [90m 234 |[39m     
2025-02-27T19:34:55.7095731Z      [90m 235 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7098788Z     [31m[1m>[22m[39m[90m 236 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7099939Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7100440Z      [90m 237 |[39m     
2025-02-27T19:34:55.7102054Z      [90m 238 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.7103554Z      [90m 239 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:55.7103926Z 
2025-02-27T19:34:55.7105423Z       at WorkerManager.changeWorkerCount (src/systems/workerManager.ts:236:38)
2025-02-27T19:34:55.7107112Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:231:21)
2025-02-27T19:34:55.7107581Z 
2025-02-27T19:34:55.7109362Z   ● WorkerManager › Worker efficiency › should calculate worker efficiency correctly
2025-02-27T19:34:55.7109820Z 
2025-02-27T19:34:55.7110433Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:55.7110988Z 
2025-02-27T19:34:55.7111223Z     [0m [90m 287 |[39m     
2025-02-27T19:34:55.7114024Z      [90m 288 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:55.7117115Z     [31m[1m>[22m[39m[90m 289 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7118376Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7118998Z      [90m 290 |[39m     
2025-02-27T19:34:55.7122257Z      [90m 291 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m building[33m.[39mworkers [33m===[39m [35m0[39m) {
2025-02-27T19:34:55.7123335Z      [90m 292 |[39m       [36mreturn[39m [35m0[39m[33m;[39m[0m
2025-02-27T19:34:55.7123687Z 
2025-02-27T19:34:55.7125530Z       at WorkerManager.calculateWorkerEfficiency (src/systems/workerManager.ts:289:38)
2025-02-27T19:34:55.7127204Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:246:28)
2025-02-27T19:34:55.7127672Z 
2025-02-27T19:34:55.7131530Z   ● WorkerManager › Worker efficiency › should handle nonexistent building for efficiency
2025-02-27T19:34:55.7132094Z 
2025-02-27T19:34:55.7132713Z     TypeError: Cannot read properties of undefined (reading 'nonexistent')
2025-02-27T19:34:55.7133171Z 
2025-02-27T19:34:55.7133403Z     [0m [90m 287 |[39m     
2025-02-27T19:34:55.7136594Z      [90m 288 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:55.7139541Z     [31m[1m>[22m[39m[90m 289 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7140730Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7141236Z      [90m 290 |[39m     
2025-02-27T19:34:55.7144514Z      [90m 291 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m building[33m.[39mworkers [33m===[39m [35m0[39m) {
2025-02-27T19:34:55.7145888Z      [90m 292 |[39m       [36mreturn[39m [35m0[39m[33m;[39m[0m
2025-02-27T19:34:55.7146243Z 
2025-02-27T19:34:55.7147872Z       at WorkerManager.calculateWorkerEfficiency (src/systems/workerManager.ts:289:38)
2025-02-27T19:34:55.7149447Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:283:28)
2025-02-27T19:34:55.7149901Z 
2025-02-27T19:34:55.7151525Z   ● WorkerManager › Auto-assignment › should auto-assign with balanced strategy
2025-02-27T19:34:55.7152012Z 
2025-02-27T19:34:55.7152328Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:55.7153175Z         at Function.values (<anonymous>)
2025-02-27T19:34:55.7153570Z 
2025-02-27T19:34:55.7153809Z     [0m [90m 318 |[39m     
2025-02-27T19:34:55.7157064Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:55.7162813Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:34:55.7164185Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:34:55.7165442Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:34:55.7167861Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:34:55.7169355Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:34:55.7169712Z 
2025-02-27T19:34:55.7171207Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:34:55.7172976Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:290:21)
2025-02-27T19:34:55.7173441Z 
2025-02-27T19:34:55.7174711Z   ● WorkerManager › Auto-assignment › should auto-assign with focused strategy
2025-02-27T19:34:55.7175381Z 
2025-02-27T19:34:55.7175795Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:55.7176685Z         at Function.values (<anonymous>)
2025-02-27T19:34:55.7176975Z 
2025-02-27T19:34:55.7177212Z     [0m [90m 318 |[39m     
2025-02-27T19:34:55.7180303Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:55.7186393Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:34:55.7187719Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:34:55.7188456Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:34:55.7190710Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:34:55.7192144Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:34:55.7192515Z 
2025-02-27T19:34:55.7193820Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:34:55.7195875Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:310:21)
2025-02-27T19:34:55.7196348Z 
2025-02-27T19:34:55.7197721Z   ● WorkerManager › Auto-assignment › should auto-assign with efficiency strategy
2025-02-27T19:34:55.7198238Z 
2025-02-27T19:34:55.7198640Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:55.7199429Z         at Function.values (<anonymous>)
2025-02-27T19:34:55.7199720Z 
2025-02-27T19:34:55.7200150Z     [0m [90m 318 |[39m     
2025-02-27T19:34:55.7203433Z      [90m 319 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState[33m![39m()[33m;[39m
2025-02-27T19:34:55.7209142Z     [31m[1m>[22m[39m[90m 320 |[39m     [36mconst[39m buildings [33m=[39m [33mObject[39m[33m.[39mvalues(state[33m.[39mstructures)[33m.[39mfilter((b[33m:[39m unknown)[33m:[39m b is [33mStructure[39m [33m=>[39m {
2025-02-27T19:34:55.7210404Z      [90m     |[39m                              [31m[1m^[22m[39m
2025-02-27T19:34:55.7211479Z      [90m 321 |[39m       [36mreturn[39m b [33m!==[39m undefined [33m&&[39m 
2025-02-27T19:34:55.7214079Z      [90m 322 |[39m              [36mtypeof[39m b [33m===[39m [32m'object'[39m [33m&&[39m 
2025-02-27T19:34:55.7215698Z      [90m 323 |[39m              b [33m!==[39m [36mnull[39m [33m&&[39m [0m
2025-02-27T19:34:55.7216069Z 
2025-02-27T19:34:55.7217547Z       at WorkerManager.autoAssignWorkers (src/systems/workerManager.ts:320:30)
2025-02-27T19:34:55.7219076Z       at Object.<anonymous> (src/systems/__tests__/workerManager.test.ts:331:21)
2025-02-27T19:34:55.7219543Z 
2025-02-27T19:34:55.7220974Z FAIL src/systems/resourceManager.test.ts (9.242 s)
2025-02-27T19:34:55.7224224Z   ● ResourceManager › initializeResources › dispatches addResource action for each initial resource
2025-02-27T19:34:55.7224817Z 
2025-02-27T19:34:55.7225300Z     TypeError: this.actions.addResource is not a function
2025-02-27T19:34:55.7225686Z 
2025-02-27T19:34:55.7229187Z     [0m [90m 153 |[39m     [33mObject[39m[33m.[39mvalues([33mINITIAL_RESOURCES[39m)[33m.[39mforEach(resource [33m=>[39m {
2025-02-27T19:34:55.7236360Z      [90m 154 |[39m       [36mif[39m (validateObject(resource[33m,[39m [[32m'id'[39m[33m,[39m [32m'name'[39m[33m,[39m [32m'amount'[39m[33m,[39m [32m'perSecond'[39m[33m,[39m [32m'unlocked'[39m][33m,[39m [32m'initializeResources'[39m)) {
2025-02-27T19:34:55.7239918Z     [31m[1m>[22m[39m[90m 155 |[39m         [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddResource(resource))[33m;[39m
2025-02-27T19:34:55.7241212Z      [90m     |[39m                                    [31m[1m^[22m[39m
2025-02-27T19:34:55.7241865Z      [90m 156 |[39m       }
2025-02-27T19:34:55.7242780Z      [90m 157 |[39m     })[33m;[39m
2025-02-27T19:34:55.7243574Z      [90m 158 |[39m   }[0m
2025-02-27T19:34:55.7243804Z 
2025-02-27T19:34:55.7244728Z       at src/systems/resourceManager.ts:155:36
2025-02-27T19:34:55.7245819Z           at Array.forEach (<anonymous>)
2025-02-27T19:34:55.7248335Z       at ResourceManager.initializeResources (src/systems/resourceManager.ts:153:38)
2025-02-27T19:34:55.7249914Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:54:23)
2025-02-27T19:34:55.7250547Z 
2025-02-27T19:34:55.7253177Z   ● ResourceManager › updateResources › updates resource amounts based on perSecond rates and elapsed time
2025-02-27T19:34:55.7253650Z 
2025-02-27T19:34:55.7254361Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:55.7254873Z 
2025-02-27T19:34:55.7255248Z     [0m [90m 178 |[39m     
2025-02-27T19:34:55.7258373Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:55.7266293Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:55.7267934Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:55.7268306Z      [90m 181 |[39m     
2025-02-27T19:34:55.7268788Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:55.7271710Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:55.7272145Z 
2025-02-27T19:34:55.7273486Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:55.7275550Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:105:23)
2025-02-27T19:34:55.7275985Z 
2025-02-27T19:34:55.7281074Z   ● ResourceManager › calculateResourceGeneration › calculates and updates resource generation rates based on structures
2025-02-27T19:34:55.7281841Z 
2025-02-27T19:34:55.7282127Z     TypeError: Cannot convert undefined or null to object
2025-02-27T19:34:55.7282703Z         at Function.values (<anonymous>)
2025-02-27T19:34:55.7283000Z 
2025-02-27T19:34:55.7283244Z     [0m [90m 251 |[39m     
2025-02-27T19:34:55.7285607Z      [90m 252 |[39m     [90m// Add production from all structures[39m
2025-02-27T19:34:55.7289939Z     [31m[1m>[22m[39m[90m 253 |[39m     [33mObject[39m[33m.[39mvalues(structures)[33m.[39mforEach((structure[33m:[39m unknown) [33m=>[39m {
2025-02-27T19:34:55.7290854Z      [90m     |[39m            [31m[1m^[22m[39m
2025-02-27T19:34:55.7293492Z      [90m 254 |[39m       [90m// Skip structures that aren't built or don't have workers assigned[39m
2025-02-27T19:34:55.7298025Z      [90m 255 |[39m       [36mif[39m ([33m![39mstructure [33m||[39m [36mtypeof[39m structure [33m!==[39m [32m'object'[39m [33m||[39m
2025-02-27T19:34:55.7302324Z      [90m 256 |[39m           [33m![39m([32m'unlocked'[39m [36min[39m structure) [33m||[39m [33m![39m([32m'level'[39m [36min[39m structure) [33m||[39m[0m
2025-02-27T19:34:55.7302992Z 
2025-02-27T19:34:55.7304020Z       at ResourceManager.calculateResourceGeneration (src/systems/resourceManager.ts:253:12)
2025-02-27T19:34:55.7305747Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:197:23)
2025-02-27T19:34:55.7306187Z 
2025-02-27T19:34:55.7308502Z   ● ResourceManager › canAfford › returns true when all resources are available and sufficient
2025-02-27T19:34:55.7309027Z 
2025-02-27T19:34:55.7309986Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:55.7310463Z 
2025-02-27T19:34:55.7314101Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:55.7316590Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:55.7319416Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:55.7320841Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:55.7325890Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:55.7326931Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:55.7327540Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:55.7327800Z 
2025-02-27T19:34:55.7329648Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:55.7331542Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:256:38)
2025-02-27T19:34:55.7332152Z 
2025-02-27T19:34:55.7333491Z   ● ResourceManager › canAfford › returns false when any resource is insufficient
2025-02-27T19:34:55.7333954Z 
2025-02-27T19:34:55.7335412Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:55.7335908Z 
2025-02-27T19:34:55.7339331Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:55.7341612Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:55.7344440Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:55.7345980Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:55.7350911Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:55.7352057Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:55.7352754Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:55.7352996Z 
2025-02-27T19:34:55.7354766Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:55.7356582Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:297:38)
2025-02-27T19:34:55.7357007Z 
2025-02-27T19:34:55.7359006Z   ● ResourceManager › canAfford › returns false when any resource is not unlocked
2025-02-27T19:34:55.7359455Z 
2025-02-27T19:34:55.7360535Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:55.7361012Z 
2025-02-27T19:34:55.7364681Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:55.7367278Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:55.7370141Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:55.7371508Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:55.7376659Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:55.7377705Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:55.7378425Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:55.7378663Z 
2025-02-27T19:34:55.7380470Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:55.7382130Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:338:38)
2025-02-27T19:34:55.7382553Z 
2025-02-27T19:34:55.7384189Z   ● ResourceManager › canAfford › returns false when any resource is missing
2025-02-27T19:34:55.7384656Z 
2025-02-27T19:34:55.7385916Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:55.7386409Z 
2025-02-27T19:34:55.7389997Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:55.7392347Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:55.7395048Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:55.7396649Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:55.7401591Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:55.7402734Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:55.7403398Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:55.7403654Z 
2025-02-27T19:34:55.7405393Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:55.7407428Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:369:38)
2025-02-27T19:34:55.7407853Z 
2025-02-27T19:34:55.7410313Z   ● ResourceManager › applyResourceCost › dispatches addResourceAmount with negative values for each cost
2025-02-27T19:34:55.7410849Z 
2025-02-27T19:34:55.7411688Z     TypeError: Cannot read properties of undefined (reading 'test-resource-1')
2025-02-27T19:34:55.7412175Z 
2025-02-27T19:34:55.7415958Z     [0m [90m 341 |[39m     [36mfor[39m ([36mconst[39m [resourceId[33m,[39m amount] [36mof[39m [33mObject[39m[33m.[39mentries(costs)) {
2025-02-27T19:34:55.7418296Z      [90m 342 |[39m       [90m// The resource must exist, be unlocked, and have sufficient amount[39m
2025-02-27T19:34:55.7421089Z     [31m[1m>[22m[39m[90m 343 |[39m       [36mconst[39m resource [33m=[39m resources[resourceId][33m;[39m
2025-02-27T19:34:55.7422440Z      [90m     |[39m                                 [31m[1m^[22m[39m
2025-02-27T19:34:55.7427587Z      [90m 344 |[39m       [36mif[39m ([33m![39mresource [33m||[39m [33m![39mresource[33m.[39munlocked [33m||[39m resource[33m.[39mamount [33m<[39m amount) {
2025-02-27T19:34:55.7428627Z      [90m 345 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
2025-02-27T19:34:55.7429205Z      [90m 346 |[39m       }[0m
2025-02-27T19:34:55.7429450Z 
2025-02-27T19:34:55.7431388Z       at ResourceManager.canAfford (src/systems/resourceManager.ts:343:33)
2025-02-27T19:34:55.7433407Z       at ResourceManager.applyResourceCost (src/systems/resourceManager.ts:363:15)
2025-02-27T19:34:55.7435412Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:415:38)
2025-02-27T19:34:55.7435828Z 
2025-02-27T19:34:55.7438966Z   ● ResourceManager › unlockResource › unlocks a locked resource and returns true
2025-02-27T19:34:55.7439524Z 
2025-02-27T19:34:55.7440233Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:34:55.7440752Z 
2025-02-27T19:34:55.7442258Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:34:55.7444542Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7447399Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:55.7448402Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:55.7449007Z      [90m 386 |[39m     
2025-02-27T19:34:55.7451026Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:34:55.7452360Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:34:55.7452891Z 
2025-02-27T19:34:55.7453449Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:34:55.7454320Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:462:38)
2025-02-27T19:34:55.7454682Z 
2025-02-27T19:34:55.7455613Z   ● ResourceManager › unlockResource › returns false for already unlocked resources
2025-02-27T19:34:55.7456162Z 
2025-02-27T19:34:55.7456828Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:34:55.7457552Z 
2025-02-27T19:34:55.7458479Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:34:55.7459856Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7461965Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:55.7463194Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:55.7463689Z      [90m 386 |[39m     
2025-02-27T19:34:55.7464625Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:34:55.7467351Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:34:55.7467853Z 
2025-02-27T19:34:55.7468292Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:34:55.7470322Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:499:38)
2025-02-27T19:34:55.7470594Z 
2025-02-27T19:34:55.7479866Z   ● ResourceManager › unlockResource › returns false for non-existent resources
2025-02-27T19:34:55.7480407Z 
2025-02-27T19:34:55.7480840Z     TypeError: Cannot read properties of undefined (reading 'non-existent')
2025-02-27T19:34:55.7481299Z 
2025-02-27T19:34:55.7481910Z     [0m [90m 383 |[39m   unlockResource(resourceId[33m:[39m string)[33m:[39m boolean {
2025-02-27T19:34:55.7482932Z      [90m 384 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7484115Z     [31m[1m>[22m[39m[90m 385 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:55.7485038Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:55.7485726Z      [90m 386 |[39m     
2025-02-27T19:34:55.7486512Z      [90m 387 |[39m     [90m// Can't unlock a resource that doesn't exist or is already unlocked[39m
2025-02-27T19:34:55.7487599Z      [90m 388 |[39m     [36mif[39m ([33m![39mresource [33m||[39m resource[33m.[39munlocked) {[0m
2025-02-27T19:34:55.7488067Z 
2025-02-27T19:34:55.7488499Z       at ResourceManager.unlockResource (src/systems/resourceManager.ts:385:37)
2025-02-27T19:34:55.7489309Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:527:38)
2025-02-27T19:34:55.7489733Z 
2025-02-27T19:34:55.7490478Z   ● ResourceManager › addResourceAmount and setResourceAmount › addResourceAmount adds to existing resource
2025-02-27T19:34:55.7491132Z 
2025-02-27T19:34:55.7491520Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:34:55.7491984Z 
2025-02-27T19:34:55.7492759Z     [0m [90m 407 |[39m   addResourceAmount(resourceId[33m:[39m string[33m,[39m amount[33m:[39m number)[33m:[39m boolean {
2025-02-27T19:34:55.7493935Z      [90m 408 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7497260Z     [31m[1m>[22m[39m[90m 409 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:55.7498329Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:55.7498842Z      [90m 410 |[39m     
2025-02-27T19:34:55.7500882Z      [90m 411 |[39m     [90m// Can't add to a resource that doesn't exist[39m
2025-02-27T19:34:55.7502155Z      [90m 412 |[39m     [36mif[39m ([33m![39mresource) {[0m
2025-02-27T19:34:55.7502510Z 
2025-02-27T19:34:55.7504007Z       at ResourceManager.addResourceAmount (src/systems/resourceManager.ts:409:37)
2025-02-27T19:34:55.7505527Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:560:38)
2025-02-27T19:34:55.7505956Z 
2025-02-27T19:34:55.7508668Z   ● ResourceManager › addResourceAmount and setResourceAmount › setResourceAmount sets absolute value for resource
2025-02-27T19:34:55.7509936Z 
2025-02-27T19:34:55.7510345Z     TypeError: Cannot read properties of undefined (reading 'test-resource')
2025-02-27T19:34:55.7510805Z 
2025-02-27T19:34:55.7513026Z     [0m [90m 431 |[39m   setResourceAmount(resourceId[33m:[39m string[33m,[39m amount[33m:[39m number)[33m:[39m boolean {
2025-02-27T19:34:55.7515038Z      [90m 432 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7518127Z     [31m[1m>[22m[39m[90m 433 |[39m     [36mconst[39m resource [33m=[39m state[33m.[39mresources[resourceId][33m;[39m
2025-02-27T19:34:55.7519345Z      [90m     |[39m                                     [31m[1m^[22m[39m
2025-02-27T19:34:55.7519851Z      [90m 434 |[39m     
2025-02-27T19:34:55.7521619Z      [90m 435 |[39m     [90m// Can't set a resource that doesn't exist[39m
2025-02-27T19:34:55.7523060Z      [90m 436 |[39m     [36mif[39m ([33m![39mresource) {[0m
2025-02-27T19:34:55.7523414Z 
2025-02-27T19:34:55.7524810Z       at ResourceManager.setResourceAmount (src/systems/resourceManager.ts:433:37)
2025-02-27T19:34:55.7526468Z       at Object.<anonymous> (src/systems/resourceManager.test.ts:598:38)
2025-02-27T19:34:55.7526901Z 
2025-02-27T19:34:55.7544465Z FAIL src/managers/progression/ProgressionManager.test.ts (9.285 s)
2025-02-27T19:34:55.7546757Z   ● ProgressionManager › checkRequirements › should return true when all requirements are met
2025-02-27T19:34:55.7547361Z 
2025-02-27T19:34:55.7547650Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7548008Z 
2025-02-27T19:34:55.7548143Z     Expected: true
2025-02-27T19:34:55.7548450Z     Received: false
2025-02-27T19:34:55.7548645Z 
2025-02-27T19:34:55.7549247Z     [0m [90m 49 |[39m       ][33m;[39m
2025-02-27T19:34:55.7549683Z      [90m 50 |[39m
2025-02-27T19:34:55.7553787Z     [31m[1m>[22m[39m[90m 51 |[39m       expect(manager[33m.[39mcheckRequirements(requirements))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7555340Z      [90m    |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:34:55.7558008Z      [90m 52 |[39m       expect(mockEvaluate)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)[33m;[39m
2025-02-27T19:34:55.7558749Z      [90m 53 |[39m     })[33m;[39m
2025-02-27T19:34:55.7559171Z      [90m 54 |[39m[0m
2025-02-27T19:34:55.7559379Z 
2025-02-27T19:34:55.7561214Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:51:55)
2025-02-27T19:34:55.7561741Z 
2025-02-27T19:34:55.7563278Z   ● ProgressionManager › checkRequirements › should return false if any requirement is not met
2025-02-27T19:34:55.7563882Z 
2025-02-27T19:34:55.7564164Z     expect(jest.fn()).toHaveBeenCalledTimes(expected)
2025-02-27T19:34:55.7564518Z 
2025-02-27T19:34:55.7564708Z     Expected number of calls: 2
2025-02-27T19:34:55.7565547Z     Received number of calls: 0
2025-02-27T19:34:55.7565805Z 
2025-02-27T19:34:55.7566122Z     [0m [90m 76 |[39m
2025-02-27T19:34:55.7569757Z      [90m 77 |[39m       expect(manager[33m.[39mcheckRequirements(requirements))[33m.[39mtoBe([36mfalse[39m)[33m;[39m
2025-02-27T19:34:55.7572357Z     [31m[1m>[22m[39m[90m 78 |[39m       expect(mockEvaluate)[33m.[39mtoHaveBeenCalledTimes([35m2[39m)[33m;[39m
2025-02-27T19:34:55.7573288Z      [90m    |[39m                            [31m[1m^[22m[39m
2025-02-27T19:34:55.7573970Z      [90m 79 |[39m     })[33m;[39m
2025-02-27T19:34:55.7574438Z      [90m 80 |[39m
2025-02-27T19:34:55.7577701Z      [90m 81 |[39m     it([32m'should handle empty requirements array'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:34:55.7578158Z 
2025-02-27T19:34:55.7579263Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:78:28)
2025-02-27T19:34:55.7579775Z 
2025-02-27T19:34:55.7581716Z   ● ProgressionManager › evaluateRequirement › should correctly evaluate gameStage requirement
2025-02-27T19:34:55.7582419Z 
2025-02-27T19:34:55.7582913Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7583280Z 
2025-02-27T19:34:55.7583406Z     Expected: true
2025-02-27T19:34:55.7583720Z     Received: false
2025-02-27T19:34:55.7584549Z 
2025-02-27T19:34:55.7584877Z     [0m [90m 116 |[39m
2025-02-27T19:34:55.7587095Z      [90m 117 |[39m       [90m// Use the private method for testing[39m
2025-02-27T19:34:55.7591230Z     [31m[1m>[22m[39m[90m 118 |[39m       expect((manager [36mas[39m any)[33m.[39mevaluateRequirement(requirement))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7592937Z      [90m     |[39m                                                                 [31m[1m^[22m[39m
2025-02-27T19:34:55.7593541Z      [90m 119 |[39m     })[33m;[39m
2025-02-27T19:34:55.7593974Z      [90m 120 |[39m
2025-02-27T19:34:55.7597108Z      [90m 121 |[39m     it([32m'should handle unknown requirement types'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:34:55.7597619Z 
2025-02-27T19:34:55.7598656Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:118:65)
2025-02-27T19:34:55.7599188Z 
2025-02-27T19:34:55.7601085Z   ● ProgressionManager › completeMilestone › should complete a milestone when requirements are met
2025-02-27T19:34:55.7601606Z 
2025-02-27T19:34:55.7601979Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7602381Z 
2025-02-27T19:34:55.7602528Z     Expected: true
2025-02-27T19:34:55.7602832Z     Received: false
2025-02-27T19:34:55.7603024Z 
2025-02-27T19:34:55.7603217Z     [0m [90m 143 |[39m
2025-02-27T19:34:55.7604725Z      [90m 144 |[39m       [90m// Complete the milestone[39m
2025-02-27T19:34:55.7608967Z     [31m[1m>[22m[39m[90m 145 |[39m       expect(manager[33m.[39mcompleteMilestone([32m'milestone1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7610415Z      [90m     |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:34:55.7612476Z      [90m 146 |[39m       expect(completeMilestone)[33m.[39mtoHaveBeenCalledWith({
2025-02-27T19:34:55.7613910Z      [90m 147 |[39m         id[33m:[39m [32m'milestone1'[39m[33m,[39m
2025-02-27T19:34:55.7615722Z      [90m 148 |[39m         completedAt[33m:[39m [35m1000[39m[0m
2025-02-27T19:34:55.7616097Z 
2025-02-27T19:34:55.7617702Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:145:55)
2025-02-27T19:34:55.7618220Z 
2025-02-27T19:34:55.7620201Z   ● ProgressionManager › completeMilestone › should not complete a milestone that is already completed
2025-02-27T19:34:55.7621353Z 
2025-02-27T19:34:55.7621637Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7621998Z 
2025-02-27T19:34:55.7622127Z     Expected: true
2025-02-27T19:34:55.7622436Z     Received: false
2025-02-27T19:34:55.7622607Z 
2025-02-27T19:34:55.7623411Z     [0m [90m 163 |[39m       [90m// Attempt to complete the milestone[39m
2025-02-27T19:34:55.7626220Z      [90m 164 |[39m       [90m// The implementation now returns true regardless of completion status[39m
2025-02-27T19:34:55.7629844Z     [31m[1m>[22m[39m[90m 165 |[39m       expect(manager[33m.[39mcompleteMilestone([32m'milestone1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7631317Z      [90m     |[39m                                                       [31m[1m^[22m[39m
2025-02-27T19:34:55.7634478Z      [90m 166 |[39m       [90m// The implementation now calls completeMilestone even for already completed milestones[39m
2025-02-27T19:34:55.7636455Z      [90m 167 |[39m       expect(completeMilestone)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:34:55.7637197Z      [90m 168 |[39m     })[33m;[39m[0m
2025-02-27T19:34:55.7637481Z 
2025-02-27T19:34:55.7639000Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:165:55)
2025-02-27T19:34:55.7639553Z 
2025-02-27T19:34:55.7641673Z   ● ProgressionManager › unlockAchievement › should unlock an achievement when requirements are met
2025-02-27T19:34:55.7642523Z 
2025-02-27T19:34:55.7642799Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7643159Z 
2025-02-27T19:34:55.7643284Z     Expected: true
2025-02-27T19:34:55.7643594Z     Received: false
2025-02-27T19:34:55.7643801Z 
2025-02-27T19:34:55.7644047Z     [0m [90m 184 |[39m
2025-02-27T19:34:55.7645271Z      [90m 185 |[39m       [90m// Unlock the achievement[39m
2025-02-27T19:34:55.7649563Z     [31m[1m>[22m[39m[90m 186 |[39m       expect(manager[33m.[39munlockAchievement([32m'achievement1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7650979Z      [90m     |[39m                                                         [31m[1m^[22m[39m
2025-02-27T19:34:55.7653063Z      [90m 187 |[39m       expect(unlockAchievement)[33m.[39mtoHaveBeenCalledWith({
2025-02-27T19:34:55.7654562Z      [90m 188 |[39m         id[33m:[39m [32m'achievement1'[39m[33m,[39m
2025-02-27T19:34:55.7656316Z      [90m 189 |[39m         unlockedAt[33m:[39m [35m1000[39m[0m
2025-02-27T19:34:55.7656676Z 
2025-02-27T19:34:55.7658421Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:186:57)
2025-02-27T19:34:55.7658940Z 
2025-02-27T19:34:55.7660974Z   ● ProgressionManager › unlockAchievement › should not unlock an achievement that is already unlocked
2025-02-27T19:34:55.7661822Z 
2025-02-27T19:34:55.7662188Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7662545Z 
2025-02-27T19:34:55.7662669Z     Expected: true
2025-02-27T19:34:55.7662981Z     Received: false
2025-02-27T19:34:55.7663100Z 
2025-02-27T19:34:55.7664207Z     [0m [90m 204 |[39m       [90m// Attempt to unlock the achievement[39m
2025-02-27T19:34:55.7666960Z      [90m 205 |[39m       [90m// The implementation now returns true regardless of unlock status[39m
2025-02-27T19:34:55.7670665Z     [31m[1m>[22m[39m[90m 206 |[39m       expect(manager[33m.[39munlockAchievement([32m'achievement1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7672152Z      [90m     |[39m                                                         [31m[1m^[22m[39m
2025-02-27T19:34:55.7675503Z      [90m 207 |[39m       [90m// The implementation now calls unlockAchievement even for already unlocked achievements[39m
2025-02-27T19:34:55.7677107Z      [90m 208 |[39m       expect(unlockAchievement)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:34:55.7677965Z      [90m 209 |[39m     })[33m;[39m[0m
2025-02-27T19:34:55.7678241Z 
2025-02-27T19:34:55.7680243Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:206:57)
2025-02-27T19:34:55.7680749Z 
2025-02-27T19:34:55.7682916Z   ● ProgressionManager › shouldFeatureBeUnlocked › should return true if a completed milestone unlocks the feature
2025-02-27T19:34:55.7683631Z 
2025-02-27T19:34:55.7683905Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7684271Z 
2025-02-27T19:34:55.7684396Z     Expected: true
2025-02-27T19:34:55.7684713Z     Received: false
2025-02-27T19:34:55.7684904Z 
2025-02-27T19:34:55.7685283Z     [0m [90m 288 |[39m       
2025-02-27T19:34:55.7686985Z      [90m 289 |[39m       [90m// Check if feature should be unlocked[39m
2025-02-27T19:34:55.7691233Z     [31m[1m>[22m[39m[90m 290 |[39m       expect(manager[33m.[39mshouldFeatureBeUnlocked([32m'feature1'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7692670Z      [90m     |[39m                                                           [31m[1m^[22m[39m
2025-02-27T19:34:55.7693335Z      [90m 291 |[39m     })[33m;[39m
2025-02-27T19:34:55.7693760Z      [90m 292 |[39m
2025-02-27T19:34:55.7697876Z      [90m 293 |[39m     it([32m'should return false if no completed milestone unlocks the feature'[39m[33m,[39m () [33m=>[39m {[0m
2025-02-27T19:34:55.7698313Z 
2025-02-27T19:34:55.7699225Z       at Object.<anonymous> (src/managers/progression/ProgressionManager.test.ts:290:59)
2025-02-27T19:34:55.7699892Z 
2025-02-27T19:34:55.7700555Z FAIL src/systems/__tests__/buildingManager.test.ts
2025-02-27T19:34:55.7702452Z   ● BuildingManager › initialization › should initialize a building
2025-02-27T19:34:55.7702886Z 
2025-02-27T19:34:55.7703331Z     TypeError: this.actions.addStructure is not a function
2025-02-27T19:34:55.7703805Z 
2025-02-27T19:34:55.7704239Z     [0m [90m 139 |[39m     }
2025-02-27T19:34:55.7704648Z      [90m 140 |[39m     
2025-02-27T19:34:55.7708890Z     [31m[1m>[22m[39m[90m 141 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddStructure(building))[33m;[39m
2025-02-27T19:34:55.7709721Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:34:55.7710348Z      [90m 142 |[39m   }
2025-02-27T19:34:55.7710859Z      [90m 143 |[39m   
2025-02-27T19:34:55.7711752Z      [90m 144 |[39m   [90m/**[39m[0m
2025-02-27T19:34:55.7712026Z 
2025-02-27T19:34:55.7713854Z       at BuildingManager.initializeBuilding (src/systems/buildingManager.ts:141:32)
2025-02-27T19:34:55.7715539Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:73:23)
2025-02-27T19:34:55.7716031Z 
2025-02-27T19:34:55.7717575Z   ● BuildingManager › initialization › should initialize multiple buildings
2025-02-27T19:34:55.7718073Z 
2025-02-27T19:34:55.7718395Z     TypeError: this.actions.addStructure is not a function
2025-02-27T19:34:55.7718775Z 
2025-02-27T19:34:55.7719004Z     [0m [90m 139 |[39m     }
2025-02-27T19:34:55.7719398Z      [90m 140 |[39m     
2025-02-27T19:34:55.7723778Z     [31m[1m>[22m[39m[90m 141 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39maddStructure(building))[33m;[39m
2025-02-27T19:34:55.7726089Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:34:55.7726699Z      [90m 142 |[39m   }
2025-02-27T19:34:55.7727061Z      [90m 143 |[39m   
2025-02-27T19:34:55.7727658Z      [90m 144 |[39m   [90m/**[39m[0m
2025-02-27T19:34:55.7727929Z 
2025-02-27T19:34:55.7729464Z       at BuildingManager.initializeBuilding (src/systems/buildingManager.ts:141:32)
2025-02-27T19:34:55.7730305Z       at src/systems/buildingManager.ts:153:40
2025-02-27T19:34:55.7730891Z           at Array.forEach (<anonymous>)
2025-02-27T19:34:55.7732873Z       at BuildingManager.initializeBuildings (src/systems/buildingManager.ts:153:15)
2025-02-27T19:34:55.7734457Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:108:23)
2025-02-27T19:34:55.7734929Z 
2025-02-27T19:34:55.7737106Z   ● BuildingManager › purchase validation › should correctly validate if player can afford a building
2025-02-27T19:34:55.7737566Z 
2025-02-27T19:34:55.7738239Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:34:55.7738795Z 
2025-02-27T19:34:55.7739036Z     [0m [90m 165 |[39m     
2025-02-27T19:34:55.7741267Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7744058Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7745316Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7745938Z      [90m 168 |[39m     
2025-02-27T19:34:55.7748188Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:34:55.7751868Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:34:55.7752397Z 
2025-02-27T19:34:55.7756223Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:34:55.7757168Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:160:39)
2025-02-27T19:34:55.7757633Z 
2025-02-27T19:34:55.7758264Z   ● BuildingManager › purchase validation › should return false for non-existent buildings
2025-02-27T19:34:55.7759022Z 
2025-02-27T19:34:55.7759418Z     TypeError: Cannot read properties of undefined (reading 'non_existent')
2025-02-27T19:34:55.7759867Z 
2025-02-27T19:34:55.7760108Z     [0m [90m 165 |[39m     
2025-02-27T19:34:55.7760914Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7762848Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7764252Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7764764Z      [90m 168 |[39m     
2025-02-27T19:34:55.7767302Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:34:55.7769726Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:34:55.7770264Z 
2025-02-27T19:34:55.7771008Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:34:55.7772668Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:193:38)
2025-02-27T19:34:55.7773152Z 
2025-02-27T19:34:55.7774817Z   ● BuildingManager › purchase validation › should return false for locked buildings
2025-02-27T19:34:55.7775476Z 
2025-02-27T19:34:55.7776137Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:34:55.7776598Z 
2025-02-27T19:34:55.7776835Z     [0m [90m 165 |[39m     
2025-02-27T19:34:55.7779436Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7782237Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7783327Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7783849Z      [90m 168 |[39m     
2025-02-27T19:34:55.7786374Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:34:55.7788967Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:34:55.7789355Z 
2025-02-27T19:34:55.7790159Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:34:55.7792036Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:226:38)
2025-02-27T19:34:55.7792520Z 
2025-02-27T19:34:55.7793729Z   ● BuildingManager › purchasing › should purchase a building and deduct resources
2025-02-27T19:34:55.7794214Z 
2025-02-27T19:34:55.7795286Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:34:55.7795855Z 
2025-02-27T19:34:55.7796096Z     [0m [90m 197 |[39m     
2025-02-27T19:34:55.7798304Z      [90m 198 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7801136Z     [31m[1m>[22m[39m[90m 199 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7802301Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7802824Z      [90m 200 |[39m     
2025-02-27T19:34:55.7804359Z      [90m 201 |[39m     [90m// Deduct resources[39m
2025-02-27T19:34:55.7808530Z      [90m 202 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mdeductResources(building[33m.[39mcost))[33m;[39m[0m
2025-02-27T19:34:55.7809080Z 
2025-02-27T19:34:55.7809533Z       at BuildingManager.purchaseBuilding (src/systems/buildingManager.ts:199:38)
2025-02-27T19:34:55.7810988Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:273:38)
2025-02-27T19:34:55.7811474Z 
2025-02-27T19:34:55.7813785Z   ● BuildingManager › production calculation › should correctly calculate production based on level and workers
2025-02-27T19:34:55.7814562Z 
2025-02-27T19:34:55.7814964Z     TypeError: Cannot read properties of undefined (reading 'test_building')
2025-02-27T19:34:55.7815576Z 
2025-02-27T19:34:55.7815823Z     [0m [90m 222 |[39m     
2025-02-27T19:34:55.7818012Z      [90m 223 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.7820849Z     [31m[1m>[22m[39m[90m 224 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.7821898Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7822406Z      [90m 225 |[39m     
2025-02-27T19:34:55.7823731Z      [90m 226 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.7824995Z      [90m 227 |[39m       [36mreturn[39m[33m;[39m[0m
2025-02-27T19:34:55.7825458Z 
2025-02-27T19:34:55.7827047Z       at BuildingManager.recalculateProduction (src/systems/buildingManager.ts:224:38)
2025-02-27T19:34:55.7828518Z       at Object.<anonymous> (src/systems/__tests__/buildingManager.test.ts:329:23)
2025-02-27T19:34:55.7828995Z 
2025-02-27T19:34:55.7830268Z FAIL src/systems/__tests__/saveManager.test.ts
2025-02-27T19:34:55.7831217Z   ● SaveManager › loadGame › should dispatch actions to restore game state
2025-02-27T19:34:55.7831684Z 
2025-02-27T19:34:55.7832007Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7832390Z 
2025-02-27T19:34:55.7832527Z     Expected: true
2025-02-27T19:34:55.7832873Z     Received: false
2025-02-27T19:34:55.7833081Z 
2025-02-27T19:34:55.7833335Z     [0m [90m 178 |[39m       
2025-02-27T19:34:55.7833882Z      [90m 179 |[39m       [90m// Assert[39m
2025-02-27T19:34:55.7834779Z     [31m[1m>[22m[39m[90m 180 |[39m       expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7835753Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7836315Z      [90m 181 |[39m       
2025-02-27T19:34:55.7837058Z      [90m 182 |[39m       [90m// Verify reset actions were dispatched[39m
2025-02-27T19:34:55.7839094Z      [90m 183 |[39m       expect(mockDispatch)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[0m
2025-02-27T19:34:55.7839767Z 
2025-02-27T19:34:55.7840116Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:180:22)
2025-02-27T19:34:55.7840399Z 
2025-02-27T19:34:55.7841565Z   ● SaveManager › resetGame › should dispatch reset actions for all state slices
2025-02-27T19:34:55.7842047Z 
2025-02-27T19:34:55.7842407Z     TypeError: this.actions.resetGame is not a function
2025-02-27T19:34:55.7842812Z 
2025-02-27T19:34:55.7844571Z     [0m [90m 217 |[39m     [36mthis[39m[33m.[39mensureInitialized()[33m;[39m
2025-02-27T19:34:55.7845294Z      [90m 218 |[39m     
2025-02-27T19:34:55.7848696Z     [31m[1m>[22m[39m[90m 219 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetGame())[33m;[39m
2025-02-27T19:34:55.7849543Z      [90m     |[39m                                [31m[1m^[22m[39m
2025-02-27T19:34:55.7853761Z      [90m 220 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetResources())[33m;[39m
2025-02-27T19:34:55.7856742Z      [90m 221 |[39m     [36mthis[39m[33m.[39mdispatch([36mthis[39m[33m.[39mactions[33m.[39mresetStructures())[33m;[39m
2025-02-27T19:34:55.7857557Z      [90m 222 |[39m   }[0m
2025-02-27T19:34:55.7857793Z 
2025-02-27T19:34:55.7858133Z       at SaveManager.resetGame (src/systems/saveManager.ts:219:32)
2025-02-27T19:34:55.7859816Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:243:19)
2025-02-27T19:34:55.7860277Z 
2025-02-27T19:34:55.7861677Z   ● SaveManager › deleteSaveAndReset › should delete the save and reset the game
2025-02-27T19:34:55.7862169Z 
2025-02-27T19:34:55.7862563Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7863149Z 
2025-02-27T19:34:55.7863283Z     Expected: true
2025-02-27T19:34:55.7863591Z     Received: false
2025-02-27T19:34:55.7863786Z 
2025-02-27T19:34:55.7864043Z     [0m [90m 265 |[39m       
2025-02-27T19:34:55.7865246Z      [90m 266 |[39m       [90m// Assert[39m
2025-02-27T19:34:55.7867937Z     [31m[1m>[22m[39m[90m 267 |[39m       expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7868957Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7871135Z      [90m 268 |[39m       expect(saveUtils[33m.[39mdeleteSave)[33m.[39mtoHaveBeenCalled()[33m;[39m
2025-02-27T19:34:55.7873735Z      [90m 269 |[39m       expect(mockDispatch)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({
2025-02-27T19:34:55.7876025Z      [90m 270 |[39m         type[33m:[39m expect[33m.[39mstringContaining([32m'game/resetGame'[39m)[0m
2025-02-27T19:34:55.7876534Z 
2025-02-27T19:34:55.7877270Z       at Object.<anonymous> (src/systems/__tests__/saveManager.test.ts:267:22)
2025-02-27T19:34:55.7877738Z 
2025-02-27T19:34:55.7878369Z FAIL src/integration/tasks.integration.test.ts
2025-02-27T19:34:55.7880187Z   ● Task System Integration › should start a task when requirements are met
2025-02-27T19:34:55.7880656Z 
2025-02-27T19:34:55.7881140Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7881493Z 
2025-02-27T19:34:55.7881641Z     Expected: true
2025-02-27T19:34:55.7881947Z     Received: false
2025-02-27T19:34:55.7882143Z 
2025-02-27T19:34:55.7885548Z     [0m [90m 151 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mstartTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:55.7886288Z      [90m 152 |[39m     
2025-02-27T19:34:55.7887910Z     [31m[1m>[22m[39m[90m 153 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7888693Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:34:55.7890939Z      [90m 154 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:55.7891872Z      [90m 155 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:55.7893935Z      [90m 156 |[39m         type[33m:[39m [32m'tasks/startTask'[39m[33m,[39m[0m
2025-02-27T19:34:55.7894347Z 
2025-02-27T19:34:55.7895385Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:153:20)
2025-02-27T19:34:55.7895860Z 
2025-02-27T19:34:55.7896972Z   ● Task System Integration › should check if task requirements are met
2025-02-27T19:34:55.7897399Z 
2025-02-27T19:34:55.7898021Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7898374Z 
2025-02-27T19:34:55.7898508Z     Expected: true
2025-02-27T19:34:55.7898812Z     Received: false
2025-02-27T19:34:55.7899008Z 
2025-02-27T19:34:55.7902381Z     [0m [90m 188 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39munlockTask([32m'locked-task'[39m)[33m;[39m
2025-02-27T19:34:55.7903090Z      [90m 189 |[39m     
2025-02-27T19:34:55.7904923Z     [31m[1m>[22m[39m[90m 190 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7905919Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:34:55.7908101Z      [90m 191 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:55.7909013Z      [90m 192 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:55.7911110Z      [90m 193 |[39m         type[33m:[39m [32m'tasks/unlockTask'[39m[33m,[39m[0m
2025-02-27T19:34:55.7911528Z 
2025-02-27T19:34:55.7912356Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:190:20)
2025-02-27T19:34:55.7912827Z 
2025-02-27T19:34:55.7913814Z   ● Task System Integration › should complete an in-progress task
2025-02-27T19:34:55.7914229Z 
2025-02-27T19:34:55.7914774Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7915277Z 
2025-02-27T19:34:55.7915613Z     Expected: true
2025-02-27T19:34:55.7915927Z     Received: false
2025-02-27T19:34:55.7916112Z 
2025-02-27T19:34:55.7919309Z     [0m [90m 214 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mcompleteTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:55.7920000Z      [90m 215 |[39m     
2025-02-27T19:34:55.7921645Z     [31m[1m>[22m[39m[90m 216 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7922632Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:34:55.7924441Z      [90m 217 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:55.7925796Z      [90m 218 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:55.7927949Z      [90m 219 |[39m         type[33m:[39m [32m'tasks/completeTask'[39m[33m,[39m[0m
2025-02-27T19:34:55.7928368Z 
2025-02-27T19:34:55.7929166Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:216:20)
2025-02-27T19:34:55.7929641Z 
2025-02-27T19:34:55.7930556Z   ● Task System Integration › should cancel an in-progress task
2025-02-27T19:34:55.7930947Z 
2025-02-27T19:34:55.7931621Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7931975Z 
2025-02-27T19:34:55.7932105Z     Expected: true
2025-02-27T19:34:55.7932408Z     Received: false
2025-02-27T19:34:55.7932589Z 
2025-02-27T19:34:55.7936054Z     [0m [90m 240 |[39m     [36mconst[39m result [33m=[39m taskManager[33m.[39mcancelTask([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:55.7936740Z      [90m 241 |[39m     
2025-02-27T19:34:55.7938392Z     [31m[1m>[22m[39m[90m 242 |[39m     expect(result)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
2025-02-27T19:34:55.7939166Z      [90m     |[39m                    [31m[1m^[22m[39m
2025-02-27T19:34:55.7941384Z      [90m 243 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:55.7942354Z      [90m 244 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:55.7944332Z      [90m 245 |[39m         type[33m:[39m [32m'tasks/cancelTask'[39m[33m,[39m[0m
2025-02-27T19:34:55.7944725Z 
2025-02-27T19:34:55.7945921Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:242:20)
2025-02-27T19:34:55.7946341Z 
2025-02-27T19:34:55.7948105Z   ● Task System Integration › should check all task requirements and unlock eligible tasks
2025-02-27T19:34:55.7948793Z 
2025-02-27T19:34:55.7949271Z     expect(received).toBe(expected) // Object.is equality
2025-02-27T19:34:55.7949652Z 
2025-02-27T19:34:55.7949794Z     Expected: 2
2025-02-27T19:34:55.7950195Z     Received: 0
2025-02-27T19:34:55.7950564Z 
2025-02-27T19:34:55.7951482Z     [0m [90m 271 |[39m     [36mconst[39m unlocked [33m=[39m taskManager[33m.[39mcheckAllTaskRequirements()[33m;[39m
2025-02-27T19:34:55.7952301Z      [90m 272 |[39m     
2025-02-27T19:34:55.7955565Z     [31m[1m>[22m[39m[90m 273 |[39m     expect(unlocked)[33m.[39mtoBe([35m2[39m)[33m;[39m [90m// Two tasks should be unlocked[39m
2025-02-27T19:34:55.7956705Z      [90m     |[39m                      [31m[1m^[22m[39m
2025-02-27T19:34:55.7957538Z      [90m 274 |[39m     expect(store[33m.[39mdispatch)[33m.[39mtoHaveBeenCalledWith(
2025-02-27T19:34:55.7958205Z      [90m 275 |[39m       expect[33m.[39mobjectContaining({
2025-02-27T19:34:55.7959033Z      [90m 276 |[39m         type[33m:[39m [32m'tasks/unlockTask'[39m[33m,[39m[0m
2025-02-27T19:34:55.7959455Z 
2025-02-27T19:34:55.7959945Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:273:22)
2025-02-27T19:34:55.7960412Z 
2025-02-27T19:34:55.7961567Z   ● Task System Integration › should emit events when task status changes
2025-02-27T19:34:55.7962003Z 
2025-02-27T19:34:55.7962550Z     expect(jest.fn()).toHaveBeenCalledWith(...expected)
2025-02-27T19:34:55.7962898Z 
2025-02-27T19:34:55.7963045Z     Expected: "test-task"
2025-02-27T19:34:55.7963267Z 
2025-02-27T19:34:55.7963489Z     Number of calls: 0
2025-02-27T19:34:55.7963913Z 
2025-02-27T19:34:55.7964217Z     [0m [90m 314 |[39m     
2025-02-27T19:34:55.7965874Z      [90m 315 |[39m     [90m// Verify events were emitted[39m
2025-02-27T19:34:55.7969304Z     [31m[1m>[22m[39m[90m 316 |[39m     expect(startedListener)[33m.[39mtoHaveBeenCalledWith([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:55.7970269Z      [90m     |[39m                             [31m[1m^[22m[39m
2025-02-27T19:34:55.7972964Z      [90m 317 |[39m     expect(completedListener)[33m.[39mtoHaveBeenCalledWith([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:55.7973809Z      [90m 318 |[39m   })[33m;[39m
2025-02-27T19:34:55.7974242Z      [90m 319 |[39m   [0m
2025-02-27T19:34:55.7974472Z 
2025-02-27T19:34:55.7975495Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:316:29)
2025-02-27T19:34:55.7975970Z 
2025-02-27T19:34:55.7977229Z   ● Task System Integration › should provide progress information for a task
2025-02-27T19:34:55.7977714Z 
2025-02-27T19:34:55.7977917Z     expect(received).not.toBeNull()
2025-02-27T19:34:55.7978195Z 
2025-02-27T19:34:55.7978324Z     Received: null
2025-02-27T19:34:55.7978512Z 
2025-02-27T19:34:55.7981851Z     [0m [90m 334 |[39m     [36mconst[39m progress [33m=[39m taskManager[33m.[39mgetTaskProgress([32m'test-task'[39m)[33m;[39m
2025-02-27T19:34:55.7982560Z      [90m 335 |[39m     
2025-02-27T19:34:55.7984312Z     [31m[1m>[22m[39m[90m 336 |[39m     expect(progress)[33m.[39mnot[33m.[39mtoBeNull()[33m;[39m
2025-02-27T19:34:55.7985414Z      [90m     |[39m                          [31m[1m^[22m[39m
2025-02-27T19:34:55.7990132Z      [90m 337 |[39m     expect(progress[33m?[39m[33m.[39mstatus)[33m.[39mtoBe([33mTaskStatus[39m[33m.[39m[33mIN_PROGRESS[39m)[33m;[39m
2025-02-27T19:34:55.7992254Z      [90m 338 |[39m     expect(progress[33m?[39m[33m.[39mprogress)[33m.[39mtoBe([35m50[39m)[33m;[39m
2025-02-27T19:34:55.7995019Z      [90m 339 |[39m     expect(progress[33m?[39m[33m.[39mtimeRemaining)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m
2025-02-27T19:34:55.7995814Z 
2025-02-27T19:34:55.7996210Z       at Object.<anonymous> (src/integration/tasks.integration.test.ts:336:26)
2025-02-27T19:34:55.7996683Z 
2025-02-27T19:34:55.7997340Z FAIL src/systems/__tests__/eventManager.test.ts
2025-02-27T19:34:55.7997894Z   ● Test suite failed to run
2025-02-27T19:34:55.7998140Z 
2025-02-27T19:34:55.8009013Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m65[0m:[93m42[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8010467Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8014077Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8015469Z 
2025-02-27T19:34:55.8015957Z     [7m65[0m     expect(() => eventManager.initialize(store)).not.toThrow();
2025-02-27T19:34:55.8016716Z     [7m  [0m [91m                                         ~~~~~[0m
2025-02-27T19:34:55.8017044Z 
2025-02-27T19:34:55.8017376Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8018706Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8019350Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8020089Z         'tutorial' is declared here.
2025-02-27T19:34:55.8031172Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m72[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8032817Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8036415Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8037853Z 
2025-02-27T19:34:55.8038207Z     [7m72[0m     eventManager.initialize(store);
2025-02-27T19:34:55.8038827Z     [7m  [0m [91m                            ~~~~~[0m
2025-02-27T19:34:55.8039127Z 
2025-02-27T19:34:55.8039464Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8040161Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8040767Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8041296Z         'tutorial' is declared here.
2025-02-27T19:34:55.8052360Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m85[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8053823Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8057573Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8058827Z 
2025-02-27T19:34:55.8059166Z     [7m85[0m     eventManager.initialize(store);
2025-02-27T19:34:55.8059789Z     [7m  [0m [91m                            ~~~~~[0m
2025-02-27T19:34:55.8060092Z 
2025-02-27T19:34:55.8060421Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8061263Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8061933Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8062619Z         'tutorial' is declared here.
2025-02-27T19:34:55.8073685Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m113[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8076197Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8078929Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8080286Z 
2025-02-27T19:34:55.8080639Z     [7m113[0m     eventManager.initialize(store);
2025-02-27T19:34:55.8081252Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:55.8081560Z 
2025-02-27T19:34:55.8081891Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8082603Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8083263Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8083969Z         'tutorial' is declared here.
2025-02-27T19:34:55.8094923Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m131[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8097570Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8100237Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8101670Z 
2025-02-27T19:34:55.8102027Z     [7m131[0m     eventManager.initialize(store);
2025-02-27T19:34:55.8102643Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:55.8102951Z 
2025-02-27T19:34:55.8103277Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8103976Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8104599Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8105409Z         'tutorial' is declared here.
2025-02-27T19:34:55.8116607Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m165[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8118071Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8121732Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8123105Z 
2025-02-27T19:34:55.8123455Z     [7m165[0m     eventManager.initialize(store);
2025-02-27T19:34:55.8124082Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:55.8124390Z 
2025-02-27T19:34:55.8124794Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8126694Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8127323Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8127763Z         'tutorial' is declared here.
2025-02-27T19:34:55.8138660Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m185[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8140136Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8143778Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8145014Z 
2025-02-27T19:34:55.8145492Z     [7m185[0m     eventManager.initialize(store);
2025-02-27T19:34:55.8146113Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:55.8146410Z 
2025-02-27T19:34:55.8146739Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8147649Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8148350Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8149005Z         'tutorial' is declared here.
2025-02-27T19:34:55.8160156Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m226[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8162745Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8165564Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8167068Z 
2025-02-27T19:34:55.8167419Z     [7m226[0m     eventManager.initialize(store);
2025-02-27T19:34:55.8168037Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:55.8168336Z 
2025-02-27T19:34:55.8168670Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8169367Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8169961Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8170615Z         'tutorial' is declared here.
2025-02-27T19:34:55.8181659Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m258[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8184018Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8186865Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8188212Z 
2025-02-27T19:34:55.8188637Z     [7m258[0m     eventManager.initialize(store);
2025-02-27T19:34:55.8189246Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:55.8189541Z 
2025-02-27T19:34:55.8189876Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8190565Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8191230Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8191922Z         'tutorial' is declared here.
2025-02-27T19:34:55.8203108Z     [96msrc/systems/__tests__/eventManager.test.ts[0m:[93m284[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8205562Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8208191Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; structures: StructuresState; game: GameState; tasks: TasksState; events: EventsState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8209443Z 
2025-02-27T19:34:55.8209782Z     [7m284[0m     eventManager.initialize(store);
2025-02-27T19:34:55.8210394Z     [7m   [0m [91m                            ~~~~~[0m
2025-02-27T19:34:55.8210692Z 
2025-02-27T19:34:55.8211022Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8211818Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8212449Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8213180Z         'tutorial' is declared here.
2025-02-27T19:34:55.8213453Z 
2025-02-27T19:34:55.8214433Z FAIL src/systems/__tests__/gameLoop.test.ts
2025-02-27T19:34:55.8214991Z   ● Test suite failed to run
2025-02-27T19:34:55.8215405Z 
2025-02-27T19:34:55.8226145Z     [96msrc/systems/__tests__/gameLoop.test.ts[0m:[93m87[0m:[93m25[0m - [91merror[0m[90m TS2345: [0mArgument of type 'EnhancedStore<{ resources: ResourcesState; game: GameState; structures: StructuresState; events: EventsState; tasks: TasksState; progression: ProgressionState; }, UnknownAction, Tuple<...>>' is not assignable to parameter of type 'Store<RootState, UnknownAction, unknown>'.
2025-02-27T19:34:55.8227768Z       The types returned by 'getState()' are incompatible between these types.
2025-02-27T19:34:55.8231299Z         Property 'tutorial' is missing in type '{ resources: ResourcesState; game: GameState; structures: StructuresState; events: EventsState; tasks: TasksState; progression: ProgressionState; }' but required in type 'RootState'.
2025-02-27T19:34:55.8232736Z 
2025-02-27T19:34:55.8233069Z     [7m87[0m     gameLoop.initialize(store);
2025-02-27T19:34:55.8233652Z     [7m  [0m [91m                        ~~~~~[0m
2025-02-27T19:34:55.8233949Z 
2025-02-27T19:34:55.8234278Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8234975Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8235750Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8236219Z         'tutorial' is declared here.
2025-02-27T19:34:55.8237155Z 
2025-02-27T19:34:55.8237421Z FAIL src/gameCore.integration.test.tsx
2025-02-27T19:34:55.8239682Z   ● Game Core Systems Integration › Building purchase consumes resources correctly
2025-02-27T19:34:55.8240209Z 
2025-02-27T19:34:55.8240885Z     TypeError: Cannot read properties of undefined (reading 'communityGarden')
2025-02-27T19:34:55.8241387Z 
2025-02-27T19:34:55.8241631Z     [0m [90m 165 |[39m     
2025-02-27T19:34:55.8244026Z      [90m 166 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.8246945Z     [31m[1m>[22m[39m[90m 167 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.8248038Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.8248545Z      [90m 168 |[39m     
2025-02-27T19:34:55.8250933Z      [90m 169 |[39m     [90m// If building doesn't exist or is not unlocked, return false[39m
2025-02-27T19:34:55.8253485Z      [90m 170 |[39m     [36mif[39m ([33m![39mbuilding [33m||[39m [33m![39mbuilding[33m.[39munlocked) {[0m
2025-02-27T19:34:55.8253933Z 
2025-02-27T19:34:55.8254705Z       at BuildingManager.canPurchaseBuilding (src/systems/buildingManager.ts:167:38)
2025-02-27T19:34:55.8256609Z       at BuildingManager.purchaseBuilding (src/systems/buildingManager.ts:194:58)
2025-02-27T19:34:55.8259001Z       at Object.<anonymous> (src/gameCore.integration.test.tsx:171:36)
2025-02-27T19:34:55.8259423Z 
2025-02-27T19:34:55.8260636Z   ● Game Core Systems Integration › Building level affects production calculation
2025-02-27T19:34:55.8261617Z 
2025-02-27T19:34:55.8262203Z     TypeError: Cannot read properties of undefined (reading 'communityGarden')
2025-02-27T19:34:55.8262769Z 
2025-02-27T19:34:55.8263012Z     [0m [90m 274 |[39m     
2025-02-27T19:34:55.8265354Z      [90m 275 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.8268146Z     [31m[1m>[22m[39m[90m 276 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.8269249Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.8269942Z      [90m 277 |[39m     
2025-02-27T19:34:55.8270811Z      [90m 278 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.8271465Z      [90m 279 |[39m       [36mreturn[39m {}[33m;[39m[0m
2025-02-27T19:34:55.8271778Z 
2025-02-27T19:34:55.8273615Z       at BuildingManager.calculateUpgradeCost (src/systems/buildingManager.ts:276:38)
2025-02-27T19:34:55.8274672Z       at Object.<anonymous> (src/gameCore.integration.test.tsx:209:41)
2025-02-27T19:34:55.8275238Z 
2025-02-27T19:34:55.8275676Z FAIL src/state/selectors.test.ts
2025-02-27T19:34:55.8276277Z   ● Test suite failed to run
2025-02-27T19:34:55.8276735Z 
2025-02-27T19:34:55.8290631Z     [96msrc/state/selectors.test.ts[0m:[93m94[0m:[93m32[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ resources: { 'collective-power': Resource; solidarity: Resource; 'community-trust': Resource; }; structures: { 'union-office': Structure; 'community-center': Structure; 'alternative-media': Structure; }; game: { ...; }; tasks: { ...; }; events: { ...; }; progression: { ...; }; }' to type 'RootState' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
2025-02-27T19:34:55.8297564Z       Property 'tutorial' is missing in type '{ resources: { 'collective-power': Resource; solidarity: Resource; 'community-trust': Resource; }; structures: { 'union-office': Structure; 'community-center': Structure; 'alternative-media': Structure; }; game: { ...; }; tasks: { ...; }; events: { ...; }; progression: { ...; }; }' but required in type 'RootState'.
2025-02-27T19:34:55.8299235Z 
2025-02-27T19:34:55.8299583Z     [7m 94[0m   const mockState: RootState = {
2025-02-27T19:34:55.8300185Z     [7m   [0m [91m                               ~[0m
2025-02-27T19:34:55.8300712Z     [7m 95[0m     resources: {
2025-02-27T19:34:55.8301194Z     [7m   [0m [91m~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:55.8301619Z     [7m...[0m 
2025-02-27T19:34:55.8301962Z     [7m163[0m     }
2025-02-27T19:34:55.8302373Z     [7m   [0m [91m~~~~~[0m
2025-02-27T19:34:55.8302839Z     [7m164[0m   } as RootState;
2025-02-27T19:34:55.8303325Z     [7m   [0m [91m~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:55.8303593Z 
2025-02-27T19:34:55.8303922Z       [96msrc/state/store.ts[0m:[93m58[0m:[93m3[0m
2025-02-27T19:34:55.8305355Z         [7m58[0m   tutorial: ReturnType<typeof tutorialReducer>,
2025-02-27T19:34:55.8305998Z         [7m  [0m [96m  ~~~~~~~~[0m
2025-02-27T19:34:55.8306704Z         'tutorial' is declared here.
2025-02-27T19:34:55.8306975Z 
2025-02-27T19:34:55.8307790Z FAIL src/workers.integration.test.tsx
2025-02-27T19:34:55.8310011Z   ● Worker System Integration Test › WorkerManager can assign and manage workers
2025-02-27T19:34:55.8310516Z 
2025-02-27T19:34:55.8311030Z     TypeError: Cannot read properties of undefined (reading 'building1')
2025-02-27T19:34:55.8311489Z 
2025-02-27T19:34:55.8311726Z     [0m [90m 190 |[39m     
2025-02-27T19:34:55.8314207Z      [90m 191 |[39m     [36mconst[39m state [33m=[39m [36mthis[39m[33m.[39mgetState()[33m;[39m
2025-02-27T19:34:55.8317146Z     [31m[1m>[22m[39m[90m 192 |[39m     [36mconst[39m building [33m=[39m state[33m.[39mstructures[buildingId][33m;[39m
2025-02-27T19:34:55.8318217Z      [90m     |[39m                                      [31m[1m^[22m[39m
2025-02-27T19:34:55.8318733Z      [90m 193 |[39m     
2025-02-27T19:34:55.8319949Z      [90m 194 |[39m     [36mif[39m ([33m![39mbuilding) {
2025-02-27T19:34:55.8321837Z      [90m 195 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m[0m
2025-02-27T19:34:55.8322222Z 
2025-02-27T19:34:55.8323273Z       at WorkerManager.assignWorkersToBuilding (src/systems/workerManager.ts:192:38)
2025-02-27T19:34:55.8324649Z       at Object.<anonymous> (src/workers.integration.test.tsx:105:19)
2025-02-27T19:34:55.8325065Z 
2025-02-27T19:34:55.8325924Z FAIL src/systems/__tests__/oppressionSystem.test.ts
2025-02-27T19:34:55.8328098Z   ● Oppression System › oppression resource should generate at the specified rate
2025-02-27T19:34:55.8328575Z 
2025-02-27T19:34:55.8329048Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:55.8329563Z 
2025-02-27T19:34:55.8329806Z     [0m [90m 178 |[39m     
2025-02-27T19:34:55.8332382Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:55.8339098Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:55.8341050Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:55.8341562Z      [90m 181 |[39m     
2025-02-27T19:34:55.8341940Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:55.8343055Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:55.8343689Z 
2025-02-27T19:34:55.8344617Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:55.8346642Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:67:21)
2025-02-27T19:34:55.8347134Z 
2025-02-27T19:34:55.8348219Z   ● Oppression System › oppression should continue to generate in multiple ticks
2025-02-27T19:34:55.8348703Z 
2025-02-27T19:34:55.8349336Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:55.8349751Z 
2025-02-27T19:34:55.8349991Z     [0m [90m 178 |[39m     
2025-02-27T19:34:55.8352849Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:55.8359583Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:55.8361213Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:55.8361726Z      [90m 181 |[39m     
2025-02-27T19:34:55.8362238Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:55.8363395Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:55.8363842Z 
2025-02-27T19:34:55.8365054Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:55.8367060Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:85:23)
2025-02-27T19:34:55.8367551Z 
2025-02-27T19:34:55.8368941Z   ● Oppression System › oppression should generate even if its perSecond property is modified
2025-02-27T19:34:55.8369508Z 
2025-02-27T19:34:55.8370049Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:55.8370469Z 
2025-02-27T19:34:55.8370705Z     [0m [90m 178 |[39m     
2025-02-27T19:34:55.8373531Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:55.8380232Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:55.8381785Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:55.8382326Z      [90m 181 |[39m     
2025-02-27T19:34:55.8382839Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:55.8384111Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:55.8384603Z 
2025-02-27T19:34:55.8386061Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:55.8387557Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:107:21)
2025-02-27T19:34:55.8388048Z 
2025-02-27T19:34:55.8389572Z   ● Oppression System › oppression generation should scale with time delta correctly
2025-02-27T19:34:55.8390085Z 
2025-02-27T19:34:55.8390571Z     TypeError: Cannot read properties of undefined (reading 'byId')
2025-02-27T19:34:55.8390982Z 
2025-02-27T19:34:55.8391202Z     [0m [90m 178 |[39m     
2025-02-27T19:34:55.8394985Z      [90m 179 |[39m     [90m// Special handling for oppression resource - always ensure it's generated[39m
2025-02-27T19:34:55.8401719Z     [31m[1m>[22m[39m[90m 180 |[39m     [36mconst[39m oppression [33m=[39m resources[33m.[39mbyId [33m?[39m resources[33m.[39mbyId[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m] [33m:[39m resources[[33mResourceId[39m[33m.[39m[33mOPPRESSION[39m][33m;[39m
2025-02-27T19:34:55.8403252Z      [90m     |[39m                                  [31m[1m^[22m[39m
2025-02-27T19:34:55.8403992Z      [90m 181 |[39m     
2025-02-27T19:34:55.8404522Z      [90m 182 |[39m     [36mif[39m (oppression) {
2025-02-27T19:34:55.8405671Z      [90m 183 |[39m       [90m// Get the oppression rate from game balance config[39m[0m
2025-02-27T19:34:55.8406123Z 
2025-02-27T19:34:55.8407205Z       at ResourceManager.updateResources (src/systems/resourceManager.ts:180:34)
2025-02-27T19:34:55.8409180Z       at Object.<anonymous> (src/systems/__tests__/oppressionSystem.test.ts:127:23)
2025-02-27T19:34:55.8409681Z 
2025-02-27T19:34:55.8409912Z FAIL src/components/App.test.tsx
2025-02-27T19:34:55.8410424Z   ● Test suite failed to run
2025-02-27T19:34:55.8410676Z 
2025-02-27T19:34:55.8414655Z     [96msrc/managers/TutorialManager.ts[0m:[93m3[0m:[93m10[0m - [91merror[0m[90m TS2305: [0mModule '"../state/store"' has no exported member 'AppState'.
2025-02-27T19:34:55.8415613Z 
2025-02-27T19:34:55.8415974Z     [7m3[0m import { AppState } from '../state/store';
2025-02-27T19:34:55.8416540Z     [7m [0m [91m         ~~~~~~~~[0m
2025-02-27T19:34:55.8422249Z     [96msrc/managers/TutorialManager.ts[0m:[93m79[0m:[93m24[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:34:55.8423423Z 
2025-02-27T19:34:55.8423822Z     [7m79[0m       const tutorial = tutorialContent[currentStep];
2025-02-27T19:34:55.8424576Z     [7m  [0m [91m                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:55.8430336Z     [96msrc/managers/TutorialManager.ts[0m:[93m99[0m:[93m24[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:34:55.8431513Z 
2025-02-27T19:34:55.8431905Z     [7m99[0m       const tutorial = tutorialContent[currentStep];
2025-02-27T19:34:55.8432605Z     [7m  [0m [91m                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:55.8438363Z     [96msrc/managers/TutorialManager.ts[0m:[93m155[0m:[93m14[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'any' can't be used to index type 'Record<TutorialStep, TutorialContent>'.
2025-02-27T19:34:55.8439724Z 
2025-02-27T19:34:55.8440097Z     [7m155[0m       return tutorialContent[currentStep];
2025-02-27T19:34:55.8440752Z     [7m   [0m [91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
2025-02-27T19:34:55.8441063Z 
2025-02-27T19:34:55.8441072Z 
2025-02-27T19:34:55.8442625Z Test Suites: 13 failed, 45 passed, 58 total
2025-02-27T19:34:55.8443270Z Tests:       60 failed, 4 skipped, 299 passed, 363 total
2025-02-27T19:34:55.8443601Z Snapshots:   0 total
2025-02-27T19:34:55.8443819Z Time:        30.301 s
2025-02-27T19:34:55.8444035Z Ran all test suites.
2025-02-27T19:34:55.8623595Z ##[error]Process completed with exit code 1.
